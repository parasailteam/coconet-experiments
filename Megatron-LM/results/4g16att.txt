
1

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.099892 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_100mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_100mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_100mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3547.96 | train/valid/test data iterators: 2479.37
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 2278.4 | learning rate: 0.000E+00 | lm loss: 1.061757E+01 | sop loss: 6.712070E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 686.59228515625 | max allocated: 893.9423828125 | cached: 1102.0 | max cached: 1102.0
time (ms) | total time: 2278.18 | forward: 1939.27 | backward: 323.51 | allreduce: 12.47 | optimizer: 0.04 | bias in backward: 2.28 | dropout in backward: 1.67
 iteration        2/     100 | elapsed time per iteration (ms): 104.0 | learning rate: 0.000E+00 | lm loss: 1.051175E+01 | sop loss: 7.495868E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 102.38 | forward: 54.83 | backward: 45.71 | allreduce: 9.08 | optimizer: 0.04 | bias in backward: 2.28 | dropout in backward: 1.66
 iteration        3/     100 | elapsed time per iteration (ms): 82.9 | learning rate: 0.000E+00 | lm loss: 1.067944E+01 | sop loss: 7.804556E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 82.62 | forward: 32.69 | backward: 48.04 | allreduce: 8.93 | optimizer: 0.04 | bias in backward: 2.42 | dropout in backward: 1.76
 iteration        4/     100 | elapsed time per iteration (ms): 82.8 | learning rate: 0.000E+00 | lm loss: 1.035820E+01 | sop loss: 7.518990E-01 | loss scale: 536870912.0 |
time (ms) | total time: 82.54 | forward: 35.02 | backward: 45.49 | allreduce: 9.23 | optimizer: 0.04 | bias in backward: 2.32 | dropout in backward: 1.68
 iteration        5/     100 | elapsed time per iteration (ms): 81.6 | learning rate: 0.000E+00 | lm loss: 1.096764E+01 | sop loss: 6.464837E-01 | loss scale: 268435456.0 |
time (ms) | total time: 81.27 | forward: 34.06 | backward: 45.29 | allreduce: 8.98 | optimizer: 0.04 | bias in backward: 2.32 | dropout in backward: 1.65
 iteration        6/     100 | elapsed time per iteration (ms): 79.3 | learning rate: 0.000E+00 | lm loss: 1.051941E+01 | sop loss: 4.004555E-01 | loss scale: 134217728.0 |
time (ms) | total time: 78.97 | forward: 32.68 | backward: 44.57 | allreduce: 8.82 | optimizer: 0.03 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration        7/     100 | elapsed time per iteration (ms): 79.9 | learning rate: 0.000E+00 | lm loss: 1.064230E+01 | sop loss: 8.352545E-01 | loss scale: 67108864.0 |
time (ms) | total time: 79.60 | forward: 33.06 | backward: 44.86 | allreduce: 8.84 | optimizer: 0.03 | bias in backward: 2.28 | dropout in backward: 1.67
 iteration        8/     100 | elapsed time per iteration (ms): 77.6 | learning rate: 0.000E+00 | lm loss: 1.055961E+01 | sop loss: 7.666156E-01 | loss scale: 33554432.0 |
time (ms) | total time: 77.37 | forward: 31.83 | backward: 43.91 | allreduce: 8.63 | optimizer: 0.03 | bias in backward: 2.27 | dropout in backward: 1.66
 iteration        9/     100 | elapsed time per iteration (ms): 77.6 | learning rate: 0.000E+00 | lm loss: 1.068861E+01 | sop loss: 9.633226E-01 | loss scale: 16777216.0 |
time (ms) | total time: 77.34 | forward: 31.74 | backward: 44.00 | allreduce: 8.67 | optimizer: 0.03 | bias in backward: 2.33 | dropout in backward: 1.71
 iteration       10/     100 | elapsed time per iteration (ms): 79.9 | learning rate: 0.000E+00 | lm loss: 1.035693E+01 | sop loss: 1.024279E+00 | loss scale: 8388608.0 |
time (ms) | total time: 79.59 | forward: 33.15 | backward: 44.78 | allreduce: 9.01 | optimizer: 0.04 | bias in backward: 2.26 | dropout in backward: 1.65
 iteration       11/     100 | elapsed time per iteration (ms): 77.7 | learning rate: 0.000E+00 | lm loss: 1.055876E+01 | sop loss: 8.295128E-01 | loss scale: 4194304.0 |
time (ms) | total time: 77.37 | forward: 31.79 | backward: 43.93 | allreduce: 8.78 | optimizer: 0.03 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       12/     100 | elapsed time per iteration (ms): 78.9 | learning rate: 0.000E+00 | lm loss: 1.046923E+01 | sop loss: 8.884611E-01 | loss scale: 2097152.0 |
time (ms) | total time: 78.61 | forward: 32.38 | backward: 44.55 | allreduce: 8.88 | optimizer: 0.04 | bias in backward: 2.27 | dropout in backward: 1.64
 iteration       13/     100 | elapsed time per iteration (ms): 78.2 | learning rate: 0.000E+00 | lm loss: 1.072450E+01 | sop loss: 8.646249E-01 | loss scale: 1048576.0 |
time (ms) | total time: 77.94 | forward: 31.86 | backward: 44.26 | allreduce: 8.83 | optimizer: 0.03 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       14/     100 | elapsed time per iteration (ms): 79.5 | learning rate: 0.000E+00 | lm loss: 1.064602E+01 | sop loss: 7.586979E-01 | loss scale: 524288.0 |
time (ms) | total time: 79.19 | forward: 32.86 | backward: 44.53 | allreduce: 8.80 | optimizer: 0.03 | bias in backward: 2.32 | dropout in backward: 1.67
 iteration       15/     100 | elapsed time per iteration (ms): 82.0 | learning rate: 0.000E+00 | lm loss: 1.050132E+01 | sop loss: 8.377279E-01 | loss scale: 262144.0 |
time (ms) | total time: 81.73 | forward: 35.24 | backward: 44.67 | allreduce: 8.90 | optimizer: 0.03 | bias in backward: 2.28 | dropout in backward: 1.66
 iteration       16/     100 | elapsed time per iteration (ms): 79.1 | learning rate: 0.000E+00 | lm loss: 1.046089E+01 | sop loss: 6.540266E-01 | loss scale: 131072.0 |
time (ms) | total time: 78.86 | forward: 32.57 | backward: 44.44 | allreduce: 8.95 | optimizer: 0.04 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       17/     100 | elapsed time per iteration (ms): 79.1 | learning rate: 0.000E+00 | lm loss: 1.051489E+01 | sop loss: 6.960812E-01 | loss scale: 65536.0 |
time (ms) | total time: 78.81 | forward: 32.45 | backward: 44.53 | allreduce: 8.90 | optimizer: 0.03 | bias in backward: 2.27 | dropout in backward: 1.65
 iteration       18/     100 | elapsed time per iteration (ms): 250.1 | learning rate: 1.010E-08 | lm loss: 1.042837E+01 | sop loss: 6.497588E-01 | loss scale: 65536.0 |
time (ms) | total time: 249.75 | forward: 32.73 | backward: 102.11 | allreduce: 8.93 | optimizer: 112.74 | bias in backward: 2.26 | dropout in backward: 1.65
 iteration       19/     100 | elapsed time per iteration (ms): 245.3 | learning rate: 1.010E-08 | lm loss: 1.044706E+01 | sop loss: 8.488898E-01 | loss scale: 32768.0 |
time (ms) | total time: 244.99 | forward: 180.72 | backward: 62.06 | allreduce: 9.15 | optimizer: 0.03 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       20/     100 | elapsed time per iteration (ms): 123.6 | learning rate: 2.020E-08 | lm loss: 1.042654E+01 | sop loss: 6.194225E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.32 | forward: 33.35 | backward: 82.70 | allreduce: 8.92 | optimizer: 5.34 | bias in backward: 2.27 | dropout in backward: 1.67
 iteration       21/     100 | elapsed time per iteration (ms): 126.1 | learning rate: 3.030E-08 | lm loss: 1.028972E+01 | sop loss: 8.596880E-01 | loss scale: 32768.0 |
time (ms) | total time: 125.85 | forward: 35.44 | backward: 83.19 | allreduce: 8.89 | optimizer: 5.31 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       22/     100 | elapsed time per iteration (ms): 123.9 | learning rate: 4.040E-08 | lm loss: 1.047700E+01 | sop loss: 6.056687E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.61 | forward: 33.54 | backward: 82.97 | allreduce: 8.83 | optimizer: 5.28 | bias in backward: 2.26 | dropout in backward: 1.65
 iteration       23/     100 | elapsed time per iteration (ms): 123.7 | learning rate: 5.051E-08 | lm loss: 1.090331E+01 | sop loss: 7.194861E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.43 | forward: 33.39 | backward: 82.84 | allreduce: 8.98 | optimizer: 5.30 | bias in backward: 2.25 | dropout in backward: 1.65
 iteration       24/     100 | elapsed time per iteration (ms): 122.3 | learning rate: 6.061E-08 | lm loss: 1.053325E+01 | sop loss: 8.186858E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.01 | forward: 32.67 | backward: 82.24 | allreduce: 8.74 | optimizer: 5.28 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       25/     100 | elapsed time per iteration (ms): 122.5 | learning rate: 7.071E-08 | lm loss: 1.052731E+01 | sop loss: 4.982184E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.18 | forward: 32.59 | backward: 82.52 | allreduce: 8.80 | optimizer: 5.27 | bias in backward: 2.27 | dropout in backward: 1.63
 iteration       26/     100 | elapsed time per iteration (ms): 127.0 | learning rate: 8.081E-08 | lm loss: 1.050900E+01 | sop loss: 8.045554E-01 | loss scale: 32768.0 |
time (ms) | total time: 126.74 | forward: 33.05 | backward: 86.21 | allreduce: 8.98 | optimizer: 5.34 | bias in backward: 2.27 | dropout in backward: 1.64
 iteration       27/     100 | elapsed time per iteration (ms): 123.9 | learning rate: 9.091E-08 | lm loss: 1.067916E+01 | sop loss: 7.342415E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.61 | forward: 33.43 | backward: 82.86 | allreduce: 8.86 | optimizer: 5.28 | bias in backward: 2.30 | dropout in backward: 1.65
 iteration       28/     100 | elapsed time per iteration (ms): 122.1 | learning rate: 1.010E-07 | lm loss: 1.054104E+01 | sop loss: 6.806262E-01 | loss scale: 32768.0 |
time (ms) | total time: 121.82 | forward: 32.50 | backward: 82.12 | allreduce: 8.68 | optimizer: 5.29 | bias in backward: 2.27 | dropout in backward: 1.63
 iteration       29/     100 | elapsed time per iteration (ms): 122.8 | learning rate: 1.111E-07 | lm loss: 1.057964E+01 | sop loss: 5.641122E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.52 | forward: 32.38 | backward: 82.94 | allreduce: 8.80 | optimizer: 5.29 | bias in backward: 2.30 | dropout in backward: 1.66
 iteration       30/     100 | elapsed time per iteration (ms): 123.6 | learning rate: 1.212E-07 | lm loss: 1.058879E+01 | sop loss: 8.099816E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.32 | forward: 32.75 | backward: 83.09 | allreduce: 8.73 | optimizer: 5.34 | bias in backward: 2.34 | dropout in backward: 1.69
 iteration       31/     100 | elapsed time per iteration (ms): 125.3 | learning rate: 1.313E-07 | lm loss: 1.075802E+01 | sop loss: 7.481070E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.98 | forward: 34.34 | backward: 83.27 | allreduce: 9.03 | optimizer: 5.32 | bias in backward: 2.27 | dropout in backward: 1.63
 iteration       32/     100 | elapsed time per iteration (ms): 122.7 | learning rate: 1.414E-07 | lm loss: 1.046580E+01 | sop loss: 8.908346E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.46 | forward: 32.62 | backward: 82.68 | allreduce: 8.74 | optimizer: 5.28 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       33/     100 | elapsed time per iteration (ms): 122.3 | learning rate: 1.515E-07 | lm loss: 1.057639E+01 | sop loss: 1.069991E+00 | loss scale: 32768.0 |
time (ms) | total time: 121.98 | forward: 32.63 | backward: 82.30 | allreduce: 8.85 | optimizer: 5.29 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       34/     100 | elapsed time per iteration (ms): 122.3 | learning rate: 1.616E-07 | lm loss: 1.044936E+01 | sop loss: 8.164319E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.03 | forward: 32.04 | backward: 82.89 | allreduce: 8.80 | optimizer: 5.30 | bias in backward: 2.28 | dropout in backward: 1.65
 iteration       35/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 1.717E-07 | lm loss: 1.014046E+01 | sop loss: 5.988618E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.83 | forward: 31.67 | backward: 84.02 | allreduce: 8.94 | optimizer: 5.30 | bias in backward: 2.50 | dropout in backward: 1.77
 iteration       36/     100 | elapsed time per iteration (ms): 123.4 | learning rate: 1.818E-07 | lm loss: 1.024306E+01 | sop loss: 6.828854E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.09 | forward: 33.23 | backward: 82.74 | allreduce: 8.71 | optimizer: 5.27 | bias in backward: 2.24 | dropout in backward: 1.64
 iteration       37/     100 | elapsed time per iteration (ms): 122.0 | learning rate: 1.919E-07 | lm loss: 1.038385E+01 | sop loss: 5.481529E-01 | loss scale: 32768.0 |
time (ms) | total time: 121.72 | forward: 32.58 | backward: 82.06 | allreduce: 8.66 | optimizer: 5.30 | bias in backward: 2.28 | dropout in backward: 1.65
 iteration       38/     100 | elapsed time per iteration (ms): 123.0 | learning rate: 2.020E-07 | lm loss: 1.049837E+01 | sop loss: 7.279108E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.66 | forward: 32.74 | backward: 82.81 | allreduce: 8.78 | optimizer: 5.29 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       39/     100 | elapsed time per iteration (ms): 122.0 | learning rate: 2.121E-07 | lm loss: 1.064674E+01 | sop loss: 6.033980E-01 | loss scale: 32768.0 |
time (ms) | total time: 121.68 | forward: 32.53 | backward: 82.11 | allreduce: 8.68 | optimizer: 5.29 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       40/     100 | elapsed time per iteration (ms): 122.7 | learning rate: 2.222E-07 | lm loss: 1.052718E+01 | sop loss: 8.563394E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.41 | forward: 32.57 | backward: 82.73 | allreduce: 8.68 | optimizer: 5.29 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       41/     100 | elapsed time per iteration (ms): 123.4 | learning rate: 2.323E-07 | lm loss: 1.064118E+01 | sop loss: 6.988856E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.10 | forward: 32.43 | backward: 83.32 | allreduce: 9.18 | optimizer: 5.30 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       42/     100 | elapsed time per iteration (ms): 124.5 | learning rate: 2.424E-07 | lm loss: 1.055976E+01 | sop loss: 5.491903E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.25 | forward: 33.76 | backward: 83.27 | allreduce: 8.91 | optimizer: 5.30 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       43/     100 | elapsed time per iteration (ms): 122.1 | learning rate: 2.525E-07 | lm loss: 1.053412E+01 | sop loss: 4.928878E-01 | loss scale: 32768.0 |
time (ms) | total time: 121.86 | forward: 32.71 | backward: 82.00 | allreduce: 8.69 | optimizer: 5.30 | bias in backward: 2.33 | dropout in backward: 1.69
 iteration       44/     100 | elapsed time per iteration (ms): 124.1 | learning rate: 2.626E-07 | lm loss: 1.046223E+01 | sop loss: 5.571449E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.79 | forward: 33.01 | backward: 83.51 | allreduce: 8.93 | optimizer: 5.31 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       45/     100 | elapsed time per iteration (ms): 122.7 | learning rate: 2.727E-07 | lm loss: 1.003823E+01 | sop loss: 7.164807E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.42 | forward: 32.77 | backward: 82.51 | allreduce: 8.73 | optimizer: 5.30 | bias in backward: 2.26 | dropout in backward: 1.63
 iteration       46/     100 | elapsed time per iteration (ms): 124.7 | learning rate: 2.828E-07 | lm loss: 1.128216E+01 | sop loss: 9.093073E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.43 | forward: 33.41 | backward: 83.37 | allreduce: 9.04 | optimizer: 5.33 | bias in backward: 2.27 | dropout in backward: 1.66
 iteration       47/     100 | elapsed time per iteration (ms): 125.7 | learning rate: 2.929E-07 | lm loss: 1.029688E+01 | sop loss: 7.244449E-01 | loss scale: 32768.0 |
time (ms) | total time: 125.42 | forward: 34.56 | backward: 83.63 | allreduce: 9.06 | optimizer: 5.32 | bias in backward: 2.33 | dropout in backward: 1.71
 iteration       48/     100 | elapsed time per iteration (ms): 122.7 | learning rate: 3.030E-07 | lm loss: 1.058993E+01 | sop loss: 6.687632E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.46 | forward: 32.64 | backward: 82.63 | allreduce: 8.74 | optimizer: 5.29 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       49/     100 | elapsed time per iteration (ms): 122.5 | learning rate: 3.131E-07 | lm loss: 1.044365E+01 | sop loss: 3.506050E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.19 | forward: 32.78 | backward: 82.32 | allreduce: 8.71 | optimizer: 5.28 | bias in backward: 2.24 | dropout in backward: 1.63
 iteration       50/     100 | elapsed time per iteration (ms): 123.2 | learning rate: 3.232E-07 | lm loss: 1.042896E+01 | sop loss: 8.647662E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.91 | forward: 32.99 | backward: 82.75 | allreduce: 8.76 | optimizer: 5.30 | bias in backward: 2.29 | dropout in backward: 1.64
 iteration       51/     100 | elapsed time per iteration (ms): 122.3 | learning rate: 3.333E-07 | lm loss: 1.036338E+01 | sop loss: 5.227256E-01 | loss scale: 32768.0 |
time (ms) | total time: 121.99 | forward: 32.58 | backward: 82.33 | allreduce: 8.67 | optimizer: 5.28 | bias in backward: 2.32 | dropout in backward: 1.71
 iteration       52/     100 | elapsed time per iteration (ms): 124.2 | learning rate: 3.434E-07 | lm loss: 1.056832E+01 | sop loss: 7.278478E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.88 | forward: 33.63 | backward: 83.17 | allreduce: 8.91 | optimizer: 5.29 | bias in backward: 2.25 | dropout in backward: 1.63
 iteration       53/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 3.535E-07 | lm loss: 1.042170E+01 | sop loss: 1.115425E+00 | loss scale: 32768.0 |
time (ms) | total time: 122.77 | forward: 32.57 | backward: 82.81 | allreduce: 9.08 | optimizer: 5.30 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       54/     100 | elapsed time per iteration (ms): 149.1 | learning rate: 3.636E-07 | lm loss: 1.049331E+01 | sop loss: 6.866377E-01 | loss scale: 32768.0 |
time (ms) | total time: 148.82 | forward: 44.79 | backward: 96.61 | allreduce: 9.21 | optimizer: 5.31 | bias in backward: 2.27 | dropout in backward: 1.64
 iteration       55/     100 | elapsed time per iteration (ms): 133.7 | learning rate: 3.737E-07 | lm loss: 1.066611E+01 | sop loss: 7.177342E-01 | loss scale: 32768.0 |
time (ms) | total time: 133.36 | forward: 43.77 | backward: 82.38 | allreduce: 8.83 | optimizer: 5.30 | bias in backward: 2.24 | dropout in backward: 1.63
 iteration       56/     100 | elapsed time per iteration (ms): 123.6 | learning rate: 3.838E-07 | lm loss: 1.090754E+01 | sop loss: 7.643629E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.33 | forward: 33.85 | backward: 82.38 | allreduce: 8.76 | optimizer: 5.29 | bias in backward: 2.26 | dropout in backward: 1.63
 iteration       57/     100 | elapsed time per iteration (ms): 123.2 | learning rate: 3.939E-07 | lm loss: 1.052026E+01 | sop loss: 5.798910E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.88 | forward: 33.46 | backward: 82.35 | allreduce: 8.70 | optimizer: 5.27 | bias in backward: 2.24 | dropout in backward: 1.63
 iteration       58/     100 | elapsed time per iteration (ms): 124.2 | learning rate: 4.040E-07 | lm loss: 1.050337E+01 | sop loss: 6.990544E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.94 | forward: 33.68 | backward: 82.99 | allreduce: 8.99 | optimizer: 5.30 | bias in backward: 2.28 | dropout in backward: 1.65
 iteration       59/     100 | elapsed time per iteration (ms): 125.1 | learning rate: 4.141E-07 | lm loss: 1.036726E+01 | sop loss: 9.131851E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.80 | forward: 34.11 | backward: 83.19 | allreduce: 8.96 | optimizer: 5.35 | bias in backward: 2.27 | dropout in backward: 1.66
 iteration       60/     100 | elapsed time per iteration (ms): 126.3 | learning rate: 4.242E-07 | lm loss: 1.041073E+01 | sop loss: 7.641020E-01 | loss scale: 32768.0 |
time (ms) | total time: 126.01 | forward: 34.82 | backward: 83.70 | allreduce: 9.03 | optimizer: 5.30 | bias in backward: 2.26 | dropout in backward: 1.63
 iteration       61/     100 | elapsed time per iteration (ms): 126.4 | learning rate: 4.343E-07 | lm loss: 1.049804E+01 | sop loss: 7.819778E-01 | loss scale: 32768.0 |
time (ms) | total time: 126.12 | forward: 34.94 | backward: 83.62 | allreduce: 8.98 | optimizer: 5.34 | bias in backward: 2.26 | dropout in backward: 1.65
 iteration       62/     100 | elapsed time per iteration (ms): 126.3 | learning rate: 4.444E-07 | lm loss: 1.052743E+01 | sop loss: 6.598758E-01 | loss scale: 32768.0 |
time (ms) | total time: 125.98 | forward: 34.77 | backward: 83.63 | allreduce: 9.19 | optimizer: 5.34 | bias in backward: 2.27 | dropout in backward: 1.64
 iteration       63/     100 | elapsed time per iteration (ms): 125.3 | learning rate: 4.545E-07 | lm loss: 1.046311E+01 | sop loss: 6.070336E-01 | loss scale: 32768.0 |
time (ms) | total time: 125.03 | forward: 34.49 | backward: 83.12 | allreduce: 8.97 | optimizer: 5.31 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       64/     100 | elapsed time per iteration (ms): 125.6 | learning rate: 4.646E-07 | lm loss: 1.048373E+01 | sop loss: 6.537337E-01 | loss scale: 32768.0 |
time (ms) | total time: 125.29 | forward: 34.64 | backward: 83.26 | allreduce: 8.93 | optimizer: 5.32 | bias in backward: 2.24 | dropout in backward: 1.64
 iteration       65/     100 | elapsed time per iteration (ms): 124.6 | learning rate: 4.747E-07 | lm loss: 1.039543E+01 | sop loss: 6.811578E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.27 | forward: 32.46 | backward: 84.61 | allreduce: 8.90 | optimizer: 5.30 | bias in backward: 2.52 | dropout in backward: 1.69
 iteration       66/     100 | elapsed time per iteration (ms): 123.9 | learning rate: 4.848E-07 | lm loss: 1.081869E+01 | sop loss: 7.167344E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.64 | forward: 33.86 | backward: 82.61 | allreduce: 8.84 | optimizer: 5.29 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       67/     100 | elapsed time per iteration (ms): 125.0 | learning rate: 4.949E-07 | lm loss: 1.054230E+01 | sop loss: 6.909524E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.75 | forward: 34.44 | backward: 83.09 | allreduce: 9.02 | optimizer: 5.32 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       68/     100 | elapsed time per iteration (ms): 125.1 | learning rate: 5.051E-07 | lm loss: 1.020127E+01 | sop loss: 7.367206E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.83 | forward: 34.82 | backward: 82.71 | allreduce: 8.87 | optimizer: 5.31 | bias in backward: 2.28 | dropout in backward: 1.65
 iteration       69/     100 | elapsed time per iteration (ms): 127.4 | learning rate: 5.152E-07 | lm loss: 1.038751E+01 | sop loss: 5.936056E-01 | loss scale: 32768.0 |
time (ms) | total time: 127.12 | forward: 34.58 | backward: 84.98 | allreduce: 9.04 | optimizer: 5.34 | bias in backward: 2.32 | dropout in backward: 1.69
 iteration       70/     100 | elapsed time per iteration (ms): 124.7 | learning rate: 5.253E-07 | lm loss: 1.050809E+01 | sop loss: 6.629177E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.41 | forward: 34.56 | backward: 82.54 | allreduce: 8.82 | optimizer: 5.30 | bias in backward: 2.26 | dropout in backward: 1.65
 iteration       71/     100 | elapsed time per iteration (ms): 123.5 | learning rate: 5.354E-07 | lm loss: 1.050058E+01 | sop loss: 6.175223E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.20 | forward: 33.93 | backward: 82.20 | allreduce: 8.77 | optimizer: 5.29 | bias in backward: 2.28 | dropout in backward: 1.68
 iteration       72/     100 | elapsed time per iteration (ms): 122.9 | learning rate: 5.455E-07 | lm loss: 1.040760E+01 | sop loss: 6.429746E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.65 | forward: 33.46 | backward: 82.11 | allreduce: 8.72 | optimizer: 5.28 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       73/     100 | elapsed time per iteration (ms): 122.9 | learning rate: 5.556E-07 | lm loss: 1.079006E+01 | sop loss: 7.918527E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.61 | forward: 33.41 | backward: 82.17 | allreduce: 8.68 | optimizer: 5.27 | bias in backward: 2.24 | dropout in backward: 1.64
 iteration       74/     100 | elapsed time per iteration (ms): 123.2 | learning rate: 5.657E-07 | lm loss: 9.931670E+00 | sop loss: 1.048421E+00 | loss scale: 32768.0 |
time (ms) | total time: 122.96 | forward: 33.52 | backward: 82.40 | allreduce: 8.68 | optimizer: 5.28 | bias in backward: 2.25 | dropout in backward: 1.63
 iteration       75/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 5.758E-07 | lm loss: 1.050306E+01 | sop loss: 9.663826E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.81 | forward: 33.53 | backward: 82.18 | allreduce: 8.70 | optimizer: 5.30 | bias in backward: 2.32 | dropout in backward: 1.70
 iteration       76/     100 | elapsed time per iteration (ms): 123.7 | learning rate: 5.859E-07 | lm loss: 1.033349E+01 | sop loss: 5.567018E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.46 | forward: 33.64 | backward: 82.72 | allreduce: 8.76 | optimizer: 5.30 | bias in backward: 2.24 | dropout in backward: 1.65
 iteration       77/     100 | elapsed time per iteration (ms): 122.9 | learning rate: 5.960E-07 | lm loss: 1.031277E+01 | sop loss: 3.084349E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.61 | forward: 33.43 | backward: 82.11 | allreduce: 8.79 | optimizer: 5.28 | bias in backward: 2.31 | dropout in backward: 1.69
 iteration       78/     100 | elapsed time per iteration (ms): 123.2 | learning rate: 6.061E-07 | lm loss: 1.036697E+01 | sop loss: 8.671353E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.97 | forward: 33.55 | backward: 82.36 | allreduce: 8.71 | optimizer: 5.31 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       79/     100 | elapsed time per iteration (ms): 122.9 | learning rate: 6.162E-07 | lm loss: 1.048629E+01 | sop loss: 6.892486E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.65 | forward: 33.41 | backward: 82.15 | allreduce: 8.71 | optimizer: 5.31 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       80/     100 | elapsed time per iteration (ms): 124.4 | learning rate: 6.263E-07 | lm loss: 1.021089E+01 | sop loss: 5.845106E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.13 | forward: 33.69 | backward: 83.21 | allreduce: 9.12 | optimizer: 5.32 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       81/     100 | elapsed time per iteration (ms): 123.6 | learning rate: 6.364E-07 | lm loss: 1.020641E+01 | sop loss: 7.323384E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.27 | forward: 33.90 | backward: 82.17 | allreduce: 8.75 | optimizer: 5.31 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       82/     100 | elapsed time per iteration (ms): 123.0 | learning rate: 6.465E-07 | lm loss: 1.047456E+01 | sop loss: 4.632978E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.74 | forward: 33.60 | backward: 82.06 | allreduce: 8.76 | optimizer: 5.29 | bias in backward: 2.27 | dropout in backward: 1.64
 iteration       83/     100 | elapsed time per iteration (ms): 123.2 | learning rate: 6.566E-07 | lm loss: 1.041410E+01 | sop loss: 7.711014E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.88 | forward: 33.51 | backward: 82.29 | allreduce: 8.72 | optimizer: 5.29 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       84/     100 | elapsed time per iteration (ms): 124.6 | learning rate: 6.667E-07 | lm loss: 1.016478E+01 | sop loss: 7.671059E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.33 | forward: 33.55 | backward: 83.41 | allreduce: 9.13 | optimizer: 5.32 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       85/     100 | elapsed time per iteration (ms): 124.5 | learning rate: 6.768E-07 | lm loss: 1.044942E+01 | sop loss: 4.533350E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.25 | forward: 34.52 | backward: 82.49 | allreduce: 8.83 | optimizer: 5.30 | bias in backward: 2.25 | dropout in backward: 1.65
 iteration       86/     100 | elapsed time per iteration (ms): 124.1 | learning rate: 6.869E-07 | lm loss: 1.063671E+01 | sop loss: 8.169129E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.77 | forward: 33.61 | backward: 82.95 | allreduce: 8.90 | optimizer: 5.29 | bias in backward: 2.27 | dropout in backward: 1.66
 iteration       87/     100 | elapsed time per iteration (ms): 124.1 | learning rate: 6.970E-07 | lm loss: 1.036781E+01 | sop loss: 8.326305E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.81 | forward: 33.99 | backward: 82.67 | allreduce: 8.82 | optimizer: 5.29 | bias in backward: 2.26 | dropout in backward: 1.66
 iteration       88/     100 | elapsed time per iteration (ms): 124.9 | learning rate: 7.071E-07 | lm loss: 1.006668E+01 | sop loss: 1.162728E+00 | loss scale: 32768.0 |
time (ms) | total time: 124.64 | forward: 33.53 | backward: 83.80 | allreduce: 9.32 | optimizer: 5.32 | bias in backward: 2.27 | dropout in backward: 1.65
 iteration       89/     100 | elapsed time per iteration (ms): 124.5 | learning rate: 7.172E-07 | lm loss: 1.029192E+01 | sop loss: 4.279033E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.20 | forward: 34.56 | backward: 82.43 | allreduce: 8.75 | optimizer: 5.30 | bias in backward: 2.24 | dropout in backward: 1.64
 iteration       90/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 7.273E-07 | lm loss: 1.044621E+01 | sop loss: 5.793675E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.85 | forward: 33.56 | backward: 82.18 | allreduce: 8.73 | optimizer: 5.28 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       91/     100 | elapsed time per iteration (ms): 123.0 | learning rate: 7.374E-07 | lm loss: 1.019840E+01 | sop loss: 7.435830E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.74 | forward: 33.50 | backward: 82.18 | allreduce: 8.78 | optimizer: 5.28 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       92/     100 | elapsed time per iteration (ms): 124.8 | learning rate: 7.475E-07 | lm loss: 1.043073E+01 | sop loss: 4.798652E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.53 | forward: 33.83 | backward: 83.49 | allreduce: 8.98 | optimizer: 5.31 | bias in backward: 2.29 | dropout in backward: 1.67
 iteration       93/     100 | elapsed time per iteration (ms): 123.7 | learning rate: 7.576E-07 | lm loss: 1.039708E+01 | sop loss: 9.081596E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.41 | forward: 33.83 | backward: 82.42 | allreduce: 8.83 | optimizer: 5.27 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       94/     100 | elapsed time per iteration (ms): 125.5 | learning rate: 7.677E-07 | lm loss: 1.029443E+01 | sop loss: 3.821948E-01 | loss scale: 32768.0 |
time (ms) | total time: 125.23 | forward: 34.33 | backward: 83.66 | allreduce: 9.21 | optimizer: 5.32 | bias in backward: 2.29 | dropout in backward: 1.64
 iteration       95/     100 | elapsed time per iteration (ms): 123.3 | learning rate: 7.778E-07 | lm loss: 1.024722E+01 | sop loss: 5.655345E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.04 | forward: 33.78 | backward: 82.02 | allreduce: 8.78 | optimizer: 5.30 | bias in backward: 2.28 | dropout in backward: 1.63
 iteration       96/     100 | elapsed time per iteration (ms): 148.4 | learning rate: 7.879E-07 | lm loss: 1.022179E+01 | sop loss: 7.174841E-01 | loss scale: 32768.0 |
time (ms) | total time: 148.09 | forward: 33.75 | backward: 106.92 | allreduce: 34.22 | optimizer: 5.28 | bias in backward: 2.25 | dropout in backward: 1.63
 iteration       97/     100 | elapsed time per iteration (ms): 124.5 | learning rate: 7.980E-07 | lm loss: 1.075995E+01 | sop loss: 1.123071E+00 | loss scale: 32768.0 |
time (ms) | total time: 124.17 | forward: 34.09 | backward: 82.79 | allreduce: 8.77 | optimizer: 5.30 | bias in backward: 2.25 | dropout in backward: 1.65
 iteration       98/     100 | elapsed time per iteration (ms): 123.6 | learning rate: 8.081E-07 | lm loss: 1.033182E+01 | sop loss: 1.175687E+00 | loss scale: 32768.0 |
time (ms) | total time: 123.34 | forward: 33.72 | backward: 82.49 | allreduce: 8.72 | optimizer: 5.29 | bias in backward: 2.24 | dropout in backward: 1.64
 iteration       99/     100 | elapsed time per iteration (ms): 148.3 | learning rate: 8.182E-07 | lm loss: 1.058881E+01 | sop loss: 1.227238E+00 | loss scale: 32768.0 |
time (ms) | total time: 148.07 | forward: 33.45 | backward: 107.10 | allreduce: 8.72 | optimizer: 5.35 | bias in backward: 2.25 | dropout in backward: 1.65
 iteration      100/     100 | elapsed time per iteration (ms): 125.7 | learning rate: 8.283E-07 | lm loss: 1.035205E+01 | sop loss: 4.749532E-01 | loss scale: 32768.0 |
time (ms) | total time: 125.44 | forward: 34.54 | backward: 83.58 | allreduce: 8.83 | optimizer: 5.28 | bias in backward: 2.29 | dropout in backward: 1.64
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

2

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.097012 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3519.85 | train/valid/test data iterators: 2227.54
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 2057.2 | learning rate: 0.000E+00 | lm loss: 1.056194E+01 | sop loss: 7.528481E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 691.09228515625 | max allocated: 1317.166015625 | cached: 1528.0 | max cached: 1528.0
time (ms) | total time: 2056.93 | forward: 1718.88 | backward: 327.64 | allreduce: 14.85 | optimizer: 0.05 | bias in backward: 2.34 | dropout in backward: 1.71
 iteration        2/     100 | elapsed time per iteration (ms): 117.8 | learning rate: 0.000E+00 | lm loss: 1.055737E+01 | sop loss: 5.984560E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 116.01 | forward: 59.05 | backward: 54.14 | allreduce: 14.55 | optimizer: 0.06 | bias in backward: 2.36 | dropout in backward: 1.70
 iteration        3/     100 | elapsed time per iteration (ms): 100.6 | learning rate: 0.000E+00 | lm loss: 1.052154E+01 | sop loss: 7.120038E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 100.26 | forward: 45.60 | backward: 51.67 | allreduce: 9.45 | optimizer: 0.04 | bias in backward: 2.32 | dropout in backward: 1.69
 iteration        4/     100 | elapsed time per iteration (ms): 84.3 | learning rate: 0.000E+00 | lm loss: 1.048127E+01 | sop loss: 6.629336E-01 | loss scale: 536870912.0 |
time (ms) | total time: 84.00 | forward: 31.38 | backward: 50.09 | allreduce: 11.18 | optimizer: 0.03 | bias in backward: 2.46 | dropout in backward: 1.88
 iteration        5/     100 | elapsed time per iteration (ms): 83.2 | learning rate: 0.000E+00 | lm loss: 1.060711E+01 | sop loss: 7.991654E-01 | loss scale: 268435456.0 |
time (ms) | total time: 82.91 | forward: 31.69 | backward: 48.71 | allreduce: 9.54 | optimizer: 0.03 | bias in backward: 2.50 | dropout in backward: 1.77
 iteration        6/     100 | elapsed time per iteration (ms): 81.9 | learning rate: 0.000E+00 | lm loss: 1.032770E+01 | sop loss: 6.464205E-01 | loss scale: 134217728.0 |
time (ms) | total time: 81.58 | forward: 31.35 | backward: 47.76 | allreduce: 9.23 | optimizer: 0.03 | bias in backward: 2.44 | dropout in backward: 1.78
 iteration        7/     100 | elapsed time per iteration (ms): 82.7 | learning rate: 0.000E+00 | lm loss: 1.043923E+01 | sop loss: 7.952681E-01 | loss scale: 67108864.0 |
time (ms) | total time: 82.44 | forward: 33.25 | backward: 46.86 | allreduce: 9.42 | optimizer: 0.03 | bias in backward: 2.32 | dropout in backward: 1.69
 iteration        8/     100 | elapsed time per iteration (ms): 82.6 | learning rate: 0.000E+00 | lm loss: 1.043570E+01 | sop loss: 6.107033E-01 | loss scale: 33554432.0 |
time (ms) | total time: 82.29 | forward: 33.93 | backward: 46.38 | allreduce: 9.09 | optimizer: 0.03 | bias in backward: 2.38 | dropout in backward: 1.76
 iteration        9/     100 | elapsed time per iteration (ms): 84.0 | learning rate: 0.000E+00 | lm loss: 1.050048E+01 | sop loss: 6.089844E-01 | loss scale: 16777216.0 |
time (ms) | total time: 83.78 | forward: 32.51 | backward: 49.35 | allreduce: 9.05 | optimizer: 0.04 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       10/     100 | elapsed time per iteration (ms): 81.1 | learning rate: 0.000E+00 | lm loss: 1.062810E+01 | sop loss: 8.135786E-01 | loss scale: 8388608.0 |
time (ms) | total time: 80.80 | forward: 30.90 | backward: 48.07 | allreduce: 8.97 | optimizer: 0.04 | bias in backward: 2.34 | dropout in backward: 1.74
 iteration       11/     100 | elapsed time per iteration (ms): 79.0 | learning rate: 0.000E+00 | lm loss: 1.023466E+01 | sop loss: 1.131310E+00 | loss scale: 4194304.0 |
time (ms) | total time: 78.75 | forward: 32.27 | backward: 44.72 | allreduce: 8.87 | optimizer: 0.03 | bias in backward: 2.25 | dropout in backward: 1.63
 iteration       12/     100 | elapsed time per iteration (ms): 87.5 | learning rate: 0.000E+00 | lm loss: 1.068106E+01 | sop loss: 8.756888E-01 | loss scale: 2097152.0 |
time (ms) | total time: 87.21 | forward: 31.02 | backward: 54.52 | allreduce: 8.70 | optimizer: 0.03 | bias in backward: 2.27 | dropout in backward: 1.64
 iteration       13/     100 | elapsed time per iteration (ms): 81.0 | learning rate: 0.000E+00 | lm loss: 1.071234E+01 | sop loss: 7.425613E-01 | loss scale: 1048576.0 |
time (ms) | total time: 80.77 | forward: 30.21 | backward: 48.88 | allreduce: 8.79 | optimizer: 0.03 | bias in backward: 2.35 | dropout in backward: 1.71
 iteration       14/     100 | elapsed time per iteration (ms): 88.8 | learning rate: 0.000E+00 | lm loss: 1.048424E+01 | sop loss: 6.617573E-01 | loss scale: 524288.0 |
time (ms) | total time: 88.54 | forward: 32.80 | backward: 53.88 | allreduce: 9.05 | optimizer: 0.03 | bias in backward: 2.27 | dropout in backward: 1.64
 iteration       15/     100 | elapsed time per iteration (ms): 80.2 | learning rate: 0.000E+00 | lm loss: 1.065740E+01 | sop loss: 5.577271E-01 | loss scale: 262144.0 |
time (ms) | total time: 79.90 | forward: 30.75 | backward: 47.30 | allreduce: 9.09 | optimizer: 0.03 | bias in backward: 2.38 | dropout in backward: 1.85
 iteration       16/     100 | elapsed time per iteration (ms): 82.5 | learning rate: 0.000E+00 | lm loss: 1.065868E+01 | sop loss: 5.669143E-01 | loss scale: 131072.0 |
time (ms) | total time: 82.27 | forward: 30.42 | backward: 50.08 | allreduce: 8.88 | optimizer: 0.03 | bias in backward: 2.35 | dropout in backward: 1.72
 iteration       17/     100 | elapsed time per iteration (ms): 82.8 | learning rate: 0.000E+00 | lm loss: 1.044894E+01 | sop loss: 7.816795E-01 | loss scale: 65536.0 |
time (ms) | total time: 82.55 | forward: 30.22 | backward: 50.62 | allreduce: 8.87 | optimizer: 0.03 | bias in backward: 2.44 | dropout in backward: 1.64
 iteration       18/     100 | elapsed time per iteration (ms): 171.2 | learning rate: 1.010E-08 | lm loss: 1.034255E+01 | sop loss: 3.520961E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.91 | forward: 30.23 | backward: 82.20 | allreduce: 8.88 | optimizer: 56.67 | bias in backward: 2.34 | dropout in backward: 1.81
 iteration       19/     100 | elapsed time per iteration (ms): 289.1 | learning rate: 2.020E-08 | lm loss: 1.053719E+01 | sop loss: 8.288790E-01 | loss scale: 65536.0 |
time (ms) | total time: 288.81 | forward: 189.95 | backward: 89.93 | allreduce: 12.82 | optimizer: 5.29 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       20/     100 | elapsed time per iteration (ms): 121.3 | learning rate: 3.030E-08 | lm loss: 1.067928E+01 | sop loss: 6.897030E-01 | loss scale: 65536.0 |
time (ms) | total time: 120.99 | forward: 30.64 | backward: 83.15 | allreduce: 8.84 | optimizer: 5.31 | bias in backward: 2.41 | dropout in backward: 1.68
 iteration       21/     100 | elapsed time per iteration (ms): 120.5 | learning rate: 4.040E-08 | lm loss: 1.064943E+01 | sop loss: 8.048261E-01 | loss scale: 65536.0 |
time (ms) | total time: 120.23 | forward: 30.63 | backward: 82.46 | allreduce: 8.80 | optimizer: 5.28 | bias in backward: 2.37 | dropout in backward: 1.69
 iteration       22/     100 | elapsed time per iteration (ms): 127.5 | learning rate: 5.051E-08 | lm loss: 1.053051E+01 | sop loss: 6.857917E-01 | loss scale: 65536.0 |
time (ms) | total time: 127.18 | forward: 31.34 | backward: 88.19 | allreduce: 9.45 | optimizer: 5.33 | bias in backward: 2.37 | dropout in backward: 1.71
 iteration       23/     100 | elapsed time per iteration (ms): 122.7 | learning rate: 6.061E-08 | lm loss: 1.080788E+01 | sop loss: 5.350713E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.46 | forward: 31.30 | backward: 83.77 | allreduce: 9.21 | optimizer: 5.29 | bias in backward: 2.46 | dropout in backward: 1.67
 iteration       24/     100 | elapsed time per iteration (ms): 123.8 | learning rate: 7.071E-08 | lm loss: 1.062167E+01 | sop loss: 6.447024E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.50 | forward: 32.81 | backward: 83.40 | allreduce: 8.97 | optimizer: 5.31 | bias in backward: 2.28 | dropout in backward: 1.67
 iteration       25/     100 | elapsed time per iteration (ms): 122.8 | learning rate: 8.081E-08 | lm loss: 1.053785E+01 | sop loss: 7.222704E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.49 | forward: 32.60 | backward: 82.61 | allreduce: 8.94 | optimizer: 5.28 | bias in backward: 2.27 | dropout in backward: 1.66
 iteration       26/     100 | elapsed time per iteration (ms): 120.9 | learning rate: 9.091E-08 | lm loss: 1.039959E+01 | sop loss: 6.653620E-01 | loss scale: 65536.0 |
time (ms) | total time: 120.64 | forward: 30.50 | backward: 82.86 | allreduce: 8.80 | optimizer: 5.30 | bias in backward: 2.45 | dropout in backward: 1.73
 iteration       27/     100 | elapsed time per iteration (ms): 123.8 | learning rate: 1.010E-07 | lm loss: 1.050338E+01 | sop loss: 5.680150E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.53 | forward: 32.48 | backward: 83.47 | allreduce: 9.15 | optimizer: 5.31 | bias in backward: 2.25 | dropout in backward: 1.63
 iteration       28/     100 | elapsed time per iteration (ms): 124.0 | learning rate: 1.111E-07 | lm loss: 1.058068E+01 | sop loss: 8.713955E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.68 | forward: 31.45 | backward: 84.54 | allreduce: 9.18 | optimizer: 5.34 | bias in backward: 2.30 | dropout in backward: 1.67
 iteration       29/     100 | elapsed time per iteration (ms): 126.5 | learning rate: 1.212E-07 | lm loss: 1.060108E+01 | sop loss: 7.004640E-01 | loss scale: 65536.0 |
time (ms) | total time: 126.21 | forward: 33.99 | backward: 84.41 | allreduce: 9.31 | optimizer: 5.34 | bias in backward: 2.36 | dropout in backward: 1.69
 iteration       30/     100 | elapsed time per iteration (ms): 126.6 | learning rate: 1.313E-07 | lm loss: 1.057115E+01 | sop loss: 8.495535E-01 | loss scale: 65536.0 |
time (ms) | total time: 126.27 | forward: 32.57 | backward: 85.90 | allreduce: 9.48 | optimizer: 5.33 | bias in backward: 2.33 | dropout in backward: 1.68
 iteration       31/     100 | elapsed time per iteration (ms): 128.2 | learning rate: 1.414E-07 | lm loss: 1.064063E+01 | sop loss: 6.684769E-01 | loss scale: 65536.0 |
time (ms) | total time: 127.88 | forward: 32.28 | backward: 87.61 | allreduce: 9.61 | optimizer: 5.35 | bias in backward: 2.52 | dropout in backward: 1.88
 iteration       32/     100 | elapsed time per iteration (ms): 128.5 | learning rate: 1.515E-07 | lm loss: 1.060450E+01 | sop loss: 7.094044E-01 | loss scale: 65536.0 |
time (ms) | total time: 128.18 | forward: 33.51 | backward: 86.58 | allreduce: 9.58 | optimizer: 5.38 | bias in backward: 2.38 | dropout in backward: 1.70
 iteration       33/     100 | elapsed time per iteration (ms): 128.4 | learning rate: 1.616E-07 | lm loss: 1.047289E+01 | sop loss: 5.205311E-01 | loss scale: 65536.0 |
time (ms) | total time: 128.16 | forward: 34.15 | backward: 86.00 | allreduce: 9.85 | optimizer: 5.32 | bias in backward: 2.36 | dropout in backward: 1.71
 iteration       34/     100 | elapsed time per iteration (ms): 126.2 | learning rate: 1.717E-07 | lm loss: 1.067533E+01 | sop loss: 6.169922E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.95 | forward: 31.64 | backward: 86.15 | allreduce: 9.51 | optimizer: 5.32 | bias in backward: 2.39 | dropout in backward: 1.71
 iteration       35/     100 | elapsed time per iteration (ms): 126.0 | learning rate: 1.818E-07 | lm loss: 1.053367E+01 | sop loss: 9.285960E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.75 | forward: 31.63 | backward: 86.34 | allreduce: 9.77 | optimizer: 5.32 | bias in backward: 2.45 | dropout in backward: 1.80
 iteration       36/     100 | elapsed time per iteration (ms): 126.5 | learning rate: 1.919E-07 | lm loss: 1.068396E+01 | sop loss: 6.623431E-01 | loss scale: 65536.0 |
time (ms) | total time: 126.25 | forward: 31.63 | backward: 86.59 | allreduce: 9.85 | optimizer: 5.31 | bias in backward: 2.44 | dropout in backward: 1.73
 iteration       37/     100 | elapsed time per iteration (ms): 127.6 | learning rate: 2.020E-07 | lm loss: 1.034095E+01 | sop loss: 5.384273E-01 | loss scale: 65536.0 |
time (ms) | total time: 127.26 | forward: 33.37 | backward: 85.95 | allreduce: 9.54 | optimizer: 5.35 | bias in backward: 2.37 | dropout in backward: 1.70
 iteration       38/     100 | elapsed time per iteration (ms): 127.5 | learning rate: 2.121E-07 | lm loss: 1.050454E+01 | sop loss: 1.084258E+00 | loss scale: 65536.0 |
time (ms) | total time: 127.25 | forward: 33.09 | backward: 86.06 | allreduce: 9.68 | optimizer: 5.36 | bias in backward: 2.36 | dropout in backward: 1.71
 iteration       39/     100 | elapsed time per iteration (ms): 128.3 | learning rate: 2.222E-07 | lm loss: 1.045259E+01 | sop loss: 8.252880E-01 | loss scale: 65536.0 |
time (ms) | total time: 127.99 | forward: 33.96 | backward: 85.93 | allreduce: 9.90 | optimizer: 5.31 | bias in backward: 2.36 | dropout in backward: 1.69
 iteration       40/     100 | elapsed time per iteration (ms): 123.0 | learning rate: 2.323E-07 | lm loss: 1.048816E+01 | sop loss: 9.076189E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.70 | forward: 31.42 | backward: 83.73 | allreduce: 8.93 | optimizer: 5.33 | bias in backward: 2.44 | dropout in backward: 1.76
 iteration       41/     100 | elapsed time per iteration (ms): 125.5 | learning rate: 2.424E-07 | lm loss: 1.049352E+01 | sop loss: 9.187798E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.21 | forward: 31.14 | backward: 86.41 | allreduce: 9.56 | optimizer: 5.32 | bias in backward: 2.55 | dropout in backward: 1.78
 iteration       42/     100 | elapsed time per iteration (ms): 125.7 | learning rate: 2.525E-07 | lm loss: 1.049130E+01 | sop loss: 5.597731E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.40 | forward: 32.61 | backward: 85.03 | allreduce: 9.64 | optimizer: 5.30 | bias in backward: 2.36 | dropout in backward: 1.72
 iteration       43/     100 | elapsed time per iteration (ms): 126.0 | learning rate: 2.626E-07 | lm loss: 1.044409E+01 | sop loss: 6.551071E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.69 | forward: 32.96 | backward: 84.80 | allreduce: 9.53 | optimizer: 5.33 | bias in backward: 2.34 | dropout in backward: 1.70
 iteration       44/     100 | elapsed time per iteration (ms): 125.1 | learning rate: 2.727E-07 | lm loss: 1.053574E+01 | sop loss: 7.619099E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.77 | forward: 31.54 | backward: 85.49 | allreduce: 9.27 | optimizer: 5.29 | bias in backward: 2.64 | dropout in backward: 1.75
 iteration       45/     100 | elapsed time per iteration (ms): 123.8 | learning rate: 2.828E-07 | lm loss: 1.055323E+01 | sop loss: 7.894391E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.48 | forward: 33.28 | backward: 82.84 | allreduce: 9.06 | optimizer: 5.30 | bias in backward: 2.28 | dropout in backward: 1.63
 iteration       46/     100 | elapsed time per iteration (ms): 122.0 | learning rate: 2.929E-07 | lm loss: 1.049079E+01 | sop loss: 8.340424E-01 | loss scale: 65536.0 |
time (ms) | total time: 121.69 | forward: 32.14 | backward: 82.34 | allreduce: 8.94 | optimizer: 5.28 | bias in backward: 2.29 | dropout in backward: 1.64
 iteration       47/     100 | elapsed time per iteration (ms): 124.2 | learning rate: 3.030E-07 | lm loss: 1.048036E+01 | sop loss: 9.102280E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.89 | forward: 30.51 | backward: 85.74 | allreduce: 9.59 | optimizer: 5.30 | bias in backward: 2.40 | dropout in backward: 1.75
 iteration       48/     100 | elapsed time per iteration (ms): 124.8 | learning rate: 3.131E-07 | lm loss: 1.049857E+01 | sop loss: 5.937859E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.57 | forward: 31.54 | backward: 85.12 | allreduce: 9.51 | optimizer: 5.40 | bias in backward: 2.36 | dropout in backward: 1.70
 iteration       49/     100 | elapsed time per iteration (ms): 126.1 | learning rate: 3.232E-07 | lm loss: 1.059895E+01 | sop loss: 8.410319E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.83 | forward: 33.03 | backward: 84.94 | allreduce: 9.25 | optimizer: 5.29 | bias in backward: 2.38 | dropout in backward: 1.71
 iteration       50/     100 | elapsed time per iteration (ms): 122.6 | learning rate: 3.333E-07 | lm loss: 1.038736E+01 | sop loss: 9.262161E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.34 | forward: 31.08 | backward: 83.80 | allreduce: 9.11 | optimizer: 5.31 | bias in backward: 2.46 | dropout in backward: 1.72
 iteration       51/     100 | elapsed time per iteration (ms): 126.1 | learning rate: 3.434E-07 | lm loss: 1.052269E+01 | sop loss: 9.936018E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.85 | forward: 31.53 | backward: 86.58 | allreduce: 9.82 | optimizer: 5.31 | bias in backward: 2.47 | dropout in backward: 1.74
 iteration       52/     100 | elapsed time per iteration (ms): 126.2 | learning rate: 3.535E-07 | lm loss: 1.051149E+01 | sop loss: 7.905190E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.90 | forward: 32.98 | backward: 85.14 | allreduce: 9.61 | optimizer: 5.30 | bias in backward: 2.35 | dropout in backward: 1.70
 iteration       53/     100 | elapsed time per iteration (ms): 125.6 | learning rate: 3.636E-07 | lm loss: 1.048616E+01 | sop loss: 7.749439E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.27 | forward: 31.07 | backward: 86.38 | allreduce: 9.80 | optimizer: 5.30 | bias in backward: 2.54 | dropout in backward: 1.75
 iteration       54/     100 | elapsed time per iteration (ms): 125.0 | learning rate: 3.737E-07 | lm loss: 1.049027E+01 | sop loss: 7.838285E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.75 | forward: 31.59 | backward: 85.54 | allreduce: 9.43 | optimizer: 5.32 | bias in backward: 2.41 | dropout in backward: 1.76
 iteration       55/     100 | elapsed time per iteration (ms): 123.0 | learning rate: 3.838E-07 | lm loss: 1.037542E+01 | sop loss: 6.506070E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.74 | forward: 30.98 | backward: 84.19 | allreduce: 9.33 | optimizer: 5.27 | bias in backward: 2.41 | dropout in backward: 1.74
 iteration       56/     100 | elapsed time per iteration (ms): 126.0 | learning rate: 3.939E-07 | lm loss: 1.056048E+01 | sop loss: 8.665739E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.71 | forward: 31.43 | backward: 86.58 | allreduce: 9.69 | optimizer: 5.31 | bias in backward: 2.50 | dropout in backward: 1.79
 iteration       57/     100 | elapsed time per iteration (ms): 125.8 | learning rate: 4.040E-07 | lm loss: 1.049267E+01 | sop loss: 5.771893E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.55 | forward: 33.03 | backward: 84.76 | allreduce: 9.62 | optimizer: 5.28 | bias in backward: 2.34 | dropout in backward: 1.71
 iteration       58/     100 | elapsed time per iteration (ms): 124.5 | learning rate: 4.141E-07 | lm loss: 1.043939E+01 | sop loss: 8.715677E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.21 | forward: 31.57 | backward: 84.91 | allreduce: 9.21 | optimizer: 5.27 | bias in backward: 2.35 | dropout in backward: 1.69
 iteration       59/     100 | elapsed time per iteration (ms): 128.7 | learning rate: 4.242E-07 | lm loss: 1.046247E+01 | sop loss: 7.073207E-01 | loss scale: 65536.0 |
time (ms) | total time: 128.46 | forward: 32.92 | backward: 87.81 | allreduce: 9.22 | optimizer: 5.30 | bias in backward: 2.36 | dropout in backward: 1.71
 iteration       60/     100 | elapsed time per iteration (ms): 125.6 | learning rate: 4.343E-07 | lm loss: 1.038031E+01 | sop loss: 6.333667E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.32 | forward: 32.55 | backward: 84.99 | allreduce: 9.60 | optimizer: 5.31 | bias in backward: 2.38 | dropout in backward: 1.70
 iteration       61/     100 | elapsed time per iteration (ms): 124.4 | learning rate: 4.444E-07 | lm loss: 1.059044E+01 | sop loss: 6.543030E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.13 | forward: 31.67 | backward: 84.70 | allreduce: 9.46 | optimizer: 5.27 | bias in backward: 2.35 | dropout in backward: 1.70
 iteration       62/     100 | elapsed time per iteration (ms): 123.4 | learning rate: 4.545E-07 | lm loss: 1.047905E+01 | sop loss: 5.700297E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.09 | forward: 30.93 | backward: 84.55 | allreduce: 9.31 | optimizer: 5.28 | bias in backward: 2.48 | dropout in backward: 1.71
 iteration       63/     100 | elapsed time per iteration (ms): 125.1 | learning rate: 4.646E-07 | lm loss: 1.023658E+01 | sop loss: 6.745999E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.79 | forward: 30.78 | backward: 86.18 | allreduce: 10.05 | optimizer: 5.33 | bias in backward: 2.51 | dropout in backward: 1.76
 iteration       64/     100 | elapsed time per iteration (ms): 126.8 | learning rate: 4.747E-07 | lm loss: 1.044279E+01 | sop loss: 7.300107E-01 | loss scale: 65536.0 |
time (ms) | total time: 126.56 | forward: 32.47 | backward: 86.23 | allreduce: 9.65 | optimizer: 5.30 | bias in backward: 2.38 | dropout in backward: 1.71
 iteration       65/     100 | elapsed time per iteration (ms): 126.0 | learning rate: 4.848E-07 | lm loss: 1.050194E+01 | sop loss: 7.687057E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.68 | forward: 32.94 | backward: 84.98 | allreduce: 9.63 | optimizer: 5.29 | bias in backward: 2.36 | dropout in backward: 1.70
 iteration       66/     100 | elapsed time per iteration (ms): 125.5 | learning rate: 4.949E-07 | lm loss: 1.046625E+01 | sop loss: 6.956820E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.23 | forward: 32.49 | backward: 85.01 | allreduce: 9.59 | optimizer: 5.29 | bias in backward: 2.37 | dropout in backward: 1.72
 iteration       67/     100 | elapsed time per iteration (ms): 124.3 | learning rate: 5.051E-07 | lm loss: 1.044298E+01 | sop loss: 8.948376E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.06 | forward: 31.02 | backward: 85.24 | allreduce: 9.59 | optimizer: 5.30 | bias in backward: 2.50 | dropout in backward: 1.77
 iteration       68/     100 | elapsed time per iteration (ms): 125.5 | learning rate: 5.152E-07 | lm loss: 1.045818E+01 | sop loss: 6.740984E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.20 | forward: 32.09 | backward: 85.38 | allreduce: 9.31 | optimizer: 5.29 | bias in backward: 2.43 | dropout in backward: 1.77
 iteration       69/     100 | elapsed time per iteration (ms): 128.7 | learning rate: 5.253E-07 | lm loss: 1.041656E+01 | sop loss: 8.618869E-01 | loss scale: 65536.0 |
time (ms) | total time: 128.45 | forward: 34.57 | backward: 86.03 | allreduce: 9.57 | optimizer: 5.34 | bias in backward: 2.39 | dropout in backward: 1.70
 iteration       70/     100 | elapsed time per iteration (ms): 126.1 | learning rate: 5.354E-07 | lm loss: 1.043332E+01 | sop loss: 9.654385E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.86 | forward: 32.66 | backward: 85.33 | allreduce: 9.35 | optimizer: 5.30 | bias in backward: 2.37 | dropout in backward: 1.71
 iteration       71/     100 | elapsed time per iteration (ms): 125.3 | learning rate: 5.455E-07 | lm loss: 1.039447E+01 | sop loss: 4.955800E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.98 | forward: 30.85 | backward: 86.20 | allreduce: 9.46 | optimizer: 5.32 | bias in backward: 2.47 | dropout in backward: 1.79
 iteration       72/     100 | elapsed time per iteration (ms): 127.2 | learning rate: 5.556E-07 | lm loss: 1.044079E+01 | sop loss: 6.835567E-01 | loss scale: 65536.0 |
time (ms) | total time: 126.89 | forward: 32.95 | backward: 85.92 | allreduce: 9.54 | optimizer: 5.34 | bias in backward: 2.38 | dropout in backward: 1.70
 iteration       73/     100 | elapsed time per iteration (ms): 128.0 | learning rate: 5.657E-07 | lm loss: 1.038903E+01 | sop loss: 7.632717E-01 | loss scale: 65536.0 |
time (ms) | total time: 127.68 | forward: 33.57 | backward: 86.07 | allreduce: 9.91 | optimizer: 5.35 | bias in backward: 2.37 | dropout in backward: 1.72
 iteration       74/     100 | elapsed time per iteration (ms): 127.3 | learning rate: 5.758E-07 | lm loss: 1.041776E+01 | sop loss: 6.344259E-01 | loss scale: 65536.0 |
time (ms) | total time: 126.96 | forward: 33.06 | backward: 85.92 | allreduce: 9.68 | optimizer: 5.32 | bias in backward: 2.37 | dropout in backward: 1.72
 iteration       75/     100 | elapsed time per iteration (ms): 127.8 | learning rate: 5.859E-07 | lm loss: 1.041464E+01 | sop loss: 5.528954E-01 | loss scale: 65536.0 |
time (ms) | total time: 127.53 | forward: 33.70 | backward: 85.66 | allreduce: 9.52 | optimizer: 5.32 | bias in backward: 2.37 | dropout in backward: 1.72
 iteration       76/     100 | elapsed time per iteration (ms): 126.7 | learning rate: 5.960E-07 | lm loss: 1.045371E+01 | sop loss: 7.453690E-01 | loss scale: 65536.0 |
time (ms) | total time: 126.40 | forward: 31.55 | backward: 87.15 | allreduce: 9.93 | optimizer: 5.35 | bias in backward: 2.53 | dropout in backward: 1.77
 iteration       77/     100 | elapsed time per iteration (ms): 126.4 | learning rate: 6.061E-07 | lm loss: 1.045918E+01 | sop loss: 8.545203E-01 | loss scale: 65536.0 |
time (ms) | total time: 126.12 | forward: 32.11 | backward: 85.88 | allreduce: 9.74 | optimizer: 5.37 | bias in backward: 2.46 | dropout in backward: 1.72
 iteration       78/     100 | elapsed time per iteration (ms): 126.2 | learning rate: 6.162E-07 | lm loss: 1.036108E+01 | sop loss: 4.552166E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.92 | forward: 33.11 | backward: 84.86 | allreduce: 9.59 | optimizer: 5.30 | bias in backward: 2.36 | dropout in backward: 1.70
 iteration       79/     100 | elapsed time per iteration (ms): 123.9 | learning rate: 6.263E-07 | lm loss: 1.051692E+01 | sop loss: 5.136557E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.65 | forward: 31.47 | backward: 84.37 | allreduce: 9.44 | optimizer: 5.28 | bias in backward: 2.34 | dropout in backward: 1.69
 iteration       80/     100 | elapsed time per iteration (ms): 125.6 | learning rate: 6.364E-07 | lm loss: 1.039634E+01 | sop loss: 1.153809E+00 | loss scale: 65536.0 |
time (ms) | total time: 125.37 | forward: 32.38 | backward: 85.26 | allreduce: 9.53 | optimizer: 5.30 | bias in backward: 2.43 | dropout in backward: 1.76
 iteration       81/     100 | elapsed time per iteration (ms): 125.6 | learning rate: 6.465E-07 | lm loss: 1.039651E+01 | sop loss: 8.518807E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.29 | forward: 32.95 | backward: 84.60 | allreduce: 9.51 | optimizer: 5.29 | bias in backward: 2.34 | dropout in backward: 1.69
 iteration       82/     100 | elapsed time per iteration (ms): 122.1 | learning rate: 6.566E-07 | lm loss: 1.055299E+01 | sop loss: 6.130736E-01 | loss scale: 65536.0 |
time (ms) | total time: 121.79 | forward: 30.95 | backward: 83.53 | allreduce: 8.98 | optimizer: 5.27 | bias in backward: 2.45 | dropout in backward: 1.70
 iteration       83/     100 | elapsed time per iteration (ms): 120.5 | learning rate: 6.667E-07 | lm loss: 1.036744E+01 | sop loss: 4.661493E-01 | loss scale: 65536.0 |
time (ms) | total time: 120.24 | forward: 30.69 | backward: 82.31 | allreduce: 8.86 | optimizer: 5.28 | bias in backward: 2.36 | dropout in backward: 1.63
 iteration       84/     100 | elapsed time per iteration (ms): 121.2 | learning rate: 6.768E-07 | lm loss: 1.032926E+01 | sop loss: 6.835457E-01 | loss scale: 65536.0 |
time (ms) | total time: 120.91 | forward: 30.56 | backward: 83.14 | allreduce: 8.97 | optimizer: 5.30 | bias in backward: 2.47 | dropout in backward: 1.76
 iteration       85/     100 | elapsed time per iteration (ms): 121.8 | learning rate: 6.869E-07 | lm loss: 1.032164E+01 | sop loss: 1.031167E+00 | loss scale: 65536.0 |
time (ms) | total time: 121.54 | forward: 32.57 | backward: 81.73 | allreduce: 8.93 | optimizer: 5.28 | bias in backward: 2.24 | dropout in backward: 1.62
 iteration       86/     100 | elapsed time per iteration (ms): 122.0 | learning rate: 6.970E-07 | lm loss: 1.033105E+01 | sop loss: 5.007199E-01 | loss scale: 65536.0 |
time (ms) | total time: 121.73 | forward: 32.08 | backward: 82.33 | allreduce: 8.95 | optimizer: 5.29 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       87/     100 | elapsed time per iteration (ms): 122.9 | learning rate: 7.071E-07 | lm loss: 1.035202E+01 | sop loss: 5.101196E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.62 | forward: 31.74 | backward: 83.50 | allreduce: 9.16 | optimizer: 5.29 | bias in backward: 2.26 | dropout in backward: 1.65
 iteration       88/     100 | elapsed time per iteration (ms): 121.7 | learning rate: 7.172E-07 | lm loss: 1.037693E+01 | sop loss: 1.271688E+00 | loss scale: 65536.0 |
time (ms) | total time: 121.44 | forward: 32.20 | backward: 81.92 | allreduce: 8.93 | optimizer: 5.27 | bias in backward: 2.24 | dropout in backward: 1.62
 iteration       89/     100 | elapsed time per iteration (ms): 122.0 | learning rate: 7.273E-07 | lm loss: 1.053751E+01 | sop loss: 9.597560E-01 | loss scale: 65536.0 |
time (ms) | total time: 121.69 | forward: 32.35 | backward: 82.11 | allreduce: 8.88 | optimizer: 5.29 | bias in backward: 2.25 | dropout in backward: 1.63
 iteration       90/     100 | elapsed time per iteration (ms): 124.8 | learning rate: 7.374E-07 | lm loss: 1.026162E+01 | sop loss: 4.682113E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.53 | forward: 32.84 | backward: 84.24 | allreduce: 9.34 | optimizer: 5.34 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       91/     100 | elapsed time per iteration (ms): 120.8 | learning rate: 7.475E-07 | lm loss: 1.018584E+01 | sop loss: 4.799404E-01 | loss scale: 65536.0 |
time (ms) | total time: 120.56 | forward: 30.94 | backward: 82.39 | allreduce: 9.04 | optimizer: 5.26 | bias in backward: 2.34 | dropout in backward: 1.68
 iteration       92/     100 | elapsed time per iteration (ms): 122.4 | learning rate: 7.576E-07 | lm loss: 1.049342E+01 | sop loss: 7.463768E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.07 | forward: 31.95 | backward: 82.39 | allreduce: 8.97 | optimizer: 5.49 | bias in backward: 2.25 | dropout in backward: 1.64
 iteration       93/     100 | elapsed time per iteration (ms): 126.2 | learning rate: 7.677E-07 | lm loss: 1.027915E+01 | sop loss: 1.175246E+00 | loss scale: 65536.0 |
time (ms) | total time: 125.87 | forward: 35.52 | backward: 82.98 | allreduce: 9.16 | optimizer: 5.27 | bias in backward: 2.24 | dropout in backward: 1.65
 iteration       94/     100 | elapsed time per iteration (ms): 121.4 | learning rate: 7.778E-07 | lm loss: 1.030999E+01 | sop loss: 6.579638E-01 | loss scale: 65536.0 |
time (ms) | total time: 121.08 | forward: 30.87 | backward: 82.97 | allreduce: 8.98 | optimizer: 5.30 | bias in backward: 2.33 | dropout in backward: 1.79
 iteration       95/     100 | elapsed time per iteration (ms): 122.9 | learning rate: 7.879E-07 | lm loss: 1.030638E+01 | sop loss: 6.089767E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.65 | forward: 33.32 | backward: 82.13 | allreduce: 8.96 | optimizer: 5.29 | bias in backward: 2.27 | dropout in backward: 1.64
 iteration       96/     100 | elapsed time per iteration (ms): 149.1 | learning rate: 7.980E-07 | lm loss: 1.043263E+01 | sop loss: 1.044950E+00 | loss scale: 65536.0 |
time (ms) | total time: 148.84 | forward: 31.78 | backward: 108.96 | allreduce: 34.65 | optimizer: 5.72 | bias in backward: 2.27 | dropout in backward: 1.62
 iteration       97/     100 | elapsed time per iteration (ms): 123.0 | learning rate: 8.081E-07 | lm loss: 1.032917E+01 | sop loss: 9.418323E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.66 | forward: 32.86 | backward: 82.23 | allreduce: 9.00 | optimizer: 5.26 | bias in backward: 2.26 | dropout in backward: 1.64
 iteration       98/     100 | elapsed time per iteration (ms): 123.6 | learning rate: 8.182E-07 | lm loss: 1.020795E+01 | sop loss: 3.452262E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.30 | forward: 30.54 | backward: 85.54 | allreduce: 8.96 | optimizer: 5.27 | bias in backward: 2.38 | dropout in backward: 1.69
 iteration       99/     100 | elapsed time per iteration (ms): 144.6 | learning rate: 8.283E-07 | lm loss: 1.038775E+01 | sop loss: 3.674112E-01 | loss scale: 65536.0 |
time (ms) | total time: 144.31 | forward: 30.61 | backward: 105.88 | allreduce: 8.95 | optimizer: 5.38 | bias in backward: 2.48 | dropout in backward: 1.75
 iteration      100/     100 | elapsed time per iteration (ms): 123.9 | learning rate: 8.384E-07 | lm loss: 1.038060E+01 | sop loss: 7.556482E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.65 | forward: 32.82 | backward: 83.32 | allreduce: 9.07 | optimizer: 5.30 | bias in backward: 2.34 | dropout in backward: 1.69
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

4

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.115862 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.004 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3675.74 | train/valid/test data iterators: 2273.65
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 2288.0 | learning rate: 0.000E+00 | lm loss: 1.050812E+01 | sop loss: 6.974850E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 687.59228515625 | max allocated: 2086.6123046875 | cached: 2364.0 | max cached: 2364.0
time (ms) | total time: 2287.80 | forward: 1935.03 | backward: 320.58 | allreduce: 12.83 | optimizer: 0.05 | bias in backward: 2.31 | dropout in backward: 1.80
 iteration        2/     100 | elapsed time per iteration (ms): 119.0 | learning rate: 0.000E+00 | lm loss: 1.054697E+01 | sop loss: 8.406397E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 117.42 | forward: 60.66 | backward: 54.94 | allreduce: 8.99 | optimizer: 0.04 | bias in backward: 2.31 | dropout in backward: 1.80
 iteration        3/     100 | elapsed time per iteration (ms): 107.7 | learning rate: 0.000E+00 | lm loss: 1.061845E+01 | sop loss: 6.632479E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 107.42 | forward: 47.36 | backward: 58.15 | allreduce: 9.01 | optimizer: 0.03 | bias in backward: 2.46 | dropout in backward: 2.00
 iteration        4/     100 | elapsed time per iteration (ms): 90.0 | learning rate: 0.000E+00 | lm loss: 1.054461E+01 | sop loss: 5.924878E-01 | loss scale: 536870912.0 |
time (ms) | total time: 89.71 | forward: 33.29 | backward: 54.60 | allreduce: 8.81 | optimizer: 0.03 | bias in backward: 2.34 | dropout in backward: 1.84
 iteration        5/     100 | elapsed time per iteration (ms): 90.8 | learning rate: 0.000E+00 | lm loss: 1.053106E+01 | sop loss: 6.718067E-01 | loss scale: 268435456.0 |
time (ms) | total time: 90.47 | forward: 32.63 | backward: 55.94 | allreduce: 9.14 | optimizer: 0.04 | bias in backward: 2.53 | dropout in backward: 2.12
 iteration        6/     100 | elapsed time per iteration (ms): 89.1 | learning rate: 0.000E+00 | lm loss: 1.043708E+01 | sop loss: 6.492453E-01 | loss scale: 134217728.0 |
time (ms) | total time: 88.86 | forward: 31.93 | backward: 55.05 | allreduce: 8.93 | optimizer: 0.03 | bias in backward: 2.31 | dropout in backward: 1.81
 iteration        7/     100 | elapsed time per iteration (ms): 90.7 | learning rate: 0.000E+00 | lm loss: 1.058222E+01 | sop loss: 5.161003E-01 | loss scale: 67108864.0 |
time (ms) | total time: 90.38 | forward: 33.31 | backward: 55.25 | allreduce: 8.83 | optimizer: 0.03 | bias in backward: 2.47 | dropout in backward: 1.90
 iteration        8/     100 | elapsed time per iteration (ms): 92.9 | learning rate: 0.000E+00 | lm loss: 1.050186E+01 | sop loss: 7.113510E-01 | loss scale: 33554432.0 |
time (ms) | total time: 92.57 | forward: 33.28 | backward: 56.31 | allreduce: 9.43 | optimizer: 0.04 | bias in backward: 2.56 | dropout in backward: 1.88
 iteration        9/     100 | elapsed time per iteration (ms): 90.2 | learning rate: 0.000E+00 | lm loss: 1.048458E+01 | sop loss: 6.290540E-01 | loss scale: 16777216.0 |
time (ms) | total time: 89.92 | forward: 32.07 | backward: 55.51 | allreduce: 9.08 | optimizer: 0.03 | bias in backward: 2.47 | dropout in backward: 1.85
 iteration       10/     100 | elapsed time per iteration (ms): 89.4 | learning rate: 0.000E+00 | lm loss: 1.056573E+01 | sop loss: 6.539670E-01 | loss scale: 8388608.0 |
time (ms) | total time: 89.11 | forward: 31.83 | backward: 55.49 | allreduce: 8.72 | optimizer: 0.03 | bias in backward: 2.47 | dropout in backward: 1.82
 iteration       11/     100 | elapsed time per iteration (ms): 89.3 | learning rate: 0.000E+00 | lm loss: 1.059372E+01 | sop loss: 6.468567E-01 | loss scale: 4194304.0 |
time (ms) | total time: 89.08 | forward: 31.91 | backward: 55.58 | allreduce: 10.76 | optimizer: 0.03 | bias in backward: 2.27 | dropout in backward: 1.78
 iteration       12/     100 | elapsed time per iteration (ms): 87.8 | learning rate: 0.000E+00 | lm loss: 1.048413E+01 | sop loss: 7.564046E-01 | loss scale: 2097152.0 |
time (ms) | total time: 87.54 | forward: 31.75 | backward: 54.27 | allreduce: 8.49 | optimizer: 0.03 | bias in backward: 2.36 | dropout in backward: 1.80
 iteration       13/     100 | elapsed time per iteration (ms): 89.2 | learning rate: 0.000E+00 | lm loss: 1.052825E+01 | sop loss: 5.703881E-01 | loss scale: 1048576.0 |
time (ms) | total time: 88.90 | forward: 32.57 | backward: 54.79 | allreduce: 8.52 | optimizer: 0.03 | bias in backward: 2.45 | dropout in backward: 1.85
 iteration       14/     100 | elapsed time per iteration (ms): 91.0 | learning rate: 0.000E+00 | lm loss: 1.061669E+01 | sop loss: 5.478429E-01 | loss scale: 524288.0 |
time (ms) | total time: 90.76 | forward: 32.87 | backward: 55.61 | allreduce: 9.52 | optimizer: 0.03 | bias in backward: 2.39 | dropout in backward: 1.88
 iteration       15/     100 | elapsed time per iteration (ms): 89.4 | learning rate: 0.000E+00 | lm loss: 1.047443E+01 | sop loss: 6.349424E-01 | loss scale: 262144.0 |
time (ms) | total time: 89.15 | forward: 31.96 | backward: 54.83 | allreduce: 9.18 | optimizer: 0.03 | bias in backward: 2.50 | dropout in backward: 1.83
 iteration       16/     100 | elapsed time per iteration (ms): 95.0 | learning rate: 0.000E+00 | lm loss: 1.045579E+01 | sop loss: 6.632768E-01 | loss scale: 131072.0 |
time (ms) | total time: 94.71 | forward: 31.38 | backward: 61.03 | allreduce: 9.15 | optimizer: 0.03 | bias in backward: 2.28 | dropout in backward: 1.77
 iteration       17/     100 | elapsed time per iteration (ms): 142.2 | learning rate: 1.010E-08 | lm loss: 1.049120E+01 | sop loss: 9.261902E-01 | loss scale: 131072.0 |
time (ms) | total time: 141.86 | forward: 33.48 | backward: 93.96 | allreduce: 9.52 | optimizer: 12.20 | bias in backward: 2.29 | dropout in backward: 1.78
 iteration       18/     100 | elapsed time per iteration (ms): 420.3 | learning rate: 2.020E-08 | lm loss: 1.055738E+01 | sop loss: 6.573694E-01 | loss scale: 131072.0 |
time (ms) | total time: 419.95 | forward: 304.65 | backward: 107.87 | allreduce: 13.33 | optimizer: 5.41 | bias in backward: 2.29 | dropout in backward: 1.80
 iteration       19/     100 | elapsed time per iteration (ms): 146.7 | learning rate: 3.030E-08 | lm loss: 1.051441E+01 | sop loss: 6.907296E-01 | loss scale: 131072.0 |
time (ms) | total time: 146.42 | forward: 39.67 | backward: 99.62 | allreduce: 8.64 | optimizer: 5.39 | bias in backward: 2.53 | dropout in backward: 1.82
 iteration       20/     100 | elapsed time per iteration (ms): 156.2 | learning rate: 4.040E-08 | lm loss: 1.047274E+01 | sop loss: 7.337292E-01 | loss scale: 131072.0 |
time (ms) | total time: 155.91 | forward: 50.11 | backward: 98.78 | allreduce: 8.60 | optimizer: 5.32 | bias in backward: 2.40 | dropout in backward: 1.91
 iteration       21/     100 | elapsed time per iteration (ms): 137.3 | learning rate: 5.051E-08 | lm loss: 1.056207E+01 | sop loss: 7.063402E-01 | loss scale: 131072.0 |
time (ms) | total time: 137.05 | forward: 32.69 | backward: 97.30 | allreduce: 8.59 | optimizer: 5.35 | bias in backward: 2.28 | dropout in backward: 1.79
 iteration       22/     100 | elapsed time per iteration (ms): 108.5 | learning rate: 5.051E-08 | lm loss: 1.058003E+01 | sop loss: 8.053387E-01 | loss scale: 65536.0 |
time (ms) | total time: 108.25 | forward: 32.16 | backward: 74.42 | allreduce: 8.50 | optimizer: 0.03 | bias in backward: 2.44 | dropout in backward: 1.85
 iteration       23/     100 | elapsed time per iteration (ms): 135.6 | learning rate: 6.061E-08 | lm loss: 1.057724E+01 | sop loss: 6.510564E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.39 | forward: 31.72 | backward: 96.75 | allreduce: 8.61 | optimizer: 5.35 | bias in backward: 2.40 | dropout in backward: 1.86
 iteration       24/     100 | elapsed time per iteration (ms): 136.1 | learning rate: 7.071E-08 | lm loss: 1.053698E+01 | sop loss: 8.591330E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.87 | forward: 31.88 | backward: 96.95 | allreduce: 8.68 | optimizer: 5.34 | bias in backward: 2.40 | dropout in backward: 1.86
 iteration       25/     100 | elapsed time per iteration (ms): 140.6 | learning rate: 8.081E-08 | lm loss: 1.049758E+01 | sop loss: 7.068003E-01 | loss scale: 65536.0 |
time (ms) | total time: 140.31 | forward: 34.61 | backward: 98.51 | allreduce: 8.71 | optimizer: 5.38 | bias in backward: 2.49 | dropout in backward: 1.90
 iteration       26/     100 | elapsed time per iteration (ms): 138.7 | learning rate: 9.091E-08 | lm loss: 1.057636E+01 | sop loss: 5.636361E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.47 | forward: 31.98 | backward: 97.61 | allreduce: 9.06 | optimizer: 6.82 | bias in backward: 2.28 | dropout in backward: 1.78
 iteration       27/     100 | elapsed time per iteration (ms): 145.3 | learning rate: 1.010E-07 | lm loss: 1.063668E+01 | sop loss: 7.682176E-01 | loss scale: 65536.0 |
time (ms) | total time: 145.00 | forward: 40.47 | backward: 97.31 | allreduce: 8.60 | optimizer: 5.39 | bias in backward: 2.28 | dropout in backward: 1.79
 iteration       28/     100 | elapsed time per iteration (ms): 138.9 | learning rate: 1.111E-07 | lm loss: 1.050494E+01 | sop loss: 5.721929E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.64 | forward: 34.50 | backward: 97.12 | allreduce: 8.52 | optimizer: 5.32 | bias in backward: 2.26 | dropout in backward: 1.80
 iteration       29/     100 | elapsed time per iteration (ms): 142.2 | learning rate: 1.212E-07 | lm loss: 1.057302E+01 | sop loss: 6.534705E-01 | loss scale: 65536.0 |
time (ms) | total time: 141.93 | forward: 32.33 | backward: 102.33 | allreduce: 8.94 | optimizer: 5.37 | bias in backward: 2.29 | dropout in backward: 1.79
 iteration       30/     100 | elapsed time per iteration (ms): 137.7 | learning rate: 1.313E-07 | lm loss: 1.050955E+01 | sop loss: 7.068994E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.40 | forward: 32.63 | backward: 97.72 | allreduce: 8.57 | optimizer: 5.35 | bias in backward: 2.39 | dropout in backward: 1.94
 iteration       31/     100 | elapsed time per iteration (ms): 140.1 | learning rate: 1.414E-07 | lm loss: 1.053939E+01 | sop loss: 8.208299E-01 | loss scale: 65536.0 |
time (ms) | total time: 139.80 | forward: 34.85 | backward: 97.89 | allreduce: 8.64 | optimizer: 5.35 | bias in backward: 2.27 | dropout in backward: 1.77
 iteration       32/     100 | elapsed time per iteration (ms): 136.3 | learning rate: 1.515E-07 | lm loss: 1.053607E+01 | sop loss: 7.366106E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.05 | forward: 32.11 | backward: 96.92 | allreduce: 8.48 | optimizer: 5.32 | bias in backward: 2.47 | dropout in backward: 1.81
 iteration       33/     100 | elapsed time per iteration (ms): 137.4 | learning rate: 1.616E-07 | lm loss: 1.047070E+01 | sop loss: 8.150870E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.11 | forward: 32.31 | backward: 98.02 | allreduce: 8.52 | optimizer: 5.30 | bias in backward: 2.35 | dropout in backward: 1.83
 iteration       34/     100 | elapsed time per iteration (ms): 137.7 | learning rate: 1.717E-07 | lm loss: 1.052189E+01 | sop loss: 8.982093E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.45 | forward: 32.85 | backward: 97.66 | allreduce: 8.52 | optimizer: 5.31 | bias in backward: 2.38 | dropout in backward: 1.87
 iteration       35/     100 | elapsed time per iteration (ms): 138.5 | learning rate: 1.818E-07 | lm loss: 1.066479E+01 | sop loss: 6.609790E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.30 | forward: 32.92 | backward: 98.51 | allreduce: 8.48 | optimizer: 5.31 | bias in backward: 2.42 | dropout in backward: 1.84
 iteration       36/     100 | elapsed time per iteration (ms): 138.7 | learning rate: 1.919E-07 | lm loss: 1.058062E+01 | sop loss: 7.786021E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.48 | forward: 33.67 | backward: 97.89 | allreduce: 8.50 | optimizer: 5.31 | bias in backward: 2.36 | dropout in backward: 1.85
 iteration       37/     100 | elapsed time per iteration (ms): 141.0 | learning rate: 2.020E-07 | lm loss: 1.048834E+01 | sop loss: 8.378092E-01 | loss scale: 65536.0 |
time (ms) | total time: 140.71 | forward: 36.06 | backward: 97.76 | allreduce: 8.47 | optimizer: 5.31 | bias in backward: 2.42 | dropout in backward: 1.88
 iteration       38/     100 | elapsed time per iteration (ms): 136.5 | learning rate: 2.121E-07 | lm loss: 1.047920E+01 | sop loss: 6.722440E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.23 | forward: 32.07 | backward: 97.21 | allreduce: 8.49 | optimizer: 5.32 | bias in backward: 2.40 | dropout in backward: 1.91
 iteration       39/     100 | elapsed time per iteration (ms): 137.2 | learning rate: 2.222E-07 | lm loss: 1.051733E+01 | sop loss: 8.264970E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.94 | forward: 32.75 | backward: 97.23 | allreduce: 8.54 | optimizer: 5.32 | bias in backward: 2.42 | dropout in backward: 1.86
 iteration       40/     100 | elapsed time per iteration (ms): 136.5 | learning rate: 2.323E-07 | lm loss: 1.054407E+01 | sop loss: 7.223102E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.26 | forward: 31.70 | backward: 97.62 | allreduce: 8.49 | optimizer: 5.32 | bias in backward: 2.37 | dropout in backward: 1.91
 iteration       41/     100 | elapsed time per iteration (ms): 135.8 | learning rate: 2.424E-07 | lm loss: 1.058472E+01 | sop loss: 7.434736E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.58 | forward: 31.67 | backward: 96.96 | allreduce: 8.47 | optimizer: 5.32 | bias in backward: 2.27 | dropout in backward: 1.78
 iteration       42/     100 | elapsed time per iteration (ms): 136.1 | learning rate: 2.525E-07 | lm loss: 1.051730E+01 | sop loss: 7.261980E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.85 | forward: 31.96 | backward: 96.98 | allreduce: 8.48 | optimizer: 5.31 | bias in backward: 2.39 | dropout in backward: 1.88
 iteration       43/     100 | elapsed time per iteration (ms): 136.9 | learning rate: 2.626E-07 | lm loss: 1.044489E+01 | sop loss: 7.893624E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.68 | forward: 31.79 | backward: 97.96 | allreduce: 8.48 | optimizer: 5.32 | bias in backward: 2.28 | dropout in backward: 1.78
 iteration       44/     100 | elapsed time per iteration (ms): 138.0 | learning rate: 2.727E-07 | lm loss: 1.051982E+01 | sop loss: 6.949841E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.74 | forward: 32.53 | backward: 98.06 | allreduce: 8.54 | optimizer: 5.35 | bias in backward: 2.48 | dropout in backward: 1.86
 iteration       45/     100 | elapsed time per iteration (ms): 138.8 | learning rate: 2.828E-07 | lm loss: 1.064549E+01 | sop loss: 7.933075E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.49 | forward: 32.94 | backward: 98.53 | allreduce: 8.61 | optimizer: 5.34 | bias in backward: 2.35 | dropout in backward: 1.91
 iteration       46/     100 | elapsed time per iteration (ms): 139.2 | learning rate: 2.929E-07 | lm loss: 1.045319E+01 | sop loss: 7.085387E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.96 | forward: 34.78 | backward: 97.22 | allreduce: 8.48 | optimizer: 5.30 | bias in backward: 2.26 | dropout in backward: 1.78
 iteration       47/     100 | elapsed time per iteration (ms): 135.7 | learning rate: 3.030E-07 | lm loss: 1.060706E+01 | sop loss: 6.640406E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.43 | forward: 31.86 | backward: 96.64 | allreduce: 8.50 | optimizer: 5.32 | bias in backward: 2.38 | dropout in backward: 1.89
 iteration       48/     100 | elapsed time per iteration (ms): 136.0 | learning rate: 3.131E-07 | lm loss: 1.053209E+01 | sop loss: 6.267257E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.79 | forward: 31.91 | backward: 97.03 | allreduce: 8.48 | optimizer: 5.32 | bias in backward: 2.39 | dropout in backward: 1.82
 iteration       49/     100 | elapsed time per iteration (ms): 137.2 | learning rate: 3.232E-07 | lm loss: 1.049989E+01 | sop loss: 6.931398E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.91 | forward: 32.97 | backward: 97.00 | allreduce: 8.58 | optimizer: 5.31 | bias in backward: 2.27 | dropout in backward: 1.78
 iteration       50/     100 | elapsed time per iteration (ms): 136.8 | learning rate: 3.333E-07 | lm loss: 1.049566E+01 | sop loss: 6.928316E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.51 | forward: 31.84 | backward: 97.72 | allreduce: 10.65 | optimizer: 5.32 | bias in backward: 2.27 | dropout in backward: 1.79
 iteration       51/     100 | elapsed time per iteration (ms): 136.7 | learning rate: 3.434E-07 | lm loss: 1.039453E+01 | sop loss: 6.744713E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.47 | forward: 31.77 | backward: 97.80 | allreduce: 8.46 | optimizer: 5.30 | bias in backward: 2.50 | dropout in backward: 1.84
 iteration       52/     100 | elapsed time per iteration (ms): 137.0 | learning rate: 3.535E-07 | lm loss: 1.044666E+01 | sop loss: 5.794678E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.71 | forward: 32.61 | backward: 97.13 | allreduce: 8.58 | optimizer: 5.33 | bias in backward: 2.46 | dropout in backward: 1.85
 iteration       53/     100 | elapsed time per iteration (ms): 138.9 | learning rate: 3.636E-07 | lm loss: 1.051783E+01 | sop loss: 6.711005E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.66 | forward: 32.25 | backward: 99.48 | allreduce: 8.51 | optimizer: 5.31 | bias in backward: 2.43 | dropout in backward: 1.88
 iteration       54/     100 | elapsed time per iteration (ms): 138.9 | learning rate: 3.737E-07 | lm loss: 1.047145E+01 | sop loss: 7.330291E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.69 | forward: 33.44 | backward: 98.34 | allreduce: 8.46 | optimizer: 5.31 | bias in backward: 2.28 | dropout in backward: 1.78
 iteration       55/     100 | elapsed time per iteration (ms): 136.5 | learning rate: 3.838E-07 | lm loss: 1.042783E+01 | sop loss: 7.824037E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.23 | forward: 32.39 | backward: 96.92 | allreduce: 8.49 | optimizer: 5.30 | bias in backward: 2.39 | dropout in backward: 1.80
 iteration       56/     100 | elapsed time per iteration (ms): 136.6 | learning rate: 3.939E-07 | lm loss: 1.045941E+01 | sop loss: 6.995254E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.33 | forward: 32.28 | backward: 97.13 | allreduce: 8.48 | optimizer: 5.29 | bias in backward: 2.41 | dropout in backward: 1.84
 iteration       57/     100 | elapsed time per iteration (ms): 137.2 | learning rate: 4.040E-07 | lm loss: 1.042307E+01 | sop loss: 6.593772E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.94 | forward: 32.25 | backward: 97.43 | allreduce: 8.95 | optimizer: 5.36 | bias in backward: 2.41 | dropout in backward: 1.84
 iteration       58/     100 | elapsed time per iteration (ms): 136.2 | learning rate: 4.141E-07 | lm loss: 1.044812E+01 | sop loss: 7.601210E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.92 | forward: 31.79 | backward: 97.01 | allreduce: 8.53 | optimizer: 5.33 | bias in backward: 2.26 | dropout in backward: 1.78
 iteration       59/     100 | elapsed time per iteration (ms): 144.8 | learning rate: 4.242E-07 | lm loss: 1.046667E+01 | sop loss: 6.907582E-01 | loss scale: 65536.0 |
time (ms) | total time: 144.57 | forward: 40.67 | backward: 96.98 | allreduce: 8.54 | optimizer: 5.30 | bias in backward: 2.29 | dropout in backward: 1.79
 iteration       60/     100 | elapsed time per iteration (ms): 137.9 | learning rate: 4.343E-07 | lm loss: 1.046935E+01 | sop loss: 8.449717E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.59 | forward: 31.88 | backward: 98.02 | allreduce: 8.50 | optimizer: 5.44 | bias in backward: 2.46 | dropout in backward: 1.88
 iteration       61/     100 | elapsed time per iteration (ms): 138.3 | learning rate: 4.444E-07 | lm loss: 1.041836E+01 | sop loss: 5.920090E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.99 | forward: 33.04 | backward: 97.53 | allreduce: 8.68 | optimizer: 5.36 | bias in backward: 2.31 | dropout in backward: 1.89
 iteration       62/     100 | elapsed time per iteration (ms): 135.7 | learning rate: 4.545E-07 | lm loss: 1.051171E+01 | sop loss: 6.621425E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.48 | forward: 31.72 | backward: 96.69 | allreduce: 8.53 | optimizer: 5.35 | bias in backward: 2.29 | dropout in backward: 1.79
 iteration       63/     100 | elapsed time per iteration (ms): 136.1 | learning rate: 4.646E-07 | lm loss: 1.038016E+01 | sop loss: 6.765186E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.89 | forward: 31.85 | backward: 97.08 | allreduce: 8.50 | optimizer: 5.32 | bias in backward: 2.43 | dropout in backward: 1.87
 iteration       64/     100 | elapsed time per iteration (ms): 137.3 | learning rate: 4.747E-07 | lm loss: 1.045828E+01 | sop loss: 6.650482E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.05 | forward: 32.32 | backward: 97.77 | allreduce: 8.51 | optimizer: 5.32 | bias in backward: 2.33 | dropout in backward: 1.81
 iteration       65/     100 | elapsed time per iteration (ms): 136.5 | learning rate: 4.848E-07 | lm loss: 1.033567E+01 | sop loss: 7.904294E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.21 | forward: 32.30 | backward: 96.95 | allreduce: 8.48 | optimizer: 5.33 | bias in backward: 2.41 | dropout in backward: 1.90
 iteration       66/     100 | elapsed time per iteration (ms): 140.6 | learning rate: 4.949E-07 | lm loss: 1.038806E+01 | sop loss: 8.037596E-01 | loss scale: 65536.0 |
time (ms) | total time: 140.33 | forward: 33.86 | backward: 99.31 | allreduce: 8.93 | optimizer: 5.39 | bias in backward: 2.56 | dropout in backward: 1.95
 iteration       67/     100 | elapsed time per iteration (ms): 136.6 | learning rate: 5.051E-07 | lm loss: 1.050032E+01 | sop loss: 7.289014E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.38 | forward: 32.15 | backward: 97.21 | allreduce: 8.55 | optimizer: 5.34 | bias in backward: 2.35 | dropout in backward: 2.00
 iteration       68/     100 | elapsed time per iteration (ms): 137.1 | learning rate: 5.152E-07 | lm loss: 1.041685E+01 | sop loss: 8.842466E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.86 | forward: 32.14 | backward: 97.76 | allreduce: 8.54 | optimizer: 5.34 | bias in backward: 2.46 | dropout in backward: 1.84
 iteration       69/     100 | elapsed time per iteration (ms): 136.4 | learning rate: 5.253E-07 | lm loss: 1.041700E+01 | sop loss: 7.577683E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.13 | forward: 32.04 | backward: 97.14 | allreduce: 8.52 | optimizer: 5.33 | bias in backward: 2.42 | dropout in backward: 1.85
 iteration       70/     100 | elapsed time per iteration (ms): 136.1 | learning rate: 5.354E-07 | lm loss: 1.037591E+01 | sop loss: 6.841166E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.84 | forward: 31.64 | backward: 97.26 | allreduce: 8.50 | optimizer: 5.32 | bias in backward: 2.41 | dropout in backward: 1.93
 iteration       71/     100 | elapsed time per iteration (ms): 136.1 | learning rate: 5.455E-07 | lm loss: 1.041467E+01 | sop loss: 6.919568E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.83 | forward: 31.60 | backward: 97.31 | allreduce: 8.93 | optimizer: 5.31 | bias in backward: 2.37 | dropout in backward: 1.85
 iteration       72/     100 | elapsed time per iteration (ms): 136.4 | learning rate: 5.556E-07 | lm loss: 1.040361E+01 | sop loss: 6.257414E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.11 | forward: 31.56 | backward: 97.20 | allreduce: 8.93 | optimizer: 5.39 | bias in backward: 2.43 | dropout in backward: 1.87
 iteration       73/     100 | elapsed time per iteration (ms): 136.0 | learning rate: 5.657E-07 | lm loss: 1.027747E+01 | sop loss: 6.600819E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.75 | forward: 31.09 | backward: 97.53 | allreduce: 8.56 | optimizer: 5.34 | bias in backward: 2.29 | dropout in backward: 1.79
 iteration       74/     100 | elapsed time per iteration (ms): 138.1 | learning rate: 5.758E-07 | lm loss: 1.037282E+01 | sop loss: 6.616710E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.88 | forward: 32.62 | backward: 98.23 | allreduce: 8.59 | optimizer: 5.34 | bias in backward: 2.43 | dropout in backward: 1.97
 iteration       75/     100 | elapsed time per iteration (ms): 139.0 | learning rate: 5.859E-07 | lm loss: 1.028686E+01 | sop loss: 6.875537E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.79 | forward: 32.79 | backward: 98.76 | allreduce: 8.68 | optimizer: 5.37 | bias in backward: 2.51 | dropout in backward: 1.96
 iteration       76/     100 | elapsed time per iteration (ms): 139.5 | learning rate: 5.960E-07 | lm loss: 1.041048E+01 | sop loss: 5.957686E-01 | loss scale: 65536.0 |
time (ms) | total time: 139.20 | forward: 32.88 | backward: 99.22 | allreduce: 8.58 | optimizer: 5.33 | bias in backward: 2.37 | dropout in backward: 2.01
 iteration       77/     100 | elapsed time per iteration (ms): 137.5 | learning rate: 6.061E-07 | lm loss: 1.034695E+01 | sop loss: 5.885928E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.20 | forward: 32.74 | backward: 97.54 | allreduce: 8.53 | optimizer: 5.32 | bias in backward: 2.46 | dropout in backward: 1.80
 iteration       78/     100 | elapsed time per iteration (ms): 137.1 | learning rate: 6.162E-07 | lm loss: 1.038760E+01 | sop loss: 7.004158E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.83 | forward: 32.51 | backward: 97.29 | allreduce: 8.62 | optimizer: 5.34 | bias in backward: 2.52 | dropout in backward: 1.87
 iteration       79/     100 | elapsed time per iteration (ms): 137.7 | learning rate: 6.263E-07 | lm loss: 1.036340E+01 | sop loss: 5.754137E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.47 | forward: 31.98 | backward: 98.29 | allreduce: 8.79 | optimizer: 5.39 | bias in backward: 2.39 | dropout in backward: 1.90
 iteration       80/     100 | elapsed time per iteration (ms): 136.5 | learning rate: 6.364E-07 | lm loss: 1.035516E+01 | sop loss: 5.866154E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.25 | forward: 31.99 | backward: 97.09 | allreduce: 8.51 | optimizer: 5.32 | bias in backward: 2.26 | dropout in backward: 1.78
 iteration       81/     100 | elapsed time per iteration (ms): 137.2 | learning rate: 6.465E-07 | lm loss: 1.028102E+01 | sop loss: 6.525880E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.97 | forward: 31.53 | backward: 97.65 | allreduce: 8.60 | optimizer: 5.44 | bias in backward: 2.39 | dropout in backward: 1.93
 iteration       82/     100 | elapsed time per iteration (ms): 136.4 | learning rate: 6.566E-07 | lm loss: 1.033389E+01 | sop loss: 7.028904E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.07 | forward: 31.41 | backward: 97.21 | allreduce: 8.66 | optimizer: 5.36 | bias in backward: 2.42 | dropout in backward: 1.94
 iteration       83/     100 | elapsed time per iteration (ms): 137.0 | learning rate: 6.667E-07 | lm loss: 1.034750E+01 | sop loss: 6.710204E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.69 | forward: 32.10 | backward: 97.45 | allreduce: 8.68 | optimizer: 5.35 | bias in backward: 2.36 | dropout in backward: 1.86
 iteration       84/     100 | elapsed time per iteration (ms): 139.0 | learning rate: 6.768E-07 | lm loss: 1.044810E+01 | sop loss: 7.160074E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.78 | forward: 31.56 | backward: 100.03 | allreduce: 8.67 | optimizer: 5.35 | bias in backward: 2.48 | dropout in backward: 1.87
 iteration       85/     100 | elapsed time per iteration (ms): 137.1 | learning rate: 6.869E-07 | lm loss: 1.041486E+01 | sop loss: 5.980735E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.82 | forward: 32.12 | backward: 97.50 | allreduce: 9.11 | optimizer: 5.37 | bias in backward: 2.40 | dropout in backward: 1.78
 iteration       86/     100 | elapsed time per iteration (ms): 137.3 | learning rate: 6.970E-07 | lm loss: 1.035524E+01 | sop loss: 7.197516E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.03 | forward: 32.03 | backward: 97.73 | allreduce: 8.66 | optimizer: 5.38 | bias in backward: 2.41 | dropout in backward: 1.98
 iteration       87/     100 | elapsed time per iteration (ms): 138.4 | learning rate: 7.071E-07 | lm loss: 1.037155E+01 | sop loss: 6.178094E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.11 | forward: 33.24 | backward: 97.46 | allreduce: 8.77 | optimizer: 5.36 | bias in backward: 2.44 | dropout in backward: 1.95
 iteration       88/     100 | elapsed time per iteration (ms): 136.1 | learning rate: 7.172E-07 | lm loss: 1.021810E+01 | sop loss: 7.120925E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.87 | forward: 30.99 | backward: 97.48 | allreduce: 8.76 | optimizer: 5.37 | bias in backward: 2.50 | dropout in backward: 1.86
 iteration       89/     100 | elapsed time per iteration (ms): 137.7 | learning rate: 7.273E-07 | lm loss: 1.029882E+01 | sop loss: 5.571629E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.42 | forward: 31.12 | backward: 98.57 | allreduce: 9.29 | optimizer: 5.41 | bias in backward: 2.56 | dropout in backward: 1.88
 iteration       90/     100 | elapsed time per iteration (ms): 136.7 | learning rate: 7.374E-07 | lm loss: 1.038251E+01 | sop loss: 4.335991E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.43 | forward: 31.36 | backward: 97.56 | allreduce: 8.81 | optimizer: 5.39 | bias in backward: 2.39 | dropout in backward: 1.92
 iteration       91/     100 | elapsed time per iteration (ms): 135.8 | learning rate: 7.475E-07 | lm loss: 1.028069E+01 | sop loss: 1.042802E+00 | loss scale: 65536.0 |
time (ms) | total time: 135.50 | forward: 31.00 | backward: 97.27 | allreduce: 10.26 | optimizer: 5.36 | bias in backward: 2.29 | dropout in backward: 1.77
 iteration       92/     100 | elapsed time per iteration (ms): 136.8 | learning rate: 7.576E-07 | lm loss: 1.019596E+01 | sop loss: 6.845248E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.50 | forward: 31.70 | backward: 97.75 | allreduce: 10.71 | optimizer: 5.33 | bias in backward: 2.27 | dropout in backward: 1.77
 iteration       93/     100 | elapsed time per iteration (ms): 138.1 | learning rate: 7.677E-07 | lm loss: 1.027260E+01 | sop loss: 6.367863E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.86 | forward: 31.46 | backward: 99.39 | allreduce: 8.59 | optimizer: 5.33 | bias in backward: 2.28 | dropout in backward: 1.80
 iteration       94/     100 | elapsed time per iteration (ms): 136.4 | learning rate: 7.778E-07 | lm loss: 1.038043E+01 | sop loss: 7.460108E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.19 | forward: 31.49 | backward: 97.67 | allreduce: 10.50 | optimizer: 5.32 | bias in backward: 2.27 | dropout in backward: 1.79
 iteration       95/     100 | elapsed time per iteration (ms): 136.3 | learning rate: 7.879E-07 | lm loss: 1.024534E+01 | sop loss: 5.320245E-01 | loss scale: 65536.0 |
time (ms) | total time: 136.07 | forward: 32.07 | backward: 97.04 | allreduce: 8.50 | optimizer: 5.31 | bias in backward: 2.36 | dropout in backward: 1.84
 iteration       96/     100 | elapsed time per iteration (ms): 160.4 | learning rate: 7.980E-07 | lm loss: 1.030346E+01 | sop loss: 8.323265E-01 | loss scale: 65536.0 |
time (ms) | total time: 160.03 | forward: 31.68 | backward: 120.88 | allreduce: 33.39 | optimizer: 5.37 | bias in backward: 2.44 | dropout in backward: 1.91
 iteration       97/     100 | elapsed time per iteration (ms): 135.7 | learning rate: 8.081E-07 | lm loss: 1.015684E+01 | sop loss: 9.223146E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.43 | forward: 31.38 | backward: 96.92 | allreduce: 8.58 | optimizer: 5.31 | bias in backward: 2.52 | dropout in backward: 1.91
 iteration       98/     100 | elapsed time per iteration (ms): 135.4 | learning rate: 8.182E-07 | lm loss: 1.033927E+01 | sop loss: 5.500177E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.10 | forward: 31.43 | backward: 96.71 | allreduce: 8.49 | optimizer: 5.33 | bias in backward: 2.40 | dropout in backward: 1.84
 iteration       99/     100 | elapsed time per iteration (ms): 155.7 | learning rate: 8.283E-07 | lm loss: 1.019585E+01 | sop loss: 8.887564E-01 | loss scale: 65536.0 |
time (ms) | total time: 155.43 | forward: 31.44 | backward: 116.92 | allreduce: 10.86 | optimizer: 5.32 | bias in backward: 2.28 | dropout in backward: 1.79
 iteration      100/     100 | elapsed time per iteration (ms): 137.5 | learning rate: 8.384E-07 | lm loss: 1.021724E+01 | sop loss: 5.119321E-01 | loss scale: 65536.0 |
time (ms) | total time: 137.21 | forward: 32.61 | backward: 97.59 | allreduce: 8.63 | optimizer: 5.32 | bias in backward: 2.42 | dropout in backward: 1.85
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

8

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.120527 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_800mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.004 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_800mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_800mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3486.78 | train/valid/test data iterators: 2347.91
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 3100.3 | learning rate: 0.000E+00 | lm loss: 1.056675E+01 | sop loss: 8.516246E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 693.09228515625 | max allocated: 3578.14599609375 | cached: 3950.0 | max cached: 3950.0
time (ms) | total time: 3100.09 | forward: 2542.77 | backward: 393.39 | allreduce: 14.22 | optimizer: 0.04 | bias in backward: 30.21 | dropout in backward: 2.89
 iteration        2/     100 | elapsed time per iteration (ms): 118.9 | learning rate: 0.000E+00 | lm loss: 1.044383E+01 | sop loss: 9.356399E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 117.24 | forward: 43.14 | backward: 71.88 | allreduce: 9.46 | optimizer: 0.04 | bias in backward: 2.35 | dropout in backward: 2.37
 iteration        3/     100 | elapsed time per iteration (ms): 118.9 | learning rate: 0.000E+00 | lm loss: 1.055234E+01 | sop loss: 6.332365E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 118.57 | forward: 41.17 | backward: 74.84 | allreduce: 9.64 | optimizer: 0.04 | bias in backward: 2.38 | dropout in backward: 2.35
 iteration        4/     100 | elapsed time per iteration (ms): 117.3 | learning rate: 0.000E+00 | lm loss: 1.049772E+01 | sop loss: 6.507702E-01 | loss scale: 536870912.0 |
time (ms) | total time: 117.00 | forward: 43.09 | backward: 71.42 | allreduce: 9.33 | optimizer: 0.03 | bias in backward: 2.34 | dropout in backward: 2.37
 iteration        5/     100 | elapsed time per iteration (ms): 121.8 | learning rate: 0.000E+00 | lm loss: 1.060292E+01 | sop loss: 7.023515E-01 | loss scale: 268435456.0 |
time (ms) | total time: 121.51 | forward: 41.75 | backward: 77.28 | allreduce: 9.27 | optimizer: 0.03 | bias in backward: 2.42 | dropout in backward: 2.48
 iteration        6/     100 | elapsed time per iteration (ms): 120.8 | learning rate: 0.000E+00 | lm loss: 1.056129E+01 | sop loss: 7.090925E-01 | loss scale: 134217728.0 |
time (ms) | total time: 120.48 | forward: 41.25 | backward: 76.89 | allreduce: 9.25 | optimizer: 0.03 | bias in backward: 2.35 | dropout in backward: 2.36
 iteration        7/     100 | elapsed time per iteration (ms): 114.5 | learning rate: 0.000E+00 | lm loss: 1.058667E+01 | sop loss: 8.465342E-01 | loss scale: 67108864.0 |
time (ms) | total time: 114.28 | forward: 40.85 | backward: 71.11 | allreduce: 9.08 | optimizer: 0.03 | bias in backward: 2.52 | dropout in backward: 2.44
 iteration        8/     100 | elapsed time per iteration (ms): 115.7 | learning rate: 0.000E+00 | lm loss: 1.050665E+01 | sop loss: 7.547249E-01 | loss scale: 33554432.0 |
time (ms) | total time: 115.31 | forward: 41.25 | backward: 71.70 | allreduce: 9.27 | optimizer: 0.03 | bias in backward: 2.42 | dropout in backward: 2.38
 iteration        9/     100 | elapsed time per iteration (ms): 119.8 | learning rate: 0.000E+00 | lm loss: 1.050636E+01 | sop loss: 7.498597E-01 | loss scale: 16777216.0 |
time (ms) | total time: 119.48 | forward: 42.71 | backward: 72.86 | allreduce: 9.66 | optimizer: 0.03 | bias in backward: 2.43 | dropout in backward: 2.52
 iteration       10/     100 | elapsed time per iteration (ms): 116.9 | learning rate: 0.000E+00 | lm loss: 1.056690E+01 | sop loss: 7.601988E-01 | loss scale: 8388608.0 |
time (ms) | total time: 116.58 | forward: 41.53 | backward: 72.69 | allreduce: 9.33 | optimizer: 0.03 | bias in backward: 2.50 | dropout in backward: 2.47
 iteration       11/     100 | elapsed time per iteration (ms): 116.3 | learning rate: 0.000E+00 | lm loss: 1.058038E+01 | sop loss: 7.271165E-01 | loss scale: 4194304.0 |
time (ms) | total time: 115.97 | forward: 41.30 | backward: 72.18 | allreduce: 9.40 | optimizer: 0.03 | bias in backward: 2.35 | dropout in backward: 2.36
 iteration       12/     100 | elapsed time per iteration (ms): 116.6 | learning rate: 0.000E+00 | lm loss: 1.050805E+01 | sop loss: 6.379355E-01 | loss scale: 2097152.0 |
time (ms) | total time: 116.27 | forward: 41.50 | backward: 72.18 | allreduce: 9.27 | optimizer: 0.03 | bias in backward: 2.65 | dropout in backward: 2.71
 iteration       13/     100 | elapsed time per iteration (ms): 115.0 | learning rate: 0.000E+00 | lm loss: 1.058156E+01 | sop loss: 7.873409E-01 | loss scale: 1048576.0 |
time (ms) | total time: 114.69 | forward: 41.36 | backward: 70.98 | allreduce: 9.06 | optimizer: 0.03 | bias in backward: 2.35 | dropout in backward: 2.36
 iteration       14/     100 | elapsed time per iteration (ms): 115.6 | learning rate: 0.000E+00 | lm loss: 1.055267E+01 | sop loss: 6.685334E-01 | loss scale: 524288.0 |
time (ms) | total time: 115.29 | forward: 41.20 | backward: 71.67 | allreduce: 9.34 | optimizer: 0.03 | bias in backward: 2.35 | dropout in backward: 2.35
 iteration       15/     100 | elapsed time per iteration (ms): 124.5 | learning rate: 0.000E+00 | lm loss: 1.057448E+01 | sop loss: 7.403679E-01 | loss scale: 262144.0 |
time (ms) | total time: 124.19 | forward: 42.97 | backward: 78.72 | allreduce: 11.24 | optimizer: 0.03 | bias in backward: 2.34 | dropout in backward: 2.37
 iteration       16/     100 | elapsed time per iteration (ms): 125.9 | learning rate: 0.000E+00 | lm loss: 1.055482E+01 | sop loss: 7.777128E-01 | loss scale: 131072.0 |
time (ms) | total time: 125.60 | forward: 41.19 | backward: 82.20 | allreduce: 11.37 | optimizer: 0.03 | bias in backward: 2.33 | dropout in backward: 2.36
 iteration       17/     100 | elapsed time per iteration (ms): 285.2 | learning rate: 1.010E-08 | lm loss: 1.058844E+01 | sop loss: 6.729390E-01 | loss scale: 131072.0 |
time (ms) | total time: 284.91 | forward: 41.20 | backward: 148.64 | allreduce: 10.94 | optimizer: 92.69 | bias in backward: 2.45 | dropout in backward: 2.44
 iteration       18/     100 | elapsed time per iteration (ms): 262.6 | learning rate: 2.020E-08 | lm loss: 1.051094E+01 | sop loss: 5.833932E-01 | loss scale: 131072.0 |
time (ms) | total time: 262.28 | forward: 139.36 | backward: 111.06 | allreduce: 9.50 | optimizer: 5.33 | bias in backward: 2.37 | dropout in backward: 2.41
 iteration       19/     100 | elapsed time per iteration (ms): 160.9 | learning rate: 3.030E-08 | lm loss: 1.059455E+01 | sop loss: 7.486923E-01 | loss scale: 131072.0 |
time (ms) | total time: 160.64 | forward: 41.29 | backward: 111.73 | allreduce: 9.15 | optimizer: 5.36 | bias in backward: 3.10 | dropout in backward: 2.70
 iteration       20/     100 | elapsed time per iteration (ms): 161.4 | learning rate: 4.040E-08 | lm loss: 1.056863E+01 | sop loss: 9.282961E-01 | loss scale: 131072.0 |
time (ms) | total time: 161.12 | forward: 42.09 | backward: 111.52 | allreduce: 9.04 | optimizer: 5.35 | bias in backward: 3.12 | dropout in backward: 2.66
 iteration       21/     100 | elapsed time per iteration (ms): 160.8 | learning rate: 5.051E-08 | lm loss: 1.058515E+01 | sop loss: 6.470057E-01 | loss scale: 131072.0 |
time (ms) | total time: 160.47 | forward: 42.52 | backward: 110.70 | allreduce: 8.92 | optimizer: 5.33 | bias in backward: 2.97 | dropout in backward: 2.55
 iteration       22/     100 | elapsed time per iteration (ms): 162.4 | learning rate: 6.061E-08 | lm loss: 1.054078E+01 | sop loss: 8.163151E-01 | loss scale: 131072.0 |
time (ms) | total time: 162.17 | forward: 42.53 | backward: 112.48 | allreduce: 8.76 | optimizer: 5.32 | bias in backward: 2.87 | dropout in backward: 2.54
 iteration       23/     100 | elapsed time per iteration (ms): 162.1 | learning rate: 7.071E-08 | lm loss: 1.058335E+01 | sop loss: 7.308633E-01 | loss scale: 131072.0 |
time (ms) | total time: 161.85 | forward: 42.21 | backward: 112.24 | allreduce: 11.27 | optimizer: 5.35 | bias in backward: 2.89 | dropout in backward: 2.56
 iteration       24/     100 | elapsed time per iteration (ms): 161.9 | learning rate: 8.081E-08 | lm loss: 1.056003E+01 | sop loss: 7.779921E-01 | loss scale: 131072.0 |
time (ms) | total time: 161.63 | forward: 42.80 | backward: 111.12 | allreduce: 8.78 | optimizer: 5.38 | bias in backward: 2.98 | dropout in backward: 2.65
 iteration       25/     100 | elapsed time per iteration (ms): 161.5 | learning rate: 9.091E-08 | lm loss: 1.057425E+01 | sop loss: 7.287611E-01 | loss scale: 131072.0 |
time (ms) | total time: 161.22 | forward: 42.06 | backward: 111.69 | allreduce: 9.01 | optimizer: 5.31 | bias in backward: 3.05 | dropout in backward: 2.65
 iteration       26/     100 | elapsed time per iteration (ms): 163.3 | learning rate: 1.010E-07 | lm loss: 1.056974E+01 | sop loss: 6.513311E-01 | loss scale: 131072.0 |
time (ms) | total time: 163.03 | forward: 41.49 | backward: 114.02 | allreduce: 8.91 | optimizer: 5.37 | bias in backward: 2.91 | dropout in backward: 2.59
 iteration       27/     100 | elapsed time per iteration (ms): 165.6 | learning rate: 1.111E-07 | lm loss: 1.051540E+01 | sop loss: 7.112176E-01 | loss scale: 131072.0 |
time (ms) | total time: 165.29 | forward: 46.61 | backward: 111.36 | allreduce: 8.88 | optimizer: 5.31 | bias in backward: 2.96 | dropout in backward: 2.78
 iteration       28/     100 | elapsed time per iteration (ms): 160.5 | learning rate: 1.212E-07 | lm loss: 1.057179E+01 | sop loss: 6.406608E-01 | loss scale: 131072.0 |
time (ms) | total time: 160.19 | forward: 41.63 | backward: 111.39 | allreduce: 8.95 | optimizer: 5.31 | bias in backward: 3.15 | dropout in backward: 2.61
 iteration       29/     100 | elapsed time per iteration (ms): 160.2 | learning rate: 1.313E-07 | lm loss: 1.053497E+01 | sop loss: 5.862308E-01 | loss scale: 131072.0 |
time (ms) | total time: 159.86 | forward: 42.32 | backward: 110.41 | allreduce: 8.76 | optimizer: 5.32 | bias in backward: 3.05 | dropout in backward: 2.73
 iteration       30/     100 | elapsed time per iteration (ms): 162.3 | learning rate: 1.414E-07 | lm loss: 1.052970E+01 | sop loss: 7.035108E-01 | loss scale: 131072.0 |
time (ms) | total time: 161.94 | forward: 41.80 | backward: 112.75 | allreduce: 11.35 | optimizer: 5.33 | bias in backward: 2.90 | dropout in backward: 2.57
 iteration       31/     100 | elapsed time per iteration (ms): 160.9 | learning rate: 1.515E-07 | lm loss: 1.062404E+01 | sop loss: 7.360434E-01 | loss scale: 131072.0 |
time (ms) | total time: 160.66 | forward: 42.39 | backward: 110.96 | allreduce: 8.88 | optimizer: 5.30 | bias in backward: 3.00 | dropout in backward: 2.66
 iteration       32/     100 | elapsed time per iteration (ms): 161.1 | learning rate: 1.616E-07 | lm loss: 1.047382E+01 | sop loss: 7.021033E-01 | loss scale: 131072.0 |
time (ms) | total time: 160.86 | forward: 42.01 | backward: 111.69 | allreduce: 8.88 | optimizer: 5.28 | bias in backward: 2.91 | dropout in backward: 2.58
 iteration       33/     100 | elapsed time per iteration (ms): 159.8 | learning rate: 1.717E-07 | lm loss: 1.059620E+01 | sop loss: 7.915503E-01 | loss scale: 131072.0 |
time (ms) | total time: 159.53 | forward: 42.41 | backward: 109.99 | allreduce: 9.42 | optimizer: 5.32 | bias in backward: 2.89 | dropout in backward: 2.55
 iteration       34/     100 | elapsed time per iteration (ms): 161.8 | learning rate: 1.818E-07 | lm loss: 1.057762E+01 | sop loss: 7.745098E-01 | loss scale: 131072.0 |
time (ms) | total time: 161.53 | forward: 42.41 | backward: 111.87 | allreduce: 9.17 | optimizer: 5.31 | bias in backward: 2.89 | dropout in backward: 2.56
 iteration       35/     100 | elapsed time per iteration (ms): 160.2 | learning rate: 1.919E-07 | lm loss: 1.056958E+01 | sop loss: 8.139544E-01 | loss scale: 131072.0 |
time (ms) | total time: 159.90 | forward: 42.26 | backward: 110.43 | allreduce: 8.83 | optimizer: 5.30 | bias in backward: 2.88 | dropout in backward: 2.54
 iteration       36/     100 | elapsed time per iteration (ms): 159.6 | learning rate: 2.020E-07 | lm loss: 1.057024E+01 | sop loss: 6.887506E-01 | loss scale: 131072.0 |
time (ms) | total time: 159.29 | forward: 41.47 | backward: 110.75 | allreduce: 8.82 | optimizer: 5.31 | bias in backward: 2.89 | dropout in backward: 2.54
 iteration       37/     100 | elapsed time per iteration (ms): 160.1 | learning rate: 2.121E-07 | lm loss: 1.060591E+01 | sop loss: 7.572103E-01 | loss scale: 131072.0 |
time (ms) | total time: 159.79 | forward: 41.49 | backward: 111.16 | allreduce: 8.81 | optimizer: 5.33 | bias in backward: 2.88 | dropout in backward: 2.56
 iteration       38/     100 | elapsed time per iteration (ms): 161.6 | learning rate: 2.222E-07 | lm loss: 1.055397E+01 | sop loss: 7.124486E-01 | loss scale: 131072.0 |
time (ms) | total time: 161.29 | forward: 41.58 | backward: 112.21 | allreduce: 9.13 | optimizer: 5.32 | bias in backward: 3.10 | dropout in backward: 2.60
 iteration       39/     100 | elapsed time per iteration (ms): 160.3 | learning rate: 2.323E-07 | lm loss: 1.052552E+01 | sop loss: 6.290004E-01 | loss scale: 131072.0 |
time (ms) | total time: 160.01 | forward: 41.77 | backward: 110.91 | allreduce: 8.75 | optimizer: 5.31 | bias in backward: 2.94 | dropout in backward: 2.62
 iteration       40/     100 | elapsed time per iteration (ms): 160.8 | learning rate: 2.424E-07 | lm loss: 1.054409E+01 | sop loss: 6.014338E-01 | loss scale: 131072.0 |
time (ms) | total time: 160.56 | forward: 41.73 | backward: 111.34 | allreduce: 9.09 | optimizer: 5.34 | bias in backward: 3.09 | dropout in backward: 2.70
 iteration       41/     100 | elapsed time per iteration (ms): 162.3 | learning rate: 2.525E-07 | lm loss: 1.057224E+01 | sop loss: 7.400991E-01 | loss scale: 131072.0 |
time (ms) | total time: 162.04 | forward: 42.88 | backward: 111.86 | allreduce: 8.87 | optimizer: 5.31 | bias in backward: 2.95 | dropout in backward: 2.66
 iteration       42/     100 | elapsed time per iteration (ms): 159.9 | learning rate: 2.626E-07 | lm loss: 1.056134E+01 | sop loss: 7.252970E-01 | loss scale: 131072.0 |
time (ms) | total time: 159.58 | forward: 41.66 | backward: 110.66 | allreduce: 8.75 | optimizer: 5.31 | bias in backward: 3.08 | dropout in backward: 2.72
 iteration       43/     100 | elapsed time per iteration (ms): 160.5 | learning rate: 2.727E-07 | lm loss: 1.059354E+01 | sop loss: 7.249523E-01 | loss scale: 131072.0 |
time (ms) | total time: 160.18 | forward: 42.53 | backward: 110.61 | allreduce: 8.68 | optimizer: 5.30 | bias in backward: 3.05 | dropout in backward: 2.71
 iteration       44/     100 | elapsed time per iteration (ms): 163.4 | learning rate: 2.828E-07 | lm loss: 1.049605E+01 | sop loss: 6.277046E-01 | loss scale: 131072.0 |
time (ms) | total time: 163.16 | forward: 41.90 | backward: 114.03 | allreduce: 8.66 | optimizer: 5.30 | bias in backward: 2.99 | dropout in backward: 2.64
 iteration       45/     100 | elapsed time per iteration (ms): 163.8 | learning rate: 2.929E-07 | lm loss: 1.055359E+01 | sop loss: 6.884204E-01 | loss scale: 131072.0 |
time (ms) | total time: 163.55 | forward: 43.16 | backward: 113.34 | allreduce: 8.64 | optimizer: 5.29 | bias in backward: 2.97 | dropout in backward: 2.67
 iteration       46/     100 | elapsed time per iteration (ms): 162.6 | learning rate: 3.030E-07 | lm loss: 1.056856E+01 | sop loss: 8.027422E-01 | loss scale: 131072.0 |
time (ms) | total time: 162.37 | forward: 42.54 | backward: 112.74 | allreduce: 10.93 | optimizer: 5.27 | bias in backward: 2.96 | dropout in backward: 2.66
 iteration       47/     100 | elapsed time per iteration (ms): 160.8 | learning rate: 3.131E-07 | lm loss: 1.053548E+01 | sop loss: 7.789658E-01 | loss scale: 131072.0 |
time (ms) | total time: 160.52 | forward: 42.52 | backward: 110.91 | allreduce: 8.68 | optimizer: 5.28 | bias in backward: 3.02 | dropout in backward: 2.75
 iteration       48/     100 | elapsed time per iteration (ms): 161.2 | learning rate: 3.232E-07 | lm loss: 1.056342E+01 | sop loss: 7.567846E-01 | loss scale: 131072.0 |
time (ms) | total time: 160.93 | forward: 42.52 | backward: 111.42 | allreduce: 8.65 | optimizer: 5.28 | bias in backward: 2.87 | dropout in backward: 2.59
 iteration       49/     100 | elapsed time per iteration (ms): 158.8 | learning rate: 3.333E-07 | lm loss: 1.060717E+01 | sop loss: 6.970888E-01 | loss scale: 131072.0 |
time (ms) | total time: 158.54 | forward: 41.95 | backward: 109.53 | allreduce: 8.63 | optimizer: 5.28 | bias in backward: 2.88 | dropout in backward: 2.55
 iteration       50/     100 | elapsed time per iteration (ms): 159.0 | learning rate: 3.434E-07 | lm loss: 1.057380E+01 | sop loss: 5.877497E-01 | loss scale: 131072.0 |
time (ms) | total time: 158.75 | forward: 41.38 | backward: 110.14 | allreduce: 8.71 | optimizer: 5.29 | bias in backward: 2.97 | dropout in backward: 2.67
 iteration       51/     100 | elapsed time per iteration (ms): 158.5 | learning rate: 3.535E-07 | lm loss: 1.056845E+01 | sop loss: 7.718755E-01 | loss scale: 131072.0 |
time (ms) | total time: 158.27 | forward: 41.71 | backward: 109.65 | allreduce: 8.65 | optimizer: 5.29 | bias in backward: 2.92 | dropout in backward: 2.59
 iteration       52/     100 | elapsed time per iteration (ms): 161.3 | learning rate: 3.636E-07 | lm loss: 1.055128E+01 | sop loss: 6.317961E-01 | loss scale: 131072.0 |
time (ms) | total time: 161.00 | forward: 41.99 | backward: 111.90 | allreduce: 8.63 | optimizer: 5.30 | bias in backward: 2.87 | dropout in backward: 2.55
 iteration       53/     100 | elapsed time per iteration (ms): 159.7 | learning rate: 3.737E-07 | lm loss: 1.059201E+01 | sop loss: 6.200452E-01 | loss scale: 131072.0 |
time (ms) | total time: 159.40 | forward: 42.19 | backward: 110.26 | allreduce: 8.67 | optimizer: 5.29 | bias in backward: 3.03 | dropout in backward: 2.59
 iteration       54/     100 | elapsed time per iteration (ms): 159.5 | learning rate: 3.838E-07 | lm loss: 1.055649E+01 | sop loss: 7.749580E-01 | loss scale: 131072.0 |
time (ms) | total time: 159.25 | forward: 41.79 | backward: 110.31 | allreduce: 8.73 | optimizer: 5.31 | bias in backward: 3.04 | dropout in backward: 2.57
 iteration       55/     100 | elapsed time per iteration (ms): 159.4 | learning rate: 3.939E-07 | lm loss: 1.052523E+01 | sop loss: 6.742438E-01 | loss scale: 131072.0 |
time (ms) | total time: 159.11 | forward: 41.92 | backward: 110.23 | allreduce: 8.74 | optimizer: 5.30 | bias in backward: 2.98 | dropout in backward: 2.62
 iteration       56/     100 | elapsed time per iteration (ms): 131.5 | learning rate: 3.939E-07 | lm loss: 1.055988E+01 | sop loss: 7.615283E-01 | loss scale: 65536.0 |
time (ms) | total time: 131.24 | forward: 41.81 | backward: 87.63 | allreduce: 8.72 | optimizer: 0.03 | bias in backward: 3.02 | dropout in backward: 2.66
 iteration       57/     100 | elapsed time per iteration (ms): 159.7 | learning rate: 4.040E-07 | lm loss: 1.058659E+01 | sop loss: 7.131608E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.45 | forward: 41.50 | backward: 110.86 | allreduce: 8.81 | optimizer: 5.31 | bias in backward: 2.96 | dropout in backward: 2.71
 iteration       58/     100 | elapsed time per iteration (ms): 161.0 | learning rate: 4.141E-07 | lm loss: 1.058523E+01 | sop loss: 5.906610E-01 | loss scale: 65536.0 |
time (ms) | total time: 160.70 | forward: 41.33 | backward: 111.89 | allreduce: 11.13 | optimizer: 5.34 | bias in backward: 2.86 | dropout in backward: 2.57
 iteration       59/     100 | elapsed time per iteration (ms): 161.0 | learning rate: 4.242E-07 | lm loss: 1.053237E+01 | sop loss: 7.345795E-01 | loss scale: 65536.0 |
time (ms) | total time: 160.71 | forward: 41.65 | backward: 111.60 | allreduce: 9.06 | optimizer: 5.36 | bias in backward: 3.08 | dropout in backward: 2.58
 iteration       60/     100 | elapsed time per iteration (ms): 162.0 | learning rate: 4.343E-07 | lm loss: 1.053388E+01 | sop loss: 8.034747E-01 | loss scale: 65536.0 |
time (ms) | total time: 161.73 | forward: 42.66 | backward: 111.77 | allreduce: 8.95 | optimizer: 5.32 | bias in backward: 2.93 | dropout in backward: 2.56
 iteration       61/     100 | elapsed time per iteration (ms): 163.4 | learning rate: 4.444E-07 | lm loss: 1.055091E+01 | sop loss: 7.357609E-01 | loss scale: 65536.0 |
time (ms) | total time: 163.08 | forward: 41.81 | backward: 113.92 | allreduce: 10.61 | optimizer: 5.32 | bias in backward: 2.98 | dropout in backward: 2.66
 iteration       62/     100 | elapsed time per iteration (ms): 172.1 | learning rate: 4.545E-07 | lm loss: 1.053989E+01 | sop loss: 7.974225E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.77 | forward: 42.15 | backward: 122.19 | allreduce: 11.67 | optimizer: 5.33 | bias in backward: 3.02 | dropout in backward: 2.65
 iteration       63/     100 | elapsed time per iteration (ms): 161.5 | learning rate: 4.646E-07 | lm loss: 1.049623E+01 | sop loss: 7.616292E-01 | loss scale: 65536.0 |
time (ms) | total time: 161.22 | forward: 42.13 | backward: 111.59 | allreduce: 8.90 | optimizer: 5.33 | bias in backward: 2.90 | dropout in backward: 2.57
 iteration       64/     100 | elapsed time per iteration (ms): 160.0 | learning rate: 4.747E-07 | lm loss: 1.050332E+01 | sop loss: 8.057378E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.75 | forward: 42.47 | backward: 110.36 | allreduce: 8.71 | optimizer: 5.30 | bias in backward: 3.12 | dropout in backward: 2.65
 iteration       65/     100 | elapsed time per iteration (ms): 159.6 | learning rate: 4.848E-07 | lm loss: 1.051214E+01 | sop loss: 6.430906E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.31 | forward: 42.18 | backward: 109.95 | allreduce: 8.66 | optimizer: 5.32 | bias in backward: 2.87 | dropout in backward: 2.54
 iteration       66/     100 | elapsed time per iteration (ms): 160.2 | learning rate: 4.949E-07 | lm loss: 1.053549E+01 | sop loss: 7.525475E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.90 | forward: 41.09 | backward: 111.41 | allreduce: 8.74 | optimizer: 5.32 | bias in backward: 2.88 | dropout in backward: 2.55
 iteration       67/     100 | elapsed time per iteration (ms): 160.3 | learning rate: 5.051E-07 | lm loss: 1.054167E+01 | sop loss: 7.136002E-01 | loss scale: 65536.0 |
time (ms) | total time: 160.02 | forward: 41.24 | backward: 111.52 | allreduce: 8.96 | optimizer: 5.33 | bias in backward: 2.94 | dropout in backward: 2.57
 iteration       68/     100 | elapsed time per iteration (ms): 158.8 | learning rate: 5.152E-07 | lm loss: 1.053245E+01 | sop loss: 7.484378E-01 | loss scale: 65536.0 |
time (ms) | total time: 158.54 | forward: 41.63 | backward: 109.86 | allreduce: 8.68 | optimizer: 5.30 | bias in backward: 3.10 | dropout in backward: 2.67
 iteration       69/     100 | elapsed time per iteration (ms): 160.3 | learning rate: 5.253E-07 | lm loss: 1.054838E+01 | sop loss: 6.605847E-01 | loss scale: 65536.0 |
time (ms) | total time: 160.01 | forward: 41.09 | backward: 111.82 | allreduce: 8.64 | optimizer: 5.29 | bias in backward: 2.99 | dropout in backward: 2.59
 iteration       70/     100 | elapsed time per iteration (ms): 158.8 | learning rate: 5.354E-07 | lm loss: 1.054980E+01 | sop loss: 8.532453E-01 | loss scale: 65536.0 |
time (ms) | total time: 158.56 | forward: 41.52 | backward: 110.16 | allreduce: 8.66 | optimizer: 5.27 | bias in backward: 2.88 | dropout in backward: 2.57
 iteration       71/     100 | elapsed time per iteration (ms): 160.6 | learning rate: 5.455E-07 | lm loss: 1.050822E+01 | sop loss: 7.584976E-01 | loss scale: 65536.0 |
time (ms) | total time: 160.35 | forward: 41.23 | backward: 112.09 | allreduce: 10.58 | optimizer: 5.28 | bias in backward: 2.87 | dropout in backward: 2.54
 iteration       72/     100 | elapsed time per iteration (ms): 160.6 | learning rate: 5.556E-07 | lm loss: 1.050568E+01 | sop loss: 6.985350E-01 | loss scale: 65536.0 |
time (ms) | total time: 160.35 | forward: 42.35 | backward: 111.13 | allreduce: 8.70 | optimizer: 5.29 | bias in backward: 2.89 | dropout in backward: 2.58
 iteration       73/     100 | elapsed time per iteration (ms): 158.9 | learning rate: 5.657E-07 | lm loss: 1.050582E+01 | sop loss: 7.972761E-01 | loss scale: 65536.0 |
time (ms) | total time: 158.63 | forward: 41.86 | backward: 109.64 | allreduce: 8.66 | optimizer: 5.30 | bias in backward: 3.04 | dropout in backward: 2.57
 iteration       74/     100 | elapsed time per iteration (ms): 160.1 | learning rate: 5.758E-07 | lm loss: 1.054400E+01 | sop loss: 6.376746E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.77 | forward: 43.52 | backward: 109.30 | allreduce: 8.64 | optimizer: 5.28 | bias in backward: 2.98 | dropout in backward: 2.62
 iteration       75/     100 | elapsed time per iteration (ms): 158.0 | learning rate: 5.859E-07 | lm loss: 1.051709E+01 | sop loss: 7.030768E-01 | loss scale: 65536.0 |
time (ms) | total time: 157.75 | forward: 41.35 | backward: 109.25 | allreduce: 8.62 | optimizer: 5.31 | bias in backward: 2.98 | dropout in backward: 2.68
 iteration       76/     100 | elapsed time per iteration (ms): 159.9 | learning rate: 5.960E-07 | lm loss: 1.052589E+01 | sop loss: 6.563056E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.62 | forward: 41.77 | backward: 110.84 | allreduce: 8.85 | optimizer: 5.30 | bias in backward: 2.90 | dropout in backward: 2.55
 iteration       77/     100 | elapsed time per iteration (ms): 158.1 | learning rate: 6.061E-07 | lm loss: 1.046280E+01 | sop loss: 6.892482E-01 | loss scale: 65536.0 |
time (ms) | total time: 157.86 | forward: 41.44 | backward: 109.27 | allreduce: 8.72 | optimizer: 5.29 | bias in backward: 2.96 | dropout in backward: 2.59
 iteration       78/     100 | elapsed time per iteration (ms): 159.2 | learning rate: 6.162E-07 | lm loss: 1.061580E+01 | sop loss: 7.355856E-01 | loss scale: 65536.0 |
time (ms) | total time: 158.89 | forward: 41.22 | backward: 110.67 | allreduce: 8.96 | optimizer: 5.31 | bias in backward: 3.18 | dropout in backward: 2.63
 iteration       79/     100 | elapsed time per iteration (ms): 158.5 | learning rate: 6.263E-07 | lm loss: 1.049953E+01 | sop loss: 7.095427E-01 | loss scale: 65536.0 |
time (ms) | total time: 158.20 | forward: 40.94 | backward: 110.19 | allreduce: 8.70 | optimizer: 5.29 | bias in backward: 2.98 | dropout in backward: 2.63
 iteration       80/     100 | elapsed time per iteration (ms): 158.8 | learning rate: 6.364E-07 | lm loss: 1.053104E+01 | sop loss: 6.811199E-01 | loss scale: 65536.0 |
time (ms) | total time: 158.53 | forward: 41.56 | backward: 109.88 | allreduce: 8.82 | optimizer: 5.30 | bias in backward: 3.06 | dropout in backward: 2.66
 iteration       81/     100 | elapsed time per iteration (ms): 160.0 | learning rate: 6.465E-07 | lm loss: 1.051310E+01 | sop loss: 6.616267E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.74 | forward: 41.18 | backward: 111.28 | allreduce: 8.98 | optimizer: 5.32 | bias in backward: 2.93 | dropout in backward: 2.57
 iteration       82/     100 | elapsed time per iteration (ms): 158.8 | learning rate: 6.566E-07 | lm loss: 1.053397E+01 | sop loss: 6.954193E-01 | loss scale: 65536.0 |
time (ms) | total time: 158.48 | forward: 41.06 | backward: 110.22 | allreduce: 8.74 | optimizer: 5.30 | bias in backward: 2.98 | dropout in backward: 2.62
 iteration       83/     100 | elapsed time per iteration (ms): 159.6 | learning rate: 6.667E-07 | lm loss: 1.055127E+01 | sop loss: 7.530929E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.29 | forward: 41.22 | backward: 111.00 | allreduce: 10.67 | optimizer: 5.30 | bias in backward: 2.89 | dropout in backward: 2.55
 iteration       84/     100 | elapsed time per iteration (ms): 161.2 | learning rate: 6.768E-07 | lm loss: 1.055452E+01 | sop loss: 7.331759E-01 | loss scale: 65536.0 |
time (ms) | total time: 160.94 | forward: 42.22 | backward: 111.65 | allreduce: 8.66 | optimizer: 5.28 | bias in backward: 2.87 | dropout in backward: 2.55
 iteration       85/     100 | elapsed time per iteration (ms): 160.5 | learning rate: 6.869E-07 | lm loss: 1.052615E+01 | sop loss: 5.413818E-01 | loss scale: 65536.0 |
time (ms) | total time: 160.22 | forward: 41.86 | backward: 111.10 | allreduce: 9.07 | optimizer: 5.34 | bias in backward: 2.90 | dropout in backward: 2.55
 iteration       86/     100 | elapsed time per iteration (ms): 160.2 | learning rate: 6.970E-07 | lm loss: 1.047140E+01 | sop loss: 8.340797E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.89 | forward: 41.35 | backward: 111.09 | allreduce: 9.08 | optimizer: 5.33 | bias in backward: 2.90 | dropout in backward: 2.57
 iteration       87/     100 | elapsed time per iteration (ms): 160.9 | learning rate: 7.071E-07 | lm loss: 1.052040E+01 | sop loss: 7.874103E-01 | loss scale: 65536.0 |
time (ms) | total time: 160.62 | forward: 41.58 | backward: 111.34 | allreduce: 9.20 | optimizer: 5.37 | bias in backward: 2.38 | dropout in backward: 2.44
 iteration       88/     100 | elapsed time per iteration (ms): 162.5 | learning rate: 7.172E-07 | lm loss: 1.051495E+01 | sop loss: 7.143226E-01 | loss scale: 65536.0 |
time (ms) | total time: 162.18 | forward: 41.70 | backward: 112.61 | allreduce: 11.86 | optimizer: 5.33 | bias in backward: 2.40 | dropout in backward: 2.37
 iteration       89/     100 | elapsed time per iteration (ms): 159.8 | learning rate: 7.273E-07 | lm loss: 1.053656E+01 | sop loss: 5.645005E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.56 | forward: 41.43 | backward: 110.31 | allreduce: 9.64 | optimizer: 5.34 | bias in backward: 2.49 | dropout in backward: 2.44
 iteration       90/     100 | elapsed time per iteration (ms): 159.6 | learning rate: 7.374E-07 | lm loss: 1.049964E+01 | sop loss: 7.939210E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.29 | forward: 41.73 | backward: 109.79 | allreduce: 9.20 | optimizer: 5.29 | bias in backward: 2.51 | dropout in backward: 2.39
 iteration       91/     100 | elapsed time per iteration (ms): 159.2 | learning rate: 7.475E-07 | lm loss: 1.053236E+01 | sop loss: 7.197845E-01 | loss scale: 65536.0 |
time (ms) | total time: 158.94 | forward: 41.59 | backward: 109.67 | allreduce: 9.16 | optimizer: 5.30 | bias in backward: 2.48 | dropout in backward: 2.45
 iteration       92/     100 | elapsed time per iteration (ms): 162.1 | learning rate: 7.576E-07 | lm loss: 1.053043E+01 | sop loss: 6.612458E-01 | loss scale: 65536.0 |
time (ms) | total time: 161.79 | forward: 41.83 | backward: 112.29 | allreduce: 11.27 | optimizer: 5.30 | bias in backward: 2.39 | dropout in backward: 2.39
 iteration       93/     100 | elapsed time per iteration (ms): 159.2 | learning rate: 7.677E-07 | lm loss: 1.055791E+01 | sop loss: 7.083492E-01 | loss scale: 65536.0 |
time (ms) | total time: 158.91 | forward: 41.17 | backward: 110.00 | allreduce: 9.23 | optimizer: 5.35 | bias in backward: 2.52 | dropout in backward: 2.55
 iteration       94/     100 | elapsed time per iteration (ms): 160.3 | learning rate: 7.778E-07 | lm loss: 1.050111E+01 | sop loss: 6.276674E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.99 | forward: 41.76 | backward: 111.06 | allreduce: 11.13 | optimizer: 5.34 | bias in backward: 2.39 | dropout in backward: 2.40
 iteration       95/     100 | elapsed time per iteration (ms): 159.9 | learning rate: 7.879E-07 | lm loss: 1.051779E+01 | sop loss: 7.472956E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.64 | forward: 41.66 | backward: 111.01 | allreduce: 8.67 | optimizer: 5.30 | bias in backward: 2.35 | dropout in backward: 2.38
 iteration       96/     100 | elapsed time per iteration (ms): 181.6 | learning rate: 7.980E-07 | lm loss: 1.055605E+01 | sop loss: 7.881759E-01 | loss scale: 65536.0 |
time (ms) | total time: 181.30 | forward: 41.59 | backward: 132.46 | allreduce: 32.35 | optimizer: 5.30 | bias in backward: 2.39 | dropout in backward: 2.38
 iteration       97/     100 | elapsed time per iteration (ms): 157.8 | learning rate: 8.081E-07 | lm loss: 1.053231E+01 | sop loss: 7.254711E-01 | loss scale: 65536.0 |
time (ms) | total time: 157.53 | forward: 41.73 | backward: 108.63 | allreduce: 8.66 | optimizer: 5.29 | bias in backward: 2.36 | dropout in backward: 2.39
 iteration       98/     100 | elapsed time per iteration (ms): 156.6 | learning rate: 8.182E-07 | lm loss: 1.046243E+01 | sop loss: 7.666625E-01 | loss scale: 65536.0 |
time (ms) | total time: 156.32 | forward: 41.05 | backward: 108.26 | allreduce: 8.64 | optimizer: 5.29 | bias in backward: 2.51 | dropout in backward: 2.48
 iteration       99/     100 | elapsed time per iteration (ms): 184.5 | learning rate: 8.283E-07 | lm loss: 1.055962E+01 | sop loss: 6.855955E-01 | loss scale: 65536.0 |
time (ms) | total time: 184.26 | forward: 41.80 | backward: 134.70 | allreduce: 8.89 | optimizer: 5.44 | bias in backward: 2.56 | dropout in backward: 2.54
 iteration      100/     100 | elapsed time per iteration (ms): 160.1 | learning rate: 8.384E-07 | lm loss: 1.051172E+01 | sop loss: 7.857810E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.82 | forward: 41.62 | backward: 109.98 | allreduce: 9.33 | optimizer: 5.37 | bias in backward: 2.41 | dropout in backward: 2.37
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

16

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.117769 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_1600mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.006 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_1600mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_1600mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3477.79 | train/valid/test data iterators: 2994.43
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 4196.1 | learning rate: 0.000E+00 | lm loss: 1.053678E+01 | sop loss: 7.036999E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 701.59228515625 | max allocated: 6647.09130859375 | cached: 6684.0 | max cached: 6684.0
time (ms) | total time: 4195.88 | forward: 3207.03 | backward: 528.01 | allreduce: 11.04 | optimizer: 0.05 | bias in backward: 27.18 | dropout in backward: 3.74
 iteration        2/     100 | elapsed time per iteration (ms): 182.1 | learning rate: 0.000E+00 | lm loss: 1.051447E+01 | sop loss: 7.399682E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 180.41 | forward: 69.21 | backward: 108.80 | allreduce: 9.39 | optimizer: 0.04 | bias in backward: 2.95 | dropout in backward: 3.77
 iteration        3/     100 | elapsed time per iteration (ms): 187.1 | learning rate: 0.000E+00 | lm loss: 1.055884E+01 | sop loss: 7.754551E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 186.82 | forward: 69.01 | backward: 115.10 | allreduce: 9.30 | optimizer: 0.04 | bias in backward: 2.94 | dropout in backward: 3.76
 iteration        4/     100 | elapsed time per iteration (ms): 181.0 | learning rate: 0.000E+00 | lm loss: 1.057216E+01 | sop loss: 7.799609E-01 | loss scale: 536870912.0 |
time (ms) | total time: 180.65 | forward: 69.39 | backward: 108.71 | allreduce: 9.28 | optimizer: 0.04 | bias in backward: 2.94 | dropout in backward: 3.76
 iteration        5/     100 | elapsed time per iteration (ms): 183.0 | learning rate: 0.000E+00 | lm loss: 1.051344E+01 | sop loss: 6.764897E-01 | loss scale: 268435456.0 |
time (ms) | total time: 182.72 | forward: 69.49 | backward: 109.44 | allreduce: 9.78 | optimizer: 0.04 | bias in backward: 3.22 | dropout in backward: 3.77
 iteration        6/     100 | elapsed time per iteration (ms): 181.4 | learning rate: 0.000E+00 | lm loss: 1.057910E+01 | sop loss: 6.983265E-01 | loss scale: 134217728.0 |
time (ms) | total time: 181.12 | forward: 69.01 | backward: 108.94 | allreduce: 9.27 | optimizer: 0.04 | bias in backward: 3.03 | dropout in backward: 3.89
 iteration        7/     100 | elapsed time per iteration (ms): 179.8 | learning rate: 0.000E+00 | lm loss: 1.056656E+01 | sop loss: 7.848222E-01 | loss scale: 67108864.0 |
time (ms) | total time: 179.52 | forward: 69.02 | backward: 108.19 | allreduce: 8.88 | optimizer: 0.04 | bias in backward: 2.93 | dropout in backward: 3.72
 iteration        8/     100 | elapsed time per iteration (ms): 180.2 | learning rate: 0.000E+00 | lm loss: 1.054527E+01 | sop loss: 8.068389E-01 | loss scale: 33554432.0 |
time (ms) | total time: 179.86 | forward: 69.12 | backward: 108.61 | allreduce: 8.69 | optimizer: 0.03 | bias in backward: 3.23 | dropout in backward: 3.84
 iteration        9/     100 | elapsed time per iteration (ms): 180.8 | learning rate: 0.000E+00 | lm loss: 1.053043E+01 | sop loss: 5.828916E-01 | loss scale: 16777216.0 |
time (ms) | total time: 180.49 | forward: 69.28 | backward: 107.77 | allreduce: 9.37 | optimizer: 0.03 | bias in backward: 2.94 | dropout in backward: 3.73
 iteration       10/     100 | elapsed time per iteration (ms): 180.6 | learning rate: 0.000E+00 | lm loss: 1.056975E+01 | sop loss: 7.990451E-01 | loss scale: 8388608.0 |
time (ms) | total time: 180.30 | forward: 69.12 | backward: 108.58 | allreduce: 9.32 | optimizer: 0.03 | bias in backward: 2.95 | dropout in backward: 3.74
 iteration       11/     100 | elapsed time per iteration (ms): 187.3 | learning rate: 0.000E+00 | lm loss: 1.056477E+01 | sop loss: 7.604636E-01 | loss scale: 4194304.0 |
time (ms) | total time: 187.01 | forward: 69.17 | backward: 114.87 | allreduce: 10.25 | optimizer: 0.04 | bias in backward: 2.96 | dropout in backward: 3.78
 iteration       12/     100 | elapsed time per iteration (ms): 182.2 | learning rate: 0.000E+00 | lm loss: 1.054568E+01 | sop loss: 7.192885E-01 | loss scale: 2097152.0 |
time (ms) | total time: 181.84 | forward: 69.41 | backward: 109.19 | allreduce: 9.44 | optimizer: 0.04 | bias in backward: 3.22 | dropout in backward: 3.80
 iteration       13/     100 | elapsed time per iteration (ms): 186.7 | learning rate: 0.000E+00 | lm loss: 1.054572E+01 | sop loss: 7.624563E-01 | loss scale: 1048576.0 |
time (ms) | total time: 186.35 | forward: 68.91 | backward: 113.79 | allreduce: 11.23 | optimizer: 0.04 | bias in backward: 2.95 | dropout in backward: 3.74
 iteration       14/     100 | elapsed time per iteration (ms): 186.7 | learning rate: 0.000E+00 | lm loss: 1.058239E+01 | sop loss: 7.849607E-01 | loss scale: 524288.0 |
time (ms) | total time: 186.38 | forward: 69.40 | backward: 113.73 | allreduce: 9.16 | optimizer: 0.04 | bias in backward: 2.94 | dropout in backward: 3.73
 iteration       15/     100 | elapsed time per iteration (ms): 185.0 | learning rate: 0.000E+00 | lm loss: 1.054348E+01 | sop loss: 7.012174E-01 | loss scale: 262144.0 |
time (ms) | total time: 184.75 | forward: 69.20 | backward: 113.07 | allreduce: 9.11 | optimizer: 0.04 | bias in backward: 2.95 | dropout in backward: 3.75
 iteration       16/     100 | elapsed time per iteration (ms): 410.3 | learning rate: 1.010E-08 | lm loss: 1.054210E+01 | sop loss: 7.194545E-01 | loss scale: 262144.0 |
time (ms) | total time: 409.98 | forward: 69.19 | backward: 201.72 | allreduce: 9.39 | optimizer: 136.11 | bias in backward: 3.33 | dropout in backward: 3.76
 iteration       17/     100 | elapsed time per iteration (ms): 248.3 | learning rate: 2.020E-08 | lm loss: 1.058854E+01 | sop loss: 7.712462E-01 | loss scale: 262144.0 |
time (ms) | total time: 247.90 | forward: 87.15 | backward: 147.96 | allreduce: 9.63 | optimizer: 5.31 | bias in backward: 3.11 | dropout in backward: 3.81
 iteration       18/     100 | elapsed time per iteration (ms): 224.2 | learning rate: 3.030E-08 | lm loss: 1.053116E+01 | sop loss: 6.529092E-01 | loss scale: 262144.0 |
time (ms) | total time: 223.85 | forward: 69.15 | backward: 145.64 | allreduce: 9.20 | optimizer: 6.33 | bias in backward: 2.95 | dropout in backward: 3.74
 iteration       19/     100 | elapsed time per iteration (ms): 225.7 | learning rate: 4.040E-08 | lm loss: 1.055277E+01 | sop loss: 6.172689E-01 | loss scale: 262144.0 |
time (ms) | total time: 225.35 | forward: 69.14 | backward: 146.95 | allreduce: 9.44 | optimizer: 6.16 | bias in backward: 2.96 | dropout in backward: 3.75
 iteration       20/     100 | elapsed time per iteration (ms): 225.1 | learning rate: 5.051E-08 | lm loss: 1.055454E+01 | sop loss: 6.612526E-01 | loss scale: 262144.0 |
time (ms) | total time: 224.84 | forward: 69.38 | backward: 147.40 | allreduce: 10.44 | optimizer: 5.35 | bias in backward: 2.94 | dropout in backward: 3.76
 iteration       21/     100 | elapsed time per iteration (ms): 224.9 | learning rate: 6.061E-08 | lm loss: 1.057075E+01 | sop loss: 7.904272E-01 | loss scale: 262144.0 |
time (ms) | total time: 224.63 | forward: 69.19 | backward: 147.31 | allreduce: 9.70 | optimizer: 5.34 | bias in backward: 2.95 | dropout in backward: 3.75
 iteration       22/     100 | elapsed time per iteration (ms): 225.3 | learning rate: 7.071E-08 | lm loss: 1.055062E+01 | sop loss: 7.058959E-01 | loss scale: 262144.0 |
time (ms) | total time: 225.01 | forward: 69.00 | backward: 148.06 | allreduce: 10.73 | optimizer: 5.31 | bias in backward: 3.08 | dropout in backward: 3.90
 iteration       23/     100 | elapsed time per iteration (ms): 224.6 | learning rate: 8.081E-08 | lm loss: 1.053609E+01 | sop loss: 7.021685E-01 | loss scale: 262144.0 |
time (ms) | total time: 224.27 | forward: 69.24 | backward: 146.99 | allreduce: 9.88 | optimizer: 5.31 | bias in backward: 2.95 | dropout in backward: 3.74
 iteration       24/     100 | elapsed time per iteration (ms): 224.5 | learning rate: 9.091E-08 | lm loss: 1.054146E+01 | sop loss: 5.828590E-01 | loss scale: 262144.0 |
time (ms) | total time: 224.19 | forward: 69.36 | backward: 146.86 | allreduce: 9.43 | optimizer: 5.28 | bias in backward: 2.96 | dropout in backward: 3.75
 iteration       25/     100 | elapsed time per iteration (ms): 223.7 | learning rate: 1.010E-07 | lm loss: 1.056550E+01 | sop loss: 6.489963E-01 | loss scale: 262144.0 |
time (ms) | total time: 223.41 | forward: 69.21 | backward: 146.24 | allreduce: 9.66 | optimizer: 5.32 | bias in backward: 3.12 | dropout in backward: 3.76
 iteration       26/     100 | elapsed time per iteration (ms): 226.0 | learning rate: 1.111E-07 | lm loss: 1.058258E+01 | sop loss: 7.331449E-01 | loss scale: 262144.0 |
time (ms) | total time: 225.66 | forward: 69.16 | backward: 148.34 | allreduce: 9.68 | optimizer: 5.33 | bias in backward: 3.17 | dropout in backward: 3.78
 iteration       27/     100 | elapsed time per iteration (ms): 226.9 | learning rate: 1.212E-07 | lm loss: 1.059441E+01 | sop loss: 6.669636E-01 | loss scale: 262144.0 |
time (ms) | total time: 226.57 | forward: 69.50 | backward: 149.02 | allreduce: 9.75 | optimizer: 5.35 | bias in backward: 2.96 | dropout in backward: 3.77
 iteration       28/     100 | elapsed time per iteration (ms): 195.3 | learning rate: 1.212E-07 | lm loss: 1.049749E+01 | sop loss: 7.548798E-01 | loss scale: 131072.0 |
time (ms) | total time: 195.03 | forward: 69.05 | backward: 123.12 | allreduce: 9.63 | optimizer: 0.04 | bias in backward: 2.95 | dropout in backward: 3.74
 iteration       29/     100 | elapsed time per iteration (ms): 226.3 | learning rate: 1.313E-07 | lm loss: 1.056060E+01 | sop loss: 7.440099E-01 | loss scale: 131072.0 |
time (ms) | total time: 226.03 | forward: 69.28 | backward: 148.64 | allreduce: 11.82 | optimizer: 5.40 | bias in backward: 2.96 | dropout in backward: 3.76
 iteration       30/     100 | elapsed time per iteration (ms): 225.3 | learning rate: 1.414E-07 | lm loss: 1.055709E+01 | sop loss: 7.738839E-01 | loss scale: 131072.0 |
time (ms) | total time: 225.01 | forward: 68.84 | backward: 146.36 | allreduce: 9.04 | optimizer: 7.55 | bias in backward: 2.94 | dropout in backward: 3.73
 iteration       31/     100 | elapsed time per iteration (ms): 223.4 | learning rate: 1.515E-07 | lm loss: 1.056634E+01 | sop loss: 7.098626E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.18 | forward: 69.25 | backward: 146.68 | allreduce: 8.95 | optimizer: 5.31 | bias in backward: 2.95 | dropout in backward: 3.76
 iteration       32/     100 | elapsed time per iteration (ms): 224.4 | learning rate: 1.616E-07 | lm loss: 1.052156E+01 | sop loss: 7.760080E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.10 | forward: 69.08 | backward: 147.75 | allreduce: 11.27 | optimizer: 5.30 | bias in backward: 2.94 | dropout in backward: 3.75
 iteration       33/     100 | elapsed time per iteration (ms): 225.9 | learning rate: 1.717E-07 | lm loss: 1.055963E+01 | sop loss: 6.744134E-01 | loss scale: 131072.0 |
time (ms) | total time: 225.57 | forward: 70.16 | backward: 148.27 | allreduce: 8.76 | optimizer: 5.27 | bias in backward: 2.96 | dropout in backward: 3.74
 iteration       34/     100 | elapsed time per iteration (ms): 221.9 | learning rate: 1.818E-07 | lm loss: 1.062353E+01 | sop loss: 7.260045E-01 | loss scale: 131072.0 |
time (ms) | total time: 221.66 | forward: 69.16 | backward: 145.40 | allreduce: 8.77 | optimizer: 5.29 | bias in backward: 2.94 | dropout in backward: 3.74
 iteration       35/     100 | elapsed time per iteration (ms): 222.4 | learning rate: 1.919E-07 | lm loss: 1.055038E+01 | sop loss: 6.576043E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.18 | forward: 69.11 | backward: 145.95 | allreduce: 9.96 | optimizer: 5.27 | bias in backward: 2.94 | dropout in backward: 3.73
 iteration       36/     100 | elapsed time per iteration (ms): 222.7 | learning rate: 2.020E-07 | lm loss: 1.051588E+01 | sop loss: 7.677198E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.42 | forward: 69.26 | backward: 146.08 | allreduce: 10.15 | optimizer: 5.28 | bias in backward: 2.93 | dropout in backward: 3.74
 iteration       37/     100 | elapsed time per iteration (ms): 223.7 | learning rate: 2.121E-07 | lm loss: 1.050803E+01 | sop loss: 7.624511E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.43 | forward: 69.39 | backward: 146.81 | allreduce: 8.80 | optimizer: 5.28 | bias in backward: 2.93 | dropout in backward: 3.74
 iteration       38/     100 | elapsed time per iteration (ms): 222.7 | learning rate: 2.222E-07 | lm loss: 1.053975E+01 | sop loss: 6.801654E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.42 | forward: 69.44 | backward: 145.89 | allreduce: 8.73 | optimizer: 5.29 | bias in backward: 3.07 | dropout in backward: 3.86
 iteration       39/     100 | elapsed time per iteration (ms): 223.6 | learning rate: 2.323E-07 | lm loss: 1.059432E+01 | sop loss: 7.351240E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.32 | forward: 69.41 | backward: 145.27 | allreduce: 8.79 | optimizer: 6.86 | bias in backward: 2.93 | dropout in backward: 3.74
 iteration       40/     100 | elapsed time per iteration (ms): 224.9 | learning rate: 2.424E-07 | lm loss: 1.056109E+01 | sop loss: 6.891637E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.63 | forward: 69.23 | backward: 147.98 | allreduce: 9.23 | optimizer: 5.31 | bias in backward: 2.95 | dropout in backward: 3.82
 iteration       41/     100 | elapsed time per iteration (ms): 249.2 | learning rate: 2.525E-07 | lm loss: 1.059710E+01 | sop loss: 6.998418E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.88 | forward: 69.41 | backward: 168.88 | allreduce: 13.49 | optimizer: 8.18 | bias in backward: 2.96 | dropout in backward: 3.77
 iteration       42/     100 | elapsed time per iteration (ms): 227.9 | learning rate: 2.626E-07 | lm loss: 1.055355E+01 | sop loss: 6.756994E-01 | loss scale: 131072.0 |
time (ms) | total time: 227.58 | forward: 68.63 | backward: 151.15 | allreduce: 8.93 | optimizer: 5.31 | bias in backward: 2.94 | dropout in backward: 3.76
 iteration       43/     100 | elapsed time per iteration (ms): 229.4 | learning rate: 2.727E-07 | lm loss: 1.056667E+01 | sop loss: 7.308931E-01 | loss scale: 131072.0 |
time (ms) | total time: 229.14 | forward: 71.66 | backward: 150.29 | allreduce: 8.75 | optimizer: 5.28 | bias in backward: 2.93 | dropout in backward: 3.74
 iteration       44/     100 | elapsed time per iteration (ms): 229.4 | learning rate: 2.828E-07 | lm loss: 1.056088E+01 | sop loss: 6.736307E-01 | loss scale: 131072.0 |
time (ms) | total time: 229.08 | forward: 71.60 | backward: 150.36 | allreduce: 8.87 | optimizer: 5.27 | bias in backward: 2.93 | dropout in backward: 3.74
 iteration       45/     100 | elapsed time per iteration (ms): 230.5 | learning rate: 2.929E-07 | lm loss: 1.055694E+01 | sop loss: 6.857718E-01 | loss scale: 131072.0 |
time (ms) | total time: 230.20 | forward: 72.04 | backward: 150.90 | allreduce: 8.86 | optimizer: 5.28 | bias in backward: 3.13 | dropout in backward: 3.78
 iteration       46/     100 | elapsed time per iteration (ms): 230.3 | learning rate: 3.030E-07 | lm loss: 1.055787E+01 | sop loss: 6.337916E-01 | loss scale: 131072.0 |
time (ms) | total time: 230.02 | forward: 71.89 | backward: 150.85 | allreduce: 8.77 | optimizer: 5.32 | bias in backward: 2.94 | dropout in backward: 3.74
 iteration       47/     100 | elapsed time per iteration (ms): 231.4 | learning rate: 3.131E-07 | lm loss: 1.056765E+01 | sop loss: 6.589953E-01 | loss scale: 131072.0 |
time (ms) | total time: 231.08 | forward: 72.16 | backward: 151.54 | allreduce: 9.06 | optimizer: 5.31 | bias in backward: 2.95 | dropout in backward: 3.78
 iteration       48/     100 | elapsed time per iteration (ms): 238.7 | learning rate: 3.232E-07 | lm loss: 1.054975E+01 | sop loss: 7.058824E-01 | loss scale: 131072.0 |
time (ms) | total time: 238.42 | forward: 76.59 | backward: 154.14 | allreduce: 9.35 | optimizer: 5.32 | bias in backward: 2.94 | dropout in backward: 3.74
 iteration       49/     100 | elapsed time per iteration (ms): 234.3 | learning rate: 3.333E-07 | lm loss: 1.054130E+01 | sop loss: 7.351130E-01 | loss scale: 131072.0 |
time (ms) | total time: 234.03 | forward: 72.32 | backward: 154.02 | allreduce: 9.34 | optimizer: 5.33 | bias in backward: 3.02 | dropout in backward: 3.87
 iteration       50/     100 | elapsed time per iteration (ms): 234.2 | learning rate: 3.434E-07 | lm loss: 1.056107E+01 | sop loss: 6.101247E-01 | loss scale: 131072.0 |
time (ms) | total time: 233.90 | forward: 72.14 | backward: 154.19 | allreduce: 8.94 | optimizer: 5.31 | bias in backward: 3.16 | dropout in backward: 4.02
 iteration       51/     100 | elapsed time per iteration (ms): 227.5 | learning rate: 3.535E-07 | lm loss: 1.055157E+01 | sop loss: 6.752803E-01 | loss scale: 131072.0 |
time (ms) | total time: 227.25 | forward: 71.84 | backward: 147.89 | allreduce: 9.35 | optimizer: 5.36 | bias in backward: 3.13 | dropout in backward: 3.95
 iteration       52/     100 | elapsed time per iteration (ms): 225.0 | learning rate: 3.636E-07 | lm loss: 1.055339E+01 | sop loss: 7.946771E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.70 | forward: 69.00 | backward: 148.03 | allreduce: 9.26 | optimizer: 5.32 | bias in backward: 3.20 | dropout in backward: 4.01
 iteration       53/     100 | elapsed time per iteration (ms): 225.7 | learning rate: 3.737E-07 | lm loss: 1.058263E+01 | sop loss: 6.666570E-01 | loss scale: 131072.0 |
time (ms) | total time: 225.41 | forward: 69.30 | backward: 148.65 | allreduce: 8.92 | optimizer: 5.32 | bias in backward: 3.13 | dropout in backward: 3.97
 iteration       54/     100 | elapsed time per iteration (ms): 225.6 | learning rate: 3.838E-07 | lm loss: 1.058167E+01 | sop loss: 6.610695E-01 | loss scale: 131072.0 |
time (ms) | total time: 225.37 | forward: 69.02 | backward: 148.77 | allreduce: 9.25 | optimizer: 5.34 | bias in backward: 3.13 | dropout in backward: 3.94
 iteration       55/     100 | elapsed time per iteration (ms): 223.7 | learning rate: 3.939E-07 | lm loss: 1.051666E+01 | sop loss: 6.754760E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.42 | forward: 68.84 | backward: 147.29 | allreduce: 8.81 | optimizer: 5.27 | bias in backward: 3.28 | dropout in backward: 3.96
 iteration       56/     100 | elapsed time per iteration (ms): 222.7 | learning rate: 4.040E-07 | lm loss: 1.054955E+01 | sop loss: 7.966282E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.41 | forward: 69.16 | backward: 146.06 | allreduce: 8.74 | optimizer: 5.27 | bias in backward: 3.13 | dropout in backward: 3.93
 iteration       57/     100 | elapsed time per iteration (ms): 223.2 | learning rate: 4.141E-07 | lm loss: 1.056232E+01 | sop loss: 6.160869E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.88 | forward: 69.16 | backward: 146.86 | allreduce: 8.67 | optimizer: 5.25 | bias in backward: 3.14 | dropout in backward: 3.92
 iteration       58/     100 | elapsed time per iteration (ms): 221.9 | learning rate: 4.242E-07 | lm loss: 1.058285E+01 | sop loss: 7.076873E-01 | loss scale: 131072.0 |
time (ms) | total time: 221.49 | forward: 68.76 | backward: 145.78 | allreduce: 8.69 | optimizer: 5.23 | bias in backward: 3.12 | dropout in backward: 3.90
 iteration       59/     100 | elapsed time per iteration (ms): 224.5 | learning rate: 4.343E-07 | lm loss: 1.051948E+01 | sop loss: 7.473984E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.15 | forward: 69.42 | backward: 145.68 | allreduce: 9.15 | optimizer: 5.25 | bias in backward: 3.01 | dropout in backward: 3.78
 iteration       60/     100 | elapsed time per iteration (ms): 222.4 | learning rate: 4.444E-07 | lm loss: 1.053382E+01 | sop loss: 6.891918E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.13 | forward: 68.87 | backward: 145.64 | allreduce: 9.21 | optimizer: 5.24 | bias in backward: 3.04 | dropout in backward: 3.86
 iteration       61/     100 | elapsed time per iteration (ms): 224.4 | learning rate: 4.545E-07 | lm loss: 1.055559E+01 | sop loss: 6.754535E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.13 | forward: 68.89 | backward: 147.44 | allreduce: 9.15 | optimizer: 5.30 | bias in backward: 2.94 | dropout in backward: 3.73
 iteration       62/     100 | elapsed time per iteration (ms): 223.9 | learning rate: 4.646E-07 | lm loss: 1.054872E+01 | sop loss: 7.282094E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.64 | forward: 69.02 | backward: 146.61 | allreduce: 9.62 | optimizer: 5.34 | bias in backward: 2.93 | dropout in backward: 3.72
 iteration       63/     100 | elapsed time per iteration (ms): 222.9 | learning rate: 4.747E-07 | lm loss: 1.056110E+01 | sop loss: 6.454014E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.51 | forward: 68.78 | backward: 145.85 | allreduce: 9.29 | optimizer: 5.28 | bias in backward: 2.95 | dropout in backward: 3.74
 iteration       64/     100 | elapsed time per iteration (ms): 221.7 | learning rate: 4.848E-07 | lm loss: 1.052494E+01 | sop loss: 7.603385E-01 | loss scale: 131072.0 |
time (ms) | total time: 221.41 | forward: 68.80 | backward: 145.00 | allreduce: 9.13 | optimizer: 5.25 | bias in backward: 2.96 | dropout in backward: 3.73
 iteration       65/     100 | elapsed time per iteration (ms): 224.5 | learning rate: 4.949E-07 | lm loss: 1.053406E+01 | sop loss: 6.599156E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.16 | forward: 69.02 | backward: 147.48 | allreduce: 9.32 | optimizer: 5.28 | bias in backward: 2.94 | dropout in backward: 3.74
 iteration       66/     100 | elapsed time per iteration (ms): 222.4 | learning rate: 5.051E-07 | lm loss: 1.053402E+01 | sop loss: 7.601269E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.04 | forward: 68.60 | backward: 145.78 | allreduce: 9.23 | optimizer: 5.28 | bias in backward: 2.93 | dropout in backward: 3.72
 iteration       67/     100 | elapsed time per iteration (ms): 223.2 | learning rate: 5.152E-07 | lm loss: 1.052927E+01 | sop loss: 7.152651E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.98 | forward: 69.18 | backward: 146.22 | allreduce: 9.15 | optimizer: 5.25 | bias in backward: 2.93 | dropout in backward: 3.72
 iteration       68/     100 | elapsed time per iteration (ms): 222.4 | learning rate: 5.253E-07 | lm loss: 1.053182E+01 | sop loss: 6.429983E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.15 | forward: 69.07 | backward: 145.44 | allreduce: 9.15 | optimizer: 5.27 | bias in backward: 3.02 | dropout in backward: 3.79
 iteration       69/     100 | elapsed time per iteration (ms): 222.1 | learning rate: 5.354E-07 | lm loss: 1.053427E+01 | sop loss: 6.562025E-01 | loss scale: 131072.0 |
time (ms) | total time: 221.87 | forward: 68.85 | backward: 145.40 | allreduce: 9.20 | optimizer: 5.26 | bias in backward: 3.03 | dropout in backward: 3.73
 iteration       70/     100 | elapsed time per iteration (ms): 223.3 | learning rate: 5.455E-07 | lm loss: 1.051498E+01 | sop loss: 6.942722E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.06 | forward: 68.91 | backward: 146.55 | allreduce: 9.09 | optimizer: 5.26 | bias in backward: 2.92 | dropout in backward: 3.73
 iteration       71/     100 | elapsed time per iteration (ms): 223.5 | learning rate: 5.556E-07 | lm loss: 1.053674E+01 | sop loss: 7.644710E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.10 | forward: 68.97 | backward: 146.04 | allreduce: 9.43 | optimizer: 5.51 | bias in backward: 2.94 | dropout in backward: 3.73
 iteration       72/     100 | elapsed time per iteration (ms): 224.9 | learning rate: 5.657E-07 | lm loss: 1.053527E+01 | sop loss: 6.581548E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.61 | forward: 69.48 | backward: 145.75 | allreduce: 9.36 | optimizer: 5.36 | bias in backward: 2.95 | dropout in backward: 3.73
 iteration       73/     100 | elapsed time per iteration (ms): 223.6 | learning rate: 5.758E-07 | lm loss: 1.050868E+01 | sop loss: 6.973117E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.27 | forward: 69.05 | backward: 146.16 | allreduce: 9.50 | optimizer: 5.32 | bias in backward: 2.97 | dropout in backward: 3.78
 iteration       74/     100 | elapsed time per iteration (ms): 226.1 | learning rate: 5.859E-07 | lm loss: 1.051050E+01 | sop loss: 6.483623E-01 | loss scale: 131072.0 |
time (ms) | total time: 225.76 | forward: 69.02 | backward: 148.73 | allreduce: 9.55 | optimizer: 5.32 | bias in backward: 2.95 | dropout in backward: 3.78
 iteration       75/     100 | elapsed time per iteration (ms): 223.1 | learning rate: 5.960E-07 | lm loss: 1.053983E+01 | sop loss: 7.305759E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.76 | forward: 68.71 | backward: 146.18 | allreduce: 9.53 | optimizer: 5.31 | bias in backward: 2.96 | dropout in backward: 3.73
 iteration       76/     100 | elapsed time per iteration (ms): 225.8 | learning rate: 6.061E-07 | lm loss: 1.052882E+01 | sop loss: 7.517352E-01 | loss scale: 131072.0 |
time (ms) | total time: 225.54 | forward: 68.98 | backward: 148.85 | allreduce: 9.63 | optimizer: 5.35 | bias in backward: 2.93 | dropout in backward: 3.71
 iteration       77/     100 | elapsed time per iteration (ms): 223.6 | learning rate: 6.162E-07 | lm loss: 1.052049E+01 | sop loss: 7.724096E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.28 | forward: 69.08 | backward: 146.15 | allreduce: 9.71 | optimizer: 5.34 | bias in backward: 2.94 | dropout in backward: 3.72
 iteration       78/     100 | elapsed time per iteration (ms): 224.6 | learning rate: 6.263E-07 | lm loss: 1.047991E+01 | sop loss: 6.937909E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.36 | forward: 69.34 | backward: 145.53 | allreduce: 9.26 | optimizer: 7.07 | bias in backward: 2.97 | dropout in backward: 3.73
 iteration       79/     100 | elapsed time per iteration (ms): 222.6 | learning rate: 6.364E-07 | lm loss: 1.052176E+01 | sop loss: 7.275103E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.26 | forward: 69.19 | backward: 145.12 | allreduce: 9.38 | optimizer: 5.32 | bias in backward: 2.94 | dropout in backward: 3.74
 iteration       80/     100 | elapsed time per iteration (ms): 223.0 | learning rate: 6.465E-07 | lm loss: 1.053014E+01 | sop loss: 6.654598E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.61 | forward: 69.17 | backward: 145.24 | allreduce: 8.90 | optimizer: 5.33 | bias in backward: 2.94 | dropout in backward: 3.72
 iteration       81/     100 | elapsed time per iteration (ms): 222.1 | learning rate: 6.566E-07 | lm loss: 1.049480E+01 | sop loss: 7.580940E-01 | loss scale: 131072.0 |
time (ms) | total time: 221.74 | forward: 69.29 | backward: 144.59 | allreduce: 8.87 | optimizer: 5.36 | bias in backward: 2.94 | dropout in backward: 3.72
 iteration       82/     100 | elapsed time per iteration (ms): 222.4 | learning rate: 6.667E-07 | lm loss: 1.050476E+01 | sop loss: 7.202474E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.09 | forward: 68.86 | backward: 144.98 | allreduce: 9.26 | optimizer: 5.30 | bias in backward: 3.05 | dropout in backward: 3.78
 iteration       83/     100 | elapsed time per iteration (ms): 223.0 | learning rate: 6.768E-07 | lm loss: 1.053036E+01 | sop loss: 7.150271E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.72 | forward: 69.20 | backward: 145.32 | allreduce: 9.69 | optimizer: 5.32 | bias in backward: 2.95 | dropout in backward: 3.73
 iteration       84/     100 | elapsed time per iteration (ms): 224.6 | learning rate: 6.869E-07 | lm loss: 1.048219E+01 | sop loss: 8.061026E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.31 | forward: 69.15 | backward: 146.84 | allreduce: 9.31 | optimizer: 5.28 | bias in backward: 2.95 | dropout in backward: 3.74
 iteration       85/     100 | elapsed time per iteration (ms): 223.1 | learning rate: 6.970E-07 | lm loss: 1.053527E+01 | sop loss: 7.411150E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.76 | forward: 69.10 | backward: 145.25 | allreduce: 9.52 | optimizer: 5.34 | bias in backward: 2.95 | dropout in backward: 3.75
 iteration       86/     100 | elapsed time per iteration (ms): 225.0 | learning rate: 7.071E-07 | lm loss: 1.051868E+01 | sop loss: 7.169719E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.72 | forward: 69.52 | backward: 146.57 | allreduce: 9.67 | optimizer: 5.37 | bias in backward: 3.04 | dropout in backward: 3.84
 iteration       87/     100 | elapsed time per iteration (ms): 224.2 | learning rate: 7.172E-07 | lm loss: 1.052455E+01 | sop loss: 7.594995E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.83 | forward: 69.31 | backward: 145.91 | allreduce: 9.72 | optimizer: 5.33 | bias in backward: 2.97 | dropout in backward: 3.76
 iteration       88/     100 | elapsed time per iteration (ms): 225.2 | learning rate: 7.273E-07 | lm loss: 1.049143E+01 | sop loss: 6.201419E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.89 | forward: 69.45 | backward: 147.25 | allreduce: 9.60 | optimizer: 5.35 | bias in backward: 2.98 | dropout in backward: 3.76
 iteration       89/     100 | elapsed time per iteration (ms): 222.3 | learning rate: 7.374E-07 | lm loss: 1.048264E+01 | sop loss: 7.465541E-01 | loss scale: 131072.0 |
time (ms) | total time: 221.94 | forward: 69.12 | backward: 144.58 | allreduce: 9.26 | optimizer: 5.31 | bias in backward: 2.95 | dropout in backward: 3.74
 iteration       90/     100 | elapsed time per iteration (ms): 224.2 | learning rate: 7.475E-07 | lm loss: 1.055691E+01 | sop loss: 7.959743E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.87 | forward: 69.44 | backward: 145.48 | allreduce: 9.33 | optimizer: 5.30 | bias in backward: 2.95 | dropout in backward: 3.75
 iteration       91/     100 | elapsed time per iteration (ms): 223.4 | learning rate: 7.576E-07 | lm loss: 1.050796E+01 | sop loss: 6.202954E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.08 | forward: 68.95 | backward: 145.92 | allreduce: 9.24 | optimizer: 5.30 | bias in backward: 2.94 | dropout in backward: 3.74
 iteration       92/     100 | elapsed time per iteration (ms): 224.1 | learning rate: 7.677E-07 | lm loss: 1.048473E+01 | sop loss: 7.346945E-01 | loss scale: 131072.0 |
time (ms) | total time: 223.76 | forward: 69.09 | backward: 146.48 | allreduce: 9.27 | optimizer: 5.29 | bias in backward: 2.94 | dropout in backward: 3.74
 iteration       93/     100 | elapsed time per iteration (ms): 225.1 | learning rate: 7.778E-07 | lm loss: 1.048355E+01 | sop loss: 6.873462E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.74 | forward: 69.16 | backward: 147.14 | allreduce: 9.23 | optimizer: 5.41 | bias in backward: 2.94 | dropout in backward: 3.74
 iteration       94/     100 | elapsed time per iteration (ms): 226.0 | learning rate: 7.879E-07 | lm loss: 1.052801E+01 | sop loss: 6.432381E-01 | loss scale: 131072.0 |
time (ms) | total time: 225.61 | forward: 70.73 | backward: 146.20 | allreduce: 9.82 | optimizer: 5.31 | bias in backward: 2.99 | dropout in backward: 3.85
 iteration       95/     100 | elapsed time per iteration (ms): 223.1 | learning rate: 7.980E-07 | lm loss: 1.050167E+01 | sop loss: 7.178571E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.73 | forward: 68.99 | backward: 145.20 | allreduce: 9.34 | optimizer: 5.52 | bias in backward: 3.00 | dropout in backward: 3.76
 iteration       96/     100 | elapsed time per iteration (ms): 251.9 | learning rate: 8.081E-07 | lm loss: 1.047834E+01 | sop loss: 8.096133E-01 | loss scale: 131072.0 |
time (ms) | total time: 251.50 | forward: 69.69 | backward: 173.41 | allreduce: 37.47 | optimizer: 5.33 | bias in backward: 2.95 | dropout in backward: 3.74
 iteration       97/     100 | elapsed time per iteration (ms): 222.7 | learning rate: 8.182E-07 | lm loss: 1.050402E+01 | sop loss: 6.662771E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.42 | forward: 69.31 | backward: 145.19 | allreduce: 9.40 | optimizer: 5.30 | bias in backward: 2.94 | dropout in backward: 3.76
 iteration       98/     100 | elapsed time per iteration (ms): 224.7 | learning rate: 8.283E-07 | lm loss: 1.055812E+01 | sop loss: 6.839815E-01 | loss scale: 131072.0 |
time (ms) | total time: 224.39 | forward: 69.44 | backward: 146.80 | allreduce: 9.24 | optimizer: 5.28 | bias in backward: 2.99 | dropout in backward: 3.83
 iteration       99/     100 | elapsed time per iteration (ms): 248.8 | learning rate: 8.384E-07 | lm loss: 1.054661E+01 | sop loss: 7.840194E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.46 | forward: 69.71 | backward: 170.36 | allreduce: 9.95 | optimizer: 5.37 | bias in backward: 2.98 | dropout in backward: 3.81
 iteration      100/     100 | elapsed time per iteration (ms): 222.7 | learning rate: 8.485E-07 | lm loss: 1.045829E+01 | sop loss: 9.083857E-01 | loss scale: 131072.0 |
time (ms) | total time: 222.41 | forward: 69.34 | backward: 144.68 | allreduce: 9.38 | optimizer: 5.32 | bias in backward: 2.97 | dropout in backward: 3.81
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

32

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.120181 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_3200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.007 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_3200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_3200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3576.72 | train/valid/test data iterators: 2646.51
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 3858.9 | learning rate: 0.000E+00 | lm loss: 1.052496E+01 | sop loss: 7.895086E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 714.59228515625 | max allocated: 12786.98193359375 | cached: 12936.0 | max cached: 12936.0
time (ms) | total time: 3858.69 | forward: 2622.18 | backward: 471.82 | allreduce: 9.21 | optimizer: 0.04 | bias in backward: 14.57 | dropout in backward: 6.51
 iteration        2/     100 | elapsed time per iteration (ms): 306.1 | learning rate: 0.000E+00 | lm loss: 1.056470E+01 | sop loss: 7.585816E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 304.38 | forward: 121.01 | backward: 180.58 | allreduce: 9.53 | optimizer: 0.05 | bias in backward: 4.02 | dropout in backward: 6.50
 iteration        3/     100 | elapsed time per iteration (ms): 310.4 | learning rate: 0.000E+00 | lm loss: 1.055410E+01 | sop loss: 6.599137E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 310.03 | forward: 121.57 | backward: 184.47 | allreduce: 12.21 | optimizer: 0.04 | bias in backward: 4.05 | dropout in backward: 6.51
 iteration        4/     100 | elapsed time per iteration (ms): 307.1 | learning rate: 0.000E+00 | lm loss: 1.057933E+01 | sop loss: 7.291617E-01 | loss scale: 536870912.0 |
time (ms) | total time: 306.76 | forward: 120.86 | backward: 182.66 | allreduce: 11.73 | optimizer: 0.03 | bias in backward: 4.03 | dropout in backward: 6.48
 iteration        5/     100 | elapsed time per iteration (ms): 307.6 | learning rate: 0.000E+00 | lm loss: 1.056120E+01 | sop loss: 6.709089E-01 | loss scale: 268435456.0 |
time (ms) | total time: 307.33 | forward: 120.76 | backward: 183.49 | allreduce: 11.72 | optimizer: 0.03 | bias in backward: 4.03 | dropout in backward: 6.48
 iteration        6/     100 | elapsed time per iteration (ms): 311.1 | learning rate: 0.000E+00 | lm loss: 1.054907E+01 | sop loss: 7.074516E-01 | loss scale: 134217728.0 |
time (ms) | total time: 310.75 | forward: 121.03 | backward: 186.42 | allreduce: 9.42 | optimizer: 0.04 | bias in backward: 4.05 | dropout in backward: 6.49
 iteration        7/     100 | elapsed time per iteration (ms): 309.9 | learning rate: 0.000E+00 | lm loss: 1.054449E+01 | sop loss: 7.264688E-01 | loss scale: 67108864.0 |
time (ms) | total time: 309.62 | forward: 121.65 | backward: 184.30 | allreduce: 11.92 | optimizer: 0.04 | bias in backward: 4.23 | dropout in backward: 6.53
 iteration        8/     100 | elapsed time per iteration (ms): 304.3 | learning rate: 0.000E+00 | lm loss: 1.054208E+01 | sop loss: 6.891274E-01 | loss scale: 33554432.0 |
time (ms) | total time: 303.97 | forward: 120.26 | backward: 180.73 | allreduce: 8.89 | optimizer: 0.04 | bias in backward: 4.02 | dropout in backward: 6.46
 iteration        9/     100 | elapsed time per iteration (ms): 308.5 | learning rate: 0.000E+00 | lm loss: 1.055470E+01 | sop loss: 7.691417E-01 | loss scale: 16777216.0 |
time (ms) | total time: 308.23 | forward: 120.96 | backward: 183.83 | allreduce: 11.95 | optimizer: 0.03 | bias in backward: 4.11 | dropout in backward: 6.46
 iteration       10/     100 | elapsed time per iteration (ms): 303.5 | learning rate: 0.000E+00 | lm loss: 1.053739E+01 | sop loss: 7.119513E-01 | loss scale: 8388608.0 |
time (ms) | total time: 303.20 | forward: 120.24 | backward: 179.99 | allreduce: 9.10 | optimizer: 0.03 | bias in backward: 4.05 | dropout in backward: 6.50
 iteration       11/     100 | elapsed time per iteration (ms): 307.8 | learning rate: 0.000E+00 | lm loss: 1.055586E+01 | sop loss: 6.480634E-01 | loss scale: 4194304.0 |
time (ms) | total time: 307.53 | forward: 120.65 | backward: 183.31 | allreduce: 11.90 | optimizer: 0.04 | bias in backward: 4.10 | dropout in backward: 6.58
 iteration       12/     100 | elapsed time per iteration (ms): 307.1 | learning rate: 0.000E+00 | lm loss: 1.058751E+01 | sop loss: 6.769663E-01 | loss scale: 2097152.0 |
time (ms) | total time: 306.82 | forward: 120.51 | backward: 183.51 | allreduce: 8.97 | optimizer: 0.03 | bias in backward: 4.08 | dropout in backward: 6.46
 iteration       13/     100 | elapsed time per iteration (ms): 311.4 | learning rate: 0.000E+00 | lm loss: 1.056651E+01 | sop loss: 6.774616E-01 | loss scale: 1048576.0 |
time (ms) | total time: 311.11 | forward: 121.18 | backward: 186.50 | allreduce: 11.78 | optimizer: 0.04 | bias in backward: 4.06 | dropout in backward: 6.51
 iteration       14/     100 | elapsed time per iteration (ms): 309.6 | learning rate: 0.000E+00 | lm loss: 1.057418E+01 | sop loss: 7.286303E-01 | loss scale: 524288.0 |
time (ms) | total time: 309.29 | forward: 120.66 | backward: 185.47 | allreduce: 9.16 | optimizer: 0.03 | bias in backward: 4.04 | dropout in backward: 6.48
 iteration       15/     100 | elapsed time per iteration (ms): 314.7 | learning rate: 0.000E+00 | lm loss: 1.057804E+01 | sop loss: 7.289388E-01 | loss scale: 262144.0 |
time (ms) | total time: 314.43 | forward: 120.59 | backward: 190.39 | allreduce: 11.60 | optimizer: 0.03 | bias in backward: 4.02 | dropout in backward: 6.46
 iteration       16/     100 | elapsed time per iteration (ms): 527.6 | learning rate: 1.010E-08 | lm loss: 1.052079E+01 | sop loss: 7.380056E-01 | loss scale: 262144.0 |
time (ms) | total time: 527.21 | forward: 120.55 | backward: 275.66 | allreduce: 11.72 | optimizer: 128.08 | bias in backward: 4.04 | dropout in backward: 6.48
 iteration       17/     100 | elapsed time per iteration (ms): 363.5 | learning rate: 2.020E-08 | lm loss: 1.057735E+01 | sop loss: 7.378307E-01 | loss scale: 262144.0 |
time (ms) | total time: 363.14 | forward: 120.48 | backward: 232.67 | allreduce: 12.50 | optimizer: 6.75 | bias in backward: 4.00 | dropout in backward: 6.48
 iteration       18/     100 | elapsed time per iteration (ms): 360.2 | learning rate: 3.030E-08 | lm loss: 1.056367E+01 | sop loss: 7.676601E-01 | loss scale: 262144.0 |
time (ms) | total time: 359.90 | forward: 120.52 | backward: 229.63 | allreduce: 11.72 | optimizer: 6.66 | bias in backward: 4.02 | dropout in backward: 6.51
 iteration       19/     100 | elapsed time per iteration (ms): 361.1 | learning rate: 4.040E-08 | lm loss: 1.059267E+01 | sop loss: 7.459402E-01 | loss scale: 262144.0 |
time (ms) | total time: 360.77 | forward: 120.37 | backward: 230.35 | allreduce: 11.98 | optimizer: 6.75 | bias in backward: 4.00 | dropout in backward: 6.48
 iteration       20/     100 | elapsed time per iteration (ms): 360.2 | learning rate: 5.051E-08 | lm loss: 1.059865E+01 | sop loss: 7.429708E-01 | loss scale: 262144.0 |
time (ms) | total time: 359.89 | forward: 120.41 | backward: 229.75 | allreduce: 11.61 | optimizer: 6.65 | bias in backward: 4.02 | dropout in backward: 6.46
 iteration       21/     100 | elapsed time per iteration (ms): 360.0 | learning rate: 6.061E-08 | lm loss: 1.057320E+01 | sop loss: 7.067660E-01 | loss scale: 262144.0 |
time (ms) | total time: 359.70 | forward: 120.61 | backward: 229.60 | allreduce: 11.73 | optimizer: 6.63 | bias in backward: 4.01 | dropout in backward: 6.46
 iteration       22/     100 | elapsed time per iteration (ms): 360.3 | learning rate: 7.071E-08 | lm loss: 1.054604E+01 | sop loss: 6.716889E-01 | loss scale: 262144.0 |
time (ms) | total time: 360.03 | forward: 120.74 | backward: 229.79 | allreduce: 11.82 | optimizer: 6.60 | bias in backward: 4.03 | dropout in backward: 6.46
 iteration       23/     100 | elapsed time per iteration (ms): 362.8 | learning rate: 8.081E-08 | lm loss: 1.054403E+01 | sop loss: 7.031325E-01 | loss scale: 262144.0 |
time (ms) | total time: 362.39 | forward: 120.83 | backward: 231.82 | allreduce: 12.32 | optimizer: 6.69 | bias in backward: 4.13 | dropout in backward: 6.52
 iteration       24/     100 | elapsed time per iteration (ms): 361.4 | learning rate: 9.091E-08 | lm loss: 1.056102E+01 | sop loss: 6.695878E-01 | loss scale: 262144.0 |
time (ms) | total time: 360.99 | forward: 120.69 | backward: 230.60 | allreduce: 11.92 | optimizer: 6.71 | bias in backward: 4.03 | dropout in backward: 6.51
 iteration       25/     100 | elapsed time per iteration (ms): 350.3 | learning rate: 1.010E-07 | lm loss: 1.056066E+01 | sop loss: 6.806292E-01 | loss scale: 262144.0 |
time (ms) | total time: 349.89 | forward: 120.39 | backward: 221.10 | allreduce: 9.64 | optimizer: 5.44 | bias in backward: 4.07 | dropout in backward: 6.48
 iteration       26/     100 | elapsed time per iteration (ms): 352.2 | learning rate: 1.111E-07 | lm loss: 1.057303E+01 | sop loss: 7.392305E-01 | loss scale: 262144.0 |
time (ms) | total time: 351.78 | forward: 119.99 | backward: 223.48 | allreduce: 9.99 | optimizer: 5.46 | bias in backward: 4.00 | dropout in backward: 6.47
 iteration       27/     100 | elapsed time per iteration (ms): 348.1 | learning rate: 1.212E-07 | lm loss: 1.057421E+01 | sop loss: 7.233742E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.76 | forward: 120.26 | backward: 219.40 | allreduce: 9.60 | optimizer: 5.35 | bias in backward: 4.02 | dropout in backward: 6.49
 iteration       28/     100 | elapsed time per iteration (ms): 351.1 | learning rate: 1.313E-07 | lm loss: 1.057216E+01 | sop loss: 7.291561E-01 | loss scale: 262144.0 |
time (ms) | total time: 350.75 | forward: 119.94 | backward: 222.72 | allreduce: 9.51 | optimizer: 5.36 | bias in backward: 4.02 | dropout in backward: 6.46
 iteration       29/     100 | elapsed time per iteration (ms): 350.0 | learning rate: 1.414E-07 | lm loss: 1.055996E+01 | sop loss: 7.000950E-01 | loss scale: 262144.0 |
time (ms) | total time: 349.75 | forward: 119.99 | backward: 221.73 | allreduce: 9.90 | optimizer: 5.37 | bias in backward: 4.04 | dropout in backward: 6.47
 iteration       30/     100 | elapsed time per iteration (ms): 349.6 | learning rate: 1.515E-07 | lm loss: 1.056552E+01 | sop loss: 7.029519E-01 | loss scale: 262144.0 |
time (ms) | total time: 349.27 | forward: 120.07 | backward: 220.98 | allreduce: 9.83 | optimizer: 5.35 | bias in backward: 4.01 | dropout in backward: 6.45
 iteration       31/     100 | elapsed time per iteration (ms): 349.8 | learning rate: 1.616E-07 | lm loss: 1.055808E+01 | sop loss: 7.182021E-01 | loss scale: 262144.0 |
time (ms) | total time: 349.51 | forward: 120.35 | backward: 220.46 | allreduce: 9.84 | optimizer: 5.55 | bias in backward: 4.00 | dropout in backward: 6.46
 iteration       32/     100 | elapsed time per iteration (ms): 347.9 | learning rate: 1.717E-07 | lm loss: 1.057802E+01 | sop loss: 7.645444E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.58 | forward: 120.34 | backward: 219.30 | allreduce: 9.54 | optimizer: 5.33 | bias in backward: 4.05 | dropout in backward: 6.48
 iteration       33/     100 | elapsed time per iteration (ms): 351.4 | learning rate: 1.818E-07 | lm loss: 1.057295E+01 | sop loss: 7.814891E-01 | loss scale: 262144.0 |
time (ms) | total time: 351.04 | forward: 120.32 | backward: 222.36 | allreduce: 9.79 | optimizer: 5.41 | bias in backward: 4.06 | dropout in backward: 6.47
 iteration       34/     100 | elapsed time per iteration (ms): 348.8 | learning rate: 1.919E-07 | lm loss: 1.057562E+01 | sop loss: 6.607356E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.56 | forward: 120.05 | backward: 220.53 | allreduce: 9.83 | optimizer: 5.40 | bias in backward: 4.02 | dropout in backward: 6.46
 iteration       35/     100 | elapsed time per iteration (ms): 350.5 | learning rate: 2.020E-07 | lm loss: 1.056058E+01 | sop loss: 7.667484E-01 | loss scale: 262144.0 |
time (ms) | total time: 350.12 | forward: 120.21 | backward: 221.30 | allreduce: 10.01 | optimizer: 5.43 | bias in backward: 4.01 | dropout in backward: 6.45
 iteration       36/     100 | elapsed time per iteration (ms): 349.5 | learning rate: 2.121E-07 | lm loss: 1.055198E+01 | sop loss: 6.858301E-01 | loss scale: 262144.0 |
time (ms) | total time: 349.23 | forward: 120.05 | backward: 221.19 | allreduce: 9.81 | optimizer: 5.40 | bias in backward: 4.05 | dropout in backward: 6.46
 iteration       37/     100 | elapsed time per iteration (ms): 346.5 | learning rate: 2.222E-07 | lm loss: 1.055310E+01 | sop loss: 6.637700E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.20 | forward: 119.65 | backward: 218.53 | allreduce: 9.28 | optimizer: 5.32 | bias in backward: 4.03 | dropout in backward: 6.46
 iteration       38/     100 | elapsed time per iteration (ms): 350.1 | learning rate: 2.323E-07 | lm loss: 1.057960E+01 | sop loss: 6.951289E-01 | loss scale: 262144.0 |
time (ms) | total time: 349.83 | forward: 120.51 | backward: 221.40 | allreduce: 9.42 | optimizer: 5.33 | bias in backward: 4.07 | dropout in backward: 6.49
 iteration       39/     100 | elapsed time per iteration (ms): 348.6 | learning rate: 2.424E-07 | lm loss: 1.054150E+01 | sop loss: 7.161227E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.30 | forward: 120.32 | backward: 220.05 | allreduce: 9.04 | optimizer: 5.36 | bias in backward: 4.03 | dropout in backward: 6.53
 iteration       40/     100 | elapsed time per iteration (ms): 348.3 | learning rate: 2.525E-07 | lm loss: 1.055315E+01 | sop loss: 6.863385E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.95 | forward: 120.26 | backward: 220.13 | allreduce: 9.01 | optimizer: 5.36 | bias in backward: 4.07 | dropout in backward: 6.49
 iteration       41/     100 | elapsed time per iteration (ms): 347.5 | learning rate: 2.626E-07 | lm loss: 1.055444E+01 | sop loss: 8.326536E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.22 | forward: 120.02 | backward: 219.86 | allreduce: 9.00 | optimizer: 5.33 | bias in backward: 4.02 | dropout in backward: 6.48
 iteration       42/     100 | elapsed time per iteration (ms): 347.8 | learning rate: 2.727E-07 | lm loss: 1.056472E+01 | sop loss: 6.855279E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.50 | forward: 120.46 | backward: 219.60 | allreduce: 8.97 | optimizer: 5.34 | bias in backward: 4.04 | dropout in backward: 6.48
 iteration       43/     100 | elapsed time per iteration (ms): 347.4 | learning rate: 2.828E-07 | lm loss: 1.054422E+01 | sop loss: 8.040202E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.17 | forward: 120.00 | backward: 220.13 | allreduce: 9.15 | optimizer: 5.28 | bias in backward: 4.08 | dropout in backward: 6.50
 iteration       44/     100 | elapsed time per iteration (ms): 347.5 | learning rate: 2.929E-07 | lm loss: 1.053012E+01 | sop loss: 7.244595E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.23 | forward: 120.01 | backward: 219.90 | allreduce: 8.93 | optimizer: 5.29 | bias in backward: 4.00 | dropout in backward: 6.45
 iteration       45/     100 | elapsed time per iteration (ms): 348.6 | learning rate: 3.030E-07 | lm loss: 1.056468E+01 | sop loss: 6.421971E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.29 | forward: 119.90 | backward: 220.60 | allreduce: 9.46 | optimizer: 5.45 | bias in backward: 4.01 | dropout in backward: 6.49
 iteration       46/     100 | elapsed time per iteration (ms): 351.8 | learning rate: 3.131E-07 | lm loss: 1.052373E+01 | sop loss: 7.137316E-01 | loss scale: 262144.0 |
time (ms) | total time: 351.54 | forward: 120.64 | backward: 222.66 | allreduce: 9.81 | optimizer: 5.46 | bias in backward: 4.01 | dropout in backward: 6.51
 iteration       47/     100 | elapsed time per iteration (ms): 347.7 | learning rate: 3.232E-07 | lm loss: 1.056434E+01 | sop loss: 6.687474E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.41 | forward: 120.06 | backward: 219.97 | allreduce: 9.10 | optimizer: 5.33 | bias in backward: 4.01 | dropout in backward: 6.46
 iteration       48/     100 | elapsed time per iteration (ms): 347.1 | learning rate: 3.333E-07 | lm loss: 1.052443E+01 | sop loss: 7.540233E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.81 | forward: 120.13 | backward: 219.21 | allreduce: 9.03 | optimizer: 5.34 | bias in backward: 4.00 | dropout in backward: 6.49
 iteration       49/     100 | elapsed time per iteration (ms): 346.4 | learning rate: 3.434E-07 | lm loss: 1.053838E+01 | sop loss: 7.168099E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.10 | forward: 120.31 | backward: 218.43 | allreduce: 8.91 | optimizer: 5.29 | bias in backward: 4.01 | dropout in backward: 6.47
 iteration       50/     100 | elapsed time per iteration (ms): 348.7 | learning rate: 3.535E-07 | lm loss: 1.053114E+01 | sop loss: 7.460418E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.46 | forward: 120.22 | backward: 221.02 | allreduce: 8.98 | optimizer: 5.31 | bias in backward: 4.07 | dropout in backward: 6.54
 iteration       51/     100 | elapsed time per iteration (ms): 347.9 | learning rate: 3.636E-07 | lm loss: 1.055859E+01 | sop loss: 7.611834E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.63 | forward: 120.41 | backward: 219.74 | allreduce: 9.21 | optimizer: 5.38 | bias in backward: 4.03 | dropout in backward: 6.50
 iteration       52/     100 | elapsed time per iteration (ms): 347.2 | learning rate: 3.737E-07 | lm loss: 1.055833E+01 | sop loss: 7.767075E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.87 | forward: 120.21 | backward: 219.20 | allreduce: 8.89 | optimizer: 5.35 | bias in backward: 4.06 | dropout in backward: 6.49
 iteration       53/     100 | elapsed time per iteration (ms): 347.5 | learning rate: 3.838E-07 | lm loss: 1.055290E+01 | sop loss: 7.611313E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.23 | forward: 119.75 | backward: 220.22 | allreduce: 8.91 | optimizer: 5.33 | bias in backward: 4.02 | dropout in backward: 6.47
 iteration       54/     100 | elapsed time per iteration (ms): 347.3 | learning rate: 3.939E-07 | lm loss: 1.055764E+01 | sop loss: 7.533973E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.07 | forward: 119.93 | backward: 219.90 | allreduce: 8.89 | optimizer: 5.30 | bias in backward: 4.01 | dropout in backward: 6.48
 iteration       55/     100 | elapsed time per iteration (ms): 350.4 | learning rate: 4.040E-07 | lm loss: 1.055095E+01 | sop loss: 6.427735E-01 | loss scale: 262144.0 |
time (ms) | total time: 350.08 | forward: 120.94 | backward: 221.51 | allreduce: 9.63 | optimizer: 5.34 | bias in backward: 4.02 | dropout in backward: 6.50
 iteration       56/     100 | elapsed time per iteration (ms): 349.3 | learning rate: 4.141E-07 | lm loss: 1.053143E+01 | sop loss: 7.241699E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.99 | forward: 120.32 | backward: 220.56 | allreduce: 9.63 | optimizer: 5.40 | bias in backward: 4.11 | dropout in backward: 6.51
 iteration       57/     100 | elapsed time per iteration (ms): 347.4 | learning rate: 4.242E-07 | lm loss: 1.052476E+01 | sop loss: 7.566328E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.15 | forward: 120.03 | backward: 219.74 | allreduce: 8.87 | optimizer: 5.31 | bias in backward: 4.02 | dropout in backward: 6.51
 iteration       58/     100 | elapsed time per iteration (ms): 347.0 | learning rate: 4.343E-07 | lm loss: 1.050922E+01 | sop loss: 7.066036E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.66 | forward: 120.20 | backward: 219.14 | allreduce: 8.89 | optimizer: 5.31 | bias in backward: 4.04 | dropout in backward: 6.50
 iteration       59/     100 | elapsed time per iteration (ms): 346.3 | learning rate: 4.444E-07 | lm loss: 1.055312E+01 | sop loss: 7.068707E-01 | loss scale: 262144.0 |
time (ms) | total time: 345.98 | forward: 120.04 | backward: 218.71 | allreduce: 8.91 | optimizer: 5.28 | bias in backward: 4.02 | dropout in backward: 6.50
 iteration       60/     100 | elapsed time per iteration (ms): 347.7 | learning rate: 4.545E-07 | lm loss: 1.052368E+01 | sop loss: 8.100723E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.43 | forward: 119.88 | backward: 219.90 | allreduce: 9.61 | optimizer: 5.36 | bias in backward: 4.06 | dropout in backward: 6.57
 iteration       61/     100 | elapsed time per iteration (ms): 349.2 | learning rate: 4.646E-07 | lm loss: 1.054244E+01 | sop loss: 7.895950E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.88 | forward: 120.34 | backward: 220.55 | allreduce: 9.38 | optimizer: 5.38 | bias in backward: 4.02 | dropout in backward: 6.51
 iteration       62/     100 | elapsed time per iteration (ms): 348.1 | learning rate: 4.747E-07 | lm loss: 1.053397E+01 | sop loss: 7.522964E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.81 | forward: 119.89 | backward: 220.01 | allreduce: 9.70 | optimizer: 5.37 | bias in backward: 4.04 | dropout in backward: 6.53
 iteration       63/     100 | elapsed time per iteration (ms): 346.9 | learning rate: 4.848E-07 | lm loss: 1.055140E+01 | sop loss: 7.460193E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.61 | forward: 120.22 | backward: 218.81 | allreduce: 8.87 | optimizer: 5.30 | bias in backward: 4.01 | dropout in backward: 6.49
 iteration       64/     100 | elapsed time per iteration (ms): 347.8 | learning rate: 4.949E-07 | lm loss: 1.052394E+01 | sop loss: 7.717493E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.55 | forward: 119.81 | backward: 220.54 | allreduce: 8.92 | optimizer: 5.30 | bias in backward: 4.04 | dropout in backward: 6.50
 iteration       65/     100 | elapsed time per iteration (ms): 346.6 | learning rate: 5.051E-07 | lm loss: 1.054140E+01 | sop loss: 7.464085E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.32 | forward: 120.20 | backward: 218.87 | allreduce: 8.85 | optimizer: 5.27 | bias in backward: 4.03 | dropout in backward: 6.48
 iteration       66/     100 | elapsed time per iteration (ms): 345.7 | learning rate: 5.152E-07 | lm loss: 1.050531E+01 | sop loss: 6.999043E-01 | loss scale: 262144.0 |
time (ms) | total time: 345.44 | forward: 120.50 | backward: 217.72 | allreduce: 8.74 | optimizer: 5.28 | bias in backward: 3.99 | dropout in backward: 6.47
 iteration       67/     100 | elapsed time per iteration (ms): 347.4 | learning rate: 5.253E-07 | lm loss: 1.053734E+01 | sop loss: 6.958969E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.09 | forward: 120.35 | backward: 219.20 | allreduce: 9.33 | optimizer: 5.34 | bias in backward: 4.02 | dropout in backward: 6.50
 iteration       68/     100 | elapsed time per iteration (ms): 352.0 | learning rate: 5.354E-07 | lm loss: 1.052090E+01 | sop loss: 7.220468E-01 | loss scale: 262144.0 |
time (ms) | total time: 351.69 | forward: 120.06 | backward: 223.16 | allreduce: 8.87 | optimizer: 5.54 | bias in backward: 4.10 | dropout in backward: 6.50
 iteration       69/     100 | elapsed time per iteration (ms): 350.7 | learning rate: 5.455E-07 | lm loss: 1.053739E+01 | sop loss: 7.227057E-01 | loss scale: 262144.0 |
time (ms) | total time: 350.41 | forward: 120.39 | backward: 221.64 | allreduce: 9.54 | optimizer: 5.35 | bias in backward: 4.10 | dropout in backward: 6.50
 iteration       70/     100 | elapsed time per iteration (ms): 350.5 | learning rate: 5.556E-07 | lm loss: 1.051468E+01 | sop loss: 8.112108E-01 | loss scale: 262144.0 |
time (ms) | total time: 350.17 | forward: 120.08 | backward: 221.85 | allreduce: 9.76 | optimizer: 5.37 | bias in backward: 4.03 | dropout in backward: 6.50
 iteration       71/     100 | elapsed time per iteration (ms): 348.6 | learning rate: 5.657E-07 | lm loss: 1.053547E+01 | sop loss: 6.744284E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.25 | forward: 120.22 | backward: 219.57 | allreduce: 9.73 | optimizer: 5.34 | bias in backward: 4.03 | dropout in backward: 6.51
 iteration       72/     100 | elapsed time per iteration (ms): 348.9 | learning rate: 5.758E-07 | lm loss: 1.053097E+01 | sop loss: 7.265959E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.63 | forward: 120.23 | backward: 220.10 | allreduce: 9.80 | optimizer: 5.37 | bias in backward: 4.05 | dropout in backward: 6.51
 iteration       73/     100 | elapsed time per iteration (ms): 351.5 | learning rate: 5.859E-07 | lm loss: 1.054848E+01 | sop loss: 6.881011E-01 | loss scale: 262144.0 |
time (ms) | total time: 351.14 | forward: 120.30 | backward: 222.40 | allreduce: 9.76 | optimizer: 5.35 | bias in backward: 4.03 | dropout in backward: 6.50
 iteration       74/     100 | elapsed time per iteration (ms): 350.0 | learning rate: 5.960E-07 | lm loss: 1.050344E+01 | sop loss: 6.723595E-01 | loss scale: 262144.0 |
time (ms) | total time: 349.75 | forward: 121.28 | backward: 220.42 | allreduce: 9.76 | optimizer: 5.36 | bias in backward: 4.03 | dropout in backward: 6.52
 iteration       75/     100 | elapsed time per iteration (ms): 347.5 | learning rate: 6.061E-07 | lm loss: 1.052469E+01 | sop loss: 7.684668E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.16 | forward: 120.48 | backward: 218.34 | allreduce: 9.42 | optimizer: 5.33 | bias in backward: 4.03 | dropout in backward: 6.51
 iteration       76/     100 | elapsed time per iteration (ms): 346.7 | learning rate: 6.162E-07 | lm loss: 1.052797E+01 | sop loss: 7.878931E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.34 | forward: 120.18 | backward: 218.05 | allreduce: 9.51 | optimizer: 5.34 | bias in backward: 4.02 | dropout in backward: 6.51
 iteration       77/     100 | elapsed time per iteration (ms): 346.6 | learning rate: 6.263E-07 | lm loss: 1.052506E+01 | sop loss: 6.493707E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.29 | forward: 120.09 | backward: 218.26 | allreduce: 9.43 | optimizer: 5.34 | bias in backward: 4.03 | dropout in backward: 6.48
 iteration       78/     100 | elapsed time per iteration (ms): 349.9 | learning rate: 6.364E-07 | lm loss: 1.049938E+01 | sop loss: 7.530010E-01 | loss scale: 262144.0 |
time (ms) | total time: 349.58 | forward: 119.91 | backward: 221.38 | allreduce: 9.59 | optimizer: 5.37 | bias in backward: 4.08 | dropout in backward: 6.49
 iteration       79/     100 | elapsed time per iteration (ms): 348.0 | learning rate: 6.465E-07 | lm loss: 1.050002E+01 | sop loss: 7.975810E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.71 | forward: 120.48 | backward: 218.95 | allreduce: 9.62 | optimizer: 5.34 | bias in backward: 4.02 | dropout in backward: 6.49
 iteration       80/     100 | elapsed time per iteration (ms): 346.8 | learning rate: 6.566E-07 | lm loss: 1.049120E+01 | sop loss: 7.017683E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.50 | forward: 119.78 | backward: 218.41 | allreduce: 9.44 | optimizer: 5.33 | bias in backward: 4.07 | dropout in backward: 6.48
 iteration       81/     100 | elapsed time per iteration (ms): 347.7 | learning rate: 6.667E-07 | lm loss: 1.052137E+01 | sop loss: 6.485895E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.47 | forward: 120.32 | backward: 218.98 | allreduce: 9.38 | optimizer: 5.33 | bias in backward: 4.07 | dropout in backward: 6.49
 iteration       82/     100 | elapsed time per iteration (ms): 348.4 | learning rate: 6.768E-07 | lm loss: 1.052024E+01 | sop loss: 6.982843E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.08 | forward: 119.88 | backward: 219.97 | allreduce: 9.64 | optimizer: 5.36 | bias in backward: 4.01 | dropout in backward: 6.47
 iteration       83/     100 | elapsed time per iteration (ms): 347.7 | learning rate: 6.869E-07 | lm loss: 1.050221E+01 | sop loss: 7.045998E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.38 | forward: 120.28 | backward: 218.89 | allreduce: 9.40 | optimizer: 5.34 | bias in backward: 4.04 | dropout in backward: 6.48
 iteration       84/     100 | elapsed time per iteration (ms): 351.4 | learning rate: 6.970E-07 | lm loss: 1.048967E+01 | sop loss: 7.600323E-01 | loss scale: 262144.0 |
time (ms) | total time: 351.16 | forward: 120.00 | backward: 222.67 | allreduce: 9.71 | optimizer: 5.53 | bias in backward: 4.02 | dropout in backward: 6.48
 iteration       85/     100 | elapsed time per iteration (ms): 349.1 | learning rate: 7.071E-07 | lm loss: 1.049851E+01 | sop loss: 6.274506E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.78 | forward: 120.31 | backward: 220.52 | allreduce: 9.45 | optimizer: 5.33 | bias in backward: 4.01 | dropout in backward: 6.51
 iteration       86/     100 | elapsed time per iteration (ms): 348.2 | learning rate: 7.172E-07 | lm loss: 1.049611E+01 | sop loss: 7.618496E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.97 | forward: 120.43 | backward: 219.85 | allreduce: 9.46 | optimizer: 5.35 | bias in backward: 4.07 | dropout in backward: 6.53
 iteration       87/     100 | elapsed time per iteration (ms): 347.6 | learning rate: 7.273E-07 | lm loss: 1.048585E+01 | sop loss: 6.959206E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.26 | forward: 120.19 | backward: 219.59 | allreduce: 8.90 | optimizer: 5.32 | bias in backward: 4.01 | dropout in backward: 6.48
 iteration       88/     100 | elapsed time per iteration (ms): 348.8 | learning rate: 7.374E-07 | lm loss: 1.053518E+01 | sop loss: 7.659024E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.49 | forward: 120.31 | backward: 220.50 | allreduce: 9.34 | optimizer: 5.39 | bias in backward: 4.12 | dropout in backward: 6.50
 iteration       89/     100 | elapsed time per iteration (ms): 349.0 | learning rate: 7.475E-07 | lm loss: 1.051738E+01 | sop loss: 7.943758E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.73 | forward: 120.18 | backward: 220.65 | allreduce: 9.49 | optimizer: 5.35 | bias in backward: 4.04 | dropout in backward: 6.49
 iteration       90/     100 | elapsed time per iteration (ms): 347.7 | learning rate: 7.576E-07 | lm loss: 1.049794E+01 | sop loss: 6.807379E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.45 | forward: 120.11 | backward: 219.81 | allreduce: 8.94 | optimizer: 5.32 | bias in backward: 4.10 | dropout in backward: 6.57
 iteration       91/     100 | elapsed time per iteration (ms): 348.5 | learning rate: 7.677E-07 | lm loss: 1.050449E+01 | sop loss: 7.177418E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.25 | forward: 120.27 | backward: 220.51 | allreduce: 9.13 | optimizer: 5.34 | bias in backward: 4.34 | dropout in backward: 6.58
 iteration       92/     100 | elapsed time per iteration (ms): 347.9 | learning rate: 7.778E-07 | lm loss: 1.051577E+01 | sop loss: 6.945043E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.59 | forward: 120.52 | backward: 219.46 | allreduce: 8.87 | optimizer: 5.31 | bias in backward: 4.04 | dropout in backward: 6.55
 iteration       93/     100 | elapsed time per iteration (ms): 348.9 | learning rate: 7.879E-07 | lm loss: 1.050107E+01 | sop loss: 7.280490E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.61 | forward: 120.38 | backward: 220.61 | allreduce: 9.64 | optimizer: 5.38 | bias in backward: 4.09 | dropout in backward: 6.60
 iteration       94/     100 | elapsed time per iteration (ms): 347.0 | learning rate: 7.980E-07 | lm loss: 1.049359E+01 | sop loss: 7.148821E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.73 | forward: 120.11 | backward: 219.13 | allreduce: 8.84 | optimizer: 5.30 | bias in backward: 4.01 | dropout in backward: 6.48
 iteration       95/     100 | elapsed time per iteration (ms): 347.7 | learning rate: 8.081E-07 | lm loss: 1.050966E+01 | sop loss: 7.197846E-01 | loss scale: 262144.0 |
time (ms) | total time: 347.48 | forward: 120.16 | backward: 220.04 | allreduce: 8.83 | optimizer: 5.29 | bias in backward: 4.06 | dropout in backward: 6.51
 iteration       96/     100 | elapsed time per iteration (ms): 368.6 | learning rate: 8.182E-07 | lm loss: 1.049110E+01 | sop loss: 7.024969E-01 | loss scale: 262144.0 |
time (ms) | total time: 368.37 | forward: 119.87 | backward: 240.78 | allreduce: 31.51 | optimizer: 5.33 | bias in backward: 3.99 | dropout in backward: 6.47
 iteration       97/     100 | elapsed time per iteration (ms): 346.7 | learning rate: 8.283E-07 | lm loss: 1.048950E+01 | sop loss: 7.644537E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.42 | forward: 120.31 | backward: 218.54 | allreduce: 8.89 | optimizer: 5.28 | bias in backward: 4.07 | dropout in backward: 6.49
 iteration       98/     100 | elapsed time per iteration (ms): 349.1 | learning rate: 8.384E-07 | lm loss: 1.048381E+01 | sop loss: 6.670606E-01 | loss scale: 262144.0 |
time (ms) | total time: 348.75 | forward: 120.00 | backward: 221.05 | allreduce: 9.34 | optimizer: 5.34 | bias in backward: 4.08 | dropout in backward: 6.51
 iteration       99/     100 | elapsed time per iteration (ms): 373.5 | learning rate: 8.485E-07 | lm loss: 1.051267E+01 | sop loss: 6.796867E-01 | loss scale: 262144.0 |
time (ms) | total time: 373.26 | forward: 120.02 | backward: 245.95 | allreduce: 8.89 | optimizer: 5.31 | bias in backward: 4.02 | dropout in backward: 6.46
 iteration      100/     100 | elapsed time per iteration (ms): 347.1 | learning rate: 8.586E-07 | lm loss: 1.049783E+01 | sop loss: 7.505146E-01 | loss scale: 262144.0 |
time (ms) | total time: 346.80 | forward: 120.37 | backward: 219.11 | allreduce: 8.82 | optimizer: 5.31 | bias in backward: 4.02 | dropout in backward: 6.48
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

64

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.098008 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_6400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_6400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_6400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3510.67 | train/valid/test data iterators: 2253.10
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 5438.9 | learning rate: 0.000E+00 | lm loss: 1.054956E+01 | sop loss: 7.543764E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 743.09228515625 | max allocated: 25067.0126953125 | cached: 25168.0 | max cached: 25168.0
time (ms) | total time: 5438.65 | forward: 3207.68 | backward: 617.24 | allreduce: 9.21 | optimizer: 0.05 | bias in backward: 5.93 | dropout in backward: 11.98
 iteration        2/     100 | elapsed time per iteration (ms): 572.8 | learning rate: 0.000E+00 | lm loss: 1.056225E+01 | sop loss: 7.489229E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 571.19 | forward: 238.51 | backward: 329.42 | allreduce: 9.41 | optimizer: 0.05 | bias in backward: 5.95 | dropout in backward: 11.98
 iteration        3/     100 | elapsed time per iteration (ms): 560.3 | learning rate: 0.000E+00 | lm loss: 1.056215E+01 | sop loss: 7.158048E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 559.98 | forward: 226.45 | backward: 330.52 | allreduce: 9.18 | optimizer: 0.04 | bias in backward: 5.98 | dropout in backward: 11.98
 iteration        4/     100 | elapsed time per iteration (ms): 557.9 | learning rate: 0.000E+00 | lm loss: 1.055905E+01 | sop loss: 7.243482E-01 | loss scale: 536870912.0 |
time (ms) | total time: 557.60 | forward: 226.85 | backward: 327.87 | allreduce: 9.18 | optimizer: 0.04 | bias in backward: 5.99 | dropout in backward: 11.99
 iteration        5/     100 | elapsed time per iteration (ms): 557.8 | learning rate: 0.000E+00 | lm loss: 1.055243E+01 | sop loss: 7.405813E-01 | loss scale: 268435456.0 |
time (ms) | total time: 557.48 | forward: 226.33 | backward: 328.59 | allreduce: 8.86 | optimizer: 0.04 | bias in backward: 5.95 | dropout in backward: 11.96
 iteration        6/     100 | elapsed time per iteration (ms): 560.0 | learning rate: 0.000E+00 | lm loss: 1.056013E+01 | sop loss: 7.089074E-01 | loss scale: 134217728.0 |
time (ms) | total time: 559.68 | forward: 227.52 | backward: 329.46 | allreduce: 9.21 | optimizer: 0.04 | bias in backward: 5.97 | dropout in backward: 12.07
 iteration        7/     100 | elapsed time per iteration (ms): 558.7 | learning rate: 0.000E+00 | lm loss: 1.055177E+01 | sop loss: 7.014264E-01 | loss scale: 67108864.0 |
time (ms) | total time: 558.41 | forward: 226.96 | backward: 328.61 | allreduce: 9.27 | optimizer: 0.04 | bias in backward: 6.01 | dropout in backward: 12.13
 iteration        8/     100 | elapsed time per iteration (ms): 559.2 | learning rate: 0.000E+00 | lm loss: 1.056294E+01 | sop loss: 7.618911E-01 | loss scale: 33554432.0 |
time (ms) | total time: 558.87 | forward: 226.60 | backward: 329.33 | allreduce: 9.32 | optimizer: 0.04 | bias in backward: 6.01 | dropout in backward: 12.14
 iteration        9/     100 | elapsed time per iteration (ms): 559.2 | learning rate: 0.000E+00 | lm loss: 1.055294E+01 | sop loss: 7.235970E-01 | loss scale: 16777216.0 |
time (ms) | total time: 558.92 | forward: 226.99 | backward: 329.03 | allreduce: 9.29 | optimizer: 0.04 | bias in backward: 6.04 | dropout in backward: 12.01
 iteration       10/     100 | elapsed time per iteration (ms): 557.2 | learning rate: 0.000E+00 | lm loss: 1.053793E+01 | sop loss: 7.402574E-01 | loss scale: 8388608.0 |
time (ms) | total time: 556.85 | forward: 226.90 | backward: 326.91 | allreduce: 9.24 | optimizer: 0.04 | bias in backward: 6.05 | dropout in backward: 12.02
 iteration       11/     100 | elapsed time per iteration (ms): 558.6 | learning rate: 0.000E+00 | lm loss: 1.056068E+01 | sop loss: 6.856602E-01 | loss scale: 4194304.0 |
time (ms) | total time: 558.34 | forward: 226.74 | backward: 328.84 | allreduce: 9.26 | optimizer: 0.04 | bias in backward: 5.99 | dropout in backward: 12.00
 iteration       12/     100 | elapsed time per iteration (ms): 566.3 | learning rate: 0.000E+00 | lm loss: 1.055053E+01 | sop loss: 7.034044E-01 | loss scale: 2097152.0 |
time (ms) | total time: 565.98 | forward: 226.95 | backward: 336.24 | allreduce: 9.11 | optimizer: 0.04 | bias in backward: 6.01 | dropout in backward: 11.96
 iteration       13/     100 | elapsed time per iteration (ms): 565.5 | learning rate: 0.000E+00 | lm loss: 1.055319E+01 | sop loss: 6.802129E-01 | loss scale: 1048576.0 |
time (ms) | total time: 565.23 | forward: 227.26 | backward: 335.14 | allreduce: 9.19 | optimizer: 0.04 | bias in backward: 5.95 | dropout in backward: 11.99
 iteration       14/     100 | elapsed time per iteration (ms): 564.0 | learning rate: 0.000E+00 | lm loss: 1.059560E+01 | sop loss: 7.209333E-01 | loss scale: 524288.0 |
time (ms) | total time: 563.74 | forward: 226.90 | backward: 334.00 | allreduce: 9.16 | optimizer: 0.04 | bias in backward: 6.25 | dropout in backward: 12.02
 iteration       15/     100 | elapsed time per iteration (ms): 746.1 | learning rate: 1.010E-08 | lm loss: 1.055276E+01 | sop loss: 7.111977E-01 | loss scale: 524288.0 |
time (ms) | total time: 745.82 | forward: 226.91 | backward: 389.24 | allreduce: 9.07 | optimizer: 126.82 | bias in backward: 6.08 | dropout in backward: 12.00
 iteration       16/     100 | elapsed time per iteration (ms): 608.3 | learning rate: 2.020E-08 | lm loss: 1.055437E+01 | sop loss: 7.397860E-01 | loss scale: 524288.0 |
time (ms) | total time: 607.91 | forward: 228.10 | backward: 368.40 | allreduce: 9.33 | optimizer: 5.35 | bias in backward: 5.99 | dropout in backward: 12.06
 iteration       17/     100 | elapsed time per iteration (ms): 604.5 | learning rate: 3.030E-08 | lm loss: 1.054695E+01 | sop loss: 7.550216E-01 | loss scale: 524288.0 |
time (ms) | total time: 604.15 | forward: 227.01 | backward: 368.88 | allreduce: 9.37 | optimizer: 5.34 | bias in backward: 5.95 | dropout in backward: 12.00
 iteration       18/     100 | elapsed time per iteration (ms): 603.2 | learning rate: 4.040E-08 | lm loss: 1.055731E+01 | sop loss: 7.233099E-01 | loss scale: 524288.0 |
time (ms) | total time: 602.82 | forward: 227.20 | backward: 367.36 | allreduce: 9.27 | optimizer: 5.36 | bias in backward: 6.11 | dropout in backward: 12.10
 iteration       19/     100 | elapsed time per iteration (ms): 603.4 | learning rate: 5.051E-08 | lm loss: 1.054649E+01 | sop loss: 7.421539E-01 | loss scale: 524288.0 |
time (ms) | total time: 603.00 | forward: 227.12 | backward: 367.40 | allreduce: 9.46 | optimizer: 5.44 | bias in backward: 6.01 | dropout in backward: 12.12
 iteration       20/     100 | elapsed time per iteration (ms): 602.2 | learning rate: 6.061E-08 | lm loss: 1.055080E+01 | sop loss: 7.402906E-01 | loss scale: 524288.0 |
time (ms) | total time: 601.84 | forward: 226.76 | backward: 366.79 | allreduce: 9.30 | optimizer: 5.35 | bias in backward: 6.07 | dropout in backward: 12.00
 iteration       21/     100 | elapsed time per iteration (ms): 604.1 | learning rate: 7.071E-08 | lm loss: 1.056464E+01 | sop loss: 6.994603E-01 | loss scale: 524288.0 |
time (ms) | total time: 603.72 | forward: 226.77 | backward: 368.57 | allreduce: 9.33 | optimizer: 5.53 | bias in backward: 6.03 | dropout in backward: 12.13
 iteration       22/     100 | elapsed time per iteration (ms): 565.2 | learning rate: 7.071E-08 | lm loss: 1.054853E+01 | sop loss: 7.570525E-01 | loss scale: 262144.0 |
time (ms) | total time: 564.88 | forward: 227.02 | backward: 335.14 | allreduce: 9.14 | optimizer: 0.04 | bias in backward: 5.97 | dropout in backward: 12.01
 iteration       23/     100 | elapsed time per iteration (ms): 603.5 | learning rate: 8.081E-08 | lm loss: 1.055850E+01 | sop loss: 7.213332E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.26 | forward: 227.09 | backward: 368.03 | allreduce: 9.43 | optimizer: 5.34 | bias in backward: 6.06 | dropout in backward: 12.18
 iteration       24/     100 | elapsed time per iteration (ms): 616.3 | learning rate: 9.091E-08 | lm loss: 1.055810E+01 | sop loss: 7.777972E-01 | loss scale: 262144.0 |
time (ms) | total time: 615.85 | forward: 227.05 | backward: 378.74 | allreduce: 11.73 | optimizer: 7.14 | bias in backward: 6.21 | dropout in backward: 12.23
 iteration       25/     100 | elapsed time per iteration (ms): 603.2 | learning rate: 1.010E-07 | lm loss: 1.057979E+01 | sop loss: 6.981906E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.87 | forward: 227.65 | backward: 366.87 | allreduce: 9.52 | optimizer: 5.35 | bias in backward: 6.06 | dropout in backward: 12.10
 iteration       26/     100 | elapsed time per iteration (ms): 603.6 | learning rate: 1.111E-07 | lm loss: 1.056497E+01 | sop loss: 6.659059E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.30 | forward: 227.16 | backward: 367.75 | allreduce: 9.45 | optimizer: 5.38 | bias in backward: 5.99 | dropout in backward: 12.06
 iteration       27/     100 | elapsed time per iteration (ms): 602.5 | learning rate: 1.212E-07 | lm loss: 1.055579E+01 | sop loss: 7.737269E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.17 | forward: 227.37 | backward: 366.55 | allreduce: 9.13 | optimizer: 5.36 | bias in backward: 6.30 | dropout in backward: 12.00
 iteration       28/     100 | elapsed time per iteration (ms): 604.9 | learning rate: 1.313E-07 | lm loss: 1.056269E+01 | sop loss: 7.183990E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.52 | forward: 227.16 | backward: 368.93 | allreduce: 9.53 | optimizer: 5.42 | bias in backward: 5.93 | dropout in backward: 11.98
 iteration       29/     100 | elapsed time per iteration (ms): 602.3 | learning rate: 1.414E-07 | lm loss: 1.054652E+01 | sop loss: 6.837558E-01 | loss scale: 262144.0 |
time (ms) | total time: 601.95 | forward: 226.85 | backward: 366.84 | allreduce: 9.20 | optimizer: 5.41 | bias in backward: 5.93 | dropout in backward: 11.95
 iteration       30/     100 | elapsed time per iteration (ms): 601.4 | learning rate: 1.515E-07 | lm loss: 1.058970E+01 | sop loss: 7.429865E-01 | loss scale: 262144.0 |
time (ms) | total time: 601.01 | forward: 226.92 | backward: 365.85 | allreduce: 9.07 | optimizer: 5.36 | bias in backward: 5.93 | dropout in backward: 11.94
 iteration       31/     100 | elapsed time per iteration (ms): 603.3 | learning rate: 1.616E-07 | lm loss: 1.053663E+01 | sop loss: 7.066258E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.98 | forward: 226.59 | backward: 368.33 | allreduce: 9.33 | optimizer: 5.35 | bias in backward: 5.97 | dropout in backward: 11.98
 iteration       32/     100 | elapsed time per iteration (ms): 601.3 | learning rate: 1.717E-07 | lm loss: 1.055140E+01 | sop loss: 7.314360E-01 | loss scale: 262144.0 |
time (ms) | total time: 600.96 | forward: 226.94 | backward: 365.89 | allreduce: 9.25 | optimizer: 5.37 | bias in backward: 5.91 | dropout in backward: 11.95
 iteration       33/     100 | elapsed time per iteration (ms): 603.4 | learning rate: 1.818E-07 | lm loss: 1.055587E+01 | sop loss: 7.338817E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.06 | forward: 226.84 | backward: 368.20 | allreduce: 9.06 | optimizer: 5.35 | bias in backward: 5.95 | dropout in backward: 11.95
 iteration       34/     100 | elapsed time per iteration (ms): 609.4 | learning rate: 1.919E-07 | lm loss: 1.054519E+01 | sop loss: 7.304043E-01 | loss scale: 262144.0 |
time (ms) | total time: 609.07 | forward: 227.79 | backward: 373.18 | allreduce: 9.41 | optimizer: 5.33 | bias in backward: 5.98 | dropout in backward: 12.05
 iteration       35/     100 | elapsed time per iteration (ms): 604.6 | learning rate: 2.020E-07 | lm loss: 1.057010E+01 | sop loss: 7.534492E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.29 | forward: 229.64 | backward: 366.55 | allreduce: 9.02 | optimizer: 5.38 | bias in backward: 6.18 | dropout in backward: 11.96
 iteration       36/     100 | elapsed time per iteration (ms): 604.9 | learning rate: 2.121E-07 | lm loss: 1.056854E+01 | sop loss: 7.233840E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.59 | forward: 227.45 | backward: 368.97 | allreduce: 9.50 | optimizer: 5.37 | bias in backward: 5.94 | dropout in backward: 11.96
 iteration       37/     100 | elapsed time per iteration (ms): 602.6 | learning rate: 2.222E-07 | lm loss: 1.055481E+01 | sop loss: 7.750105E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.27 | forward: 227.37 | backward: 366.59 | allreduce: 9.39 | optimizer: 5.38 | bias in backward: 6.21 | dropout in backward: 12.03
 iteration       38/     100 | elapsed time per iteration (ms): 603.2 | learning rate: 2.323E-07 | lm loss: 1.056730E+01 | sop loss: 7.687719E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.85 | forward: 227.34 | backward: 367.24 | allreduce: 9.38 | optimizer: 5.37 | bias in backward: 5.97 | dropout in backward: 12.08
 iteration       39/     100 | elapsed time per iteration (ms): 601.5 | learning rate: 2.424E-07 | lm loss: 1.055720E+01 | sop loss: 6.963572E-01 | loss scale: 262144.0 |
time (ms) | total time: 601.19 | forward: 227.16 | backward: 365.88 | allreduce: 9.21 | optimizer: 5.35 | bias in backward: 6.02 | dropout in backward: 12.01
 iteration       40/     100 | elapsed time per iteration (ms): 602.2 | learning rate: 2.525E-07 | lm loss: 1.055004E+01 | sop loss: 7.496781E-01 | loss scale: 262144.0 |
time (ms) | total time: 601.90 | forward: 227.06 | backward: 366.78 | allreduce: 9.16 | optimizer: 5.37 | bias in backward: 5.92 | dropout in backward: 11.93
 iteration       41/     100 | elapsed time per iteration (ms): 606.7 | learning rate: 2.626E-07 | lm loss: 1.056647E+01 | sop loss: 7.457490E-01 | loss scale: 262144.0 |
time (ms) | total time: 606.29 | forward: 228.00 | backward: 370.18 | allreduce: 9.20 | optimizer: 5.36 | bias in backward: 5.92 | dropout in backward: 11.95
 iteration       42/     100 | elapsed time per iteration (ms): 603.5 | learning rate: 2.727E-07 | lm loss: 1.052902E+01 | sop loss: 7.419179E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.19 | forward: 227.59 | backward: 367.39 | allreduce: 9.39 | optimizer: 5.37 | bias in backward: 5.96 | dropout in backward: 11.99
 iteration       43/     100 | elapsed time per iteration (ms): 605.6 | learning rate: 2.828E-07 | lm loss: 1.055724E+01 | sop loss: 7.622594E-01 | loss scale: 262144.0 |
time (ms) | total time: 605.21 | forward: 227.52 | backward: 369.39 | allreduce: 9.26 | optimizer: 5.37 | bias in backward: 6.21 | dropout in backward: 11.99
 iteration       44/     100 | elapsed time per iteration (ms): 604.4 | learning rate: 2.929E-07 | lm loss: 1.054973E+01 | sop loss: 6.971800E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.08 | forward: 227.95 | backward: 367.87 | allreduce: 9.27 | optimizer: 5.47 | bias in backward: 5.97 | dropout in backward: 11.98
 iteration       45/     100 | elapsed time per iteration (ms): 604.2 | learning rate: 3.030E-07 | lm loss: 1.056055E+01 | sop loss: 7.298863E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.85 | forward: 227.31 | backward: 368.39 | allreduce: 9.43 | optimizer: 5.37 | bias in backward: 5.96 | dropout in backward: 12.02
 iteration       46/     100 | elapsed time per iteration (ms): 608.2 | learning rate: 3.131E-07 | lm loss: 1.054079E+01 | sop loss: 7.255287E-01 | loss scale: 262144.0 |
time (ms) | total time: 607.86 | forward: 227.72 | backward: 371.76 | allreduce: 9.41 | optimizer: 5.42 | bias in backward: 5.98 | dropout in backward: 12.01
 iteration       47/     100 | elapsed time per iteration (ms): 603.4 | learning rate: 3.232E-07 | lm loss: 1.055888E+01 | sop loss: 7.472892E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.98 | forward: 227.84 | backward: 366.76 | allreduce: 9.98 | optimizer: 5.38 | bias in backward: 6.05 | dropout in backward: 12.04
 iteration       48/     100 | elapsed time per iteration (ms): 604.0 | learning rate: 3.333E-07 | lm loss: 1.054988E+01 | sop loss: 6.985767E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.71 | forward: 227.31 | backward: 368.16 | allreduce: 9.28 | optimizer: 5.37 | bias in backward: 5.96 | dropout in backward: 11.99
 iteration       49/     100 | elapsed time per iteration (ms): 601.6 | learning rate: 3.434E-07 | lm loss: 1.054400E+01 | sop loss: 7.086036E-01 | loss scale: 262144.0 |
time (ms) | total time: 601.22 | forward: 227.05 | backward: 365.96 | allreduce: 9.11 | optimizer: 5.38 | bias in backward: 5.91 | dropout in backward: 11.95
 iteration       50/     100 | elapsed time per iteration (ms): 605.5 | learning rate: 3.535E-07 | lm loss: 1.054040E+01 | sop loss: 7.223201E-01 | loss scale: 262144.0 |
time (ms) | total time: 605.15 | forward: 227.74 | backward: 369.33 | allreduce: 9.20 | optimizer: 5.36 | bias in backward: 5.97 | dropout in backward: 11.96
 iteration       51/     100 | elapsed time per iteration (ms): 603.2 | learning rate: 3.636E-07 | lm loss: 1.055083E+01 | sop loss: 7.094193E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.85 | forward: 227.69 | backward: 367.02 | allreduce: 9.46 | optimizer: 5.37 | bias in backward: 5.97 | dropout in backward: 12.00
 iteration       52/     100 | elapsed time per iteration (ms): 602.2 | learning rate: 3.737E-07 | lm loss: 1.053807E+01 | sop loss: 6.912844E-01 | loss scale: 262144.0 |
time (ms) | total time: 601.87 | forward: 227.29 | backward: 366.39 | allreduce: 9.25 | optimizer: 5.38 | bias in backward: 5.94 | dropout in backward: 12.06
 iteration       53/     100 | elapsed time per iteration (ms): 605.2 | learning rate: 3.838E-07 | lm loss: 1.054638E+01 | sop loss: 7.102554E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.85 | forward: 227.68 | backward: 369.04 | allreduce: 9.31 | optimizer: 5.36 | bias in backward: 5.94 | dropout in backward: 12.07
 iteration       54/     100 | elapsed time per iteration (ms): 603.4 | learning rate: 3.939E-07 | lm loss: 1.054255E+01 | sop loss: 7.269204E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.03 | forward: 227.41 | backward: 367.23 | allreduce: 9.45 | optimizer: 5.38 | bias in backward: 5.94 | dropout in backward: 12.01
 iteration       55/     100 | elapsed time per iteration (ms): 602.9 | learning rate: 4.040E-07 | lm loss: 1.054031E+01 | sop loss: 6.911716E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.58 | forward: 227.46 | backward: 367.12 | allreduce: 9.25 | optimizer: 5.37 | bias in backward: 6.24 | dropout in backward: 12.00
 iteration       56/     100 | elapsed time per iteration (ms): 603.3 | learning rate: 4.141E-07 | lm loss: 1.053469E+01 | sop loss: 6.681151E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.98 | forward: 227.70 | backward: 366.89 | allreduce: 9.50 | optimizer: 5.39 | bias in backward: 5.95 | dropout in backward: 12.04
 iteration       57/     100 | elapsed time per iteration (ms): 605.0 | learning rate: 4.242E-07 | lm loss: 1.053705E+01 | sop loss: 6.668337E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.62 | forward: 227.34 | backward: 369.14 | allreduce: 9.35 | optimizer: 5.37 | bias in backward: 5.97 | dropout in backward: 12.02
 iteration       58/     100 | elapsed time per iteration (ms): 603.7 | learning rate: 4.343E-07 | lm loss: 1.055979E+01 | sop loss: 7.069258E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.33 | forward: 227.37 | backward: 367.89 | allreduce: 9.06 | optimizer: 5.38 | bias in backward: 6.28 | dropout in backward: 11.99
 iteration       59/     100 | elapsed time per iteration (ms): 605.0 | learning rate: 4.444E-07 | lm loss: 1.053264E+01 | sop loss: 7.064766E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.64 | forward: 227.89 | backward: 368.61 | allreduce: 9.39 | optimizer: 5.36 | bias in backward: 5.96 | dropout in backward: 11.99
 iteration       60/     100 | elapsed time per iteration (ms): 603.4 | learning rate: 4.545E-07 | lm loss: 1.054627E+01 | sop loss: 7.371471E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.07 | forward: 226.92 | backward: 368.05 | allreduce: 9.11 | optimizer: 5.37 | bias in backward: 5.99 | dropout in backward: 11.98
 iteration       61/     100 | elapsed time per iteration (ms): 604.4 | learning rate: 4.646E-07 | lm loss: 1.053550E+01 | sop loss: 6.907952E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.09 | forward: 227.79 | backward: 368.19 | allreduce: 9.28 | optimizer: 5.37 | bias in backward: 5.95 | dropout in backward: 12.01
 iteration       62/     100 | elapsed time per iteration (ms): 605.9 | learning rate: 4.747E-07 | lm loss: 1.054496E+01 | sop loss: 7.405668E-01 | loss scale: 262144.0 |
time (ms) | total time: 605.51 | forward: 227.49 | backward: 369.81 | allreduce: 9.38 | optimizer: 5.38 | bias in backward: 5.95 | dropout in backward: 12.03
 iteration       63/     100 | elapsed time per iteration (ms): 603.8 | learning rate: 4.848E-07 | lm loss: 1.052582E+01 | sop loss: 7.272720E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.44 | forward: 227.49 | backward: 367.82 | allreduce: 9.38 | optimizer: 5.35 | bias in backward: 5.95 | dropout in backward: 11.99
 iteration       64/     100 | elapsed time per iteration (ms): 605.2 | learning rate: 4.949E-07 | lm loss: 1.052241E+01 | sop loss: 6.566182E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.90 | forward: 227.64 | backward: 369.03 | allreduce: 9.19 | optimizer: 5.37 | bias in backward: 5.97 | dropout in backward: 12.11
 iteration       65/     100 | elapsed time per iteration (ms): 606.1 | learning rate: 5.051E-07 | lm loss: 1.054020E+01 | sop loss: 7.000559E-01 | loss scale: 262144.0 |
time (ms) | total time: 605.84 | forward: 227.55 | backward: 370.18 | allreduce: 9.46 | optimizer: 5.37 | bias in backward: 6.30 | dropout in backward: 12.06
 iteration       66/     100 | elapsed time per iteration (ms): 604.3 | learning rate: 5.152E-07 | lm loss: 1.051919E+01 | sop loss: 6.936516E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.99 | forward: 227.70 | backward: 367.66 | allreduce: 9.20 | optimizer: 5.41 | bias in backward: 5.98 | dropout in backward: 12.00
 iteration       67/     100 | elapsed time per iteration (ms): 601.7 | learning rate: 5.253E-07 | lm loss: 1.054530E+01 | sop loss: 7.750100E-01 | loss scale: 262144.0 |
time (ms) | total time: 601.32 | forward: 227.37 | backward: 365.89 | allreduce: 9.25 | optimizer: 5.38 | bias in backward: 5.96 | dropout in backward: 12.01
 iteration       68/     100 | elapsed time per iteration (ms): 603.1 | learning rate: 5.354E-07 | lm loss: 1.053049E+01 | sop loss: 7.561628E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.72 | forward: 228.09 | backward: 366.45 | allreduce: 9.43 | optimizer: 5.38 | bias in backward: 6.04 | dropout in backward: 12.04
 iteration       69/     100 | elapsed time per iteration (ms): 603.5 | learning rate: 5.455E-07 | lm loss: 1.053949E+01 | sop loss: 7.140924E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.22 | forward: 227.71 | backward: 367.18 | allreduce: 9.50 | optimizer: 5.37 | bias in backward: 6.33 | dropout in backward: 12.06
 iteration       70/     100 | elapsed time per iteration (ms): 607.5 | learning rate: 5.556E-07 | lm loss: 1.053671E+01 | sop loss: 7.147810E-01 | loss scale: 262144.0 |
time (ms) | total time: 607.16 | forward: 229.49 | backward: 369.12 | allreduce: 9.19 | optimizer: 5.39 | bias in backward: 5.98 | dropout in backward: 12.01
 iteration       71/     100 | elapsed time per iteration (ms): 605.5 | learning rate: 5.657E-07 | lm loss: 1.051727E+01 | sop loss: 7.334961E-01 | loss scale: 262144.0 |
time (ms) | total time: 605.11 | forward: 227.42 | backward: 369.35 | allreduce: 9.33 | optimizer: 5.43 | bias in backward: 5.95 | dropout in backward: 11.98
 iteration       72/     100 | elapsed time per iteration (ms): 606.9 | learning rate: 5.758E-07 | lm loss: 1.053447E+01 | sop loss: 7.038515E-01 | loss scale: 262144.0 |
time (ms) | total time: 606.49 | forward: 227.86 | backward: 370.31 | allreduce: 9.28 | optimizer: 5.38 | bias in backward: 5.93 | dropout in backward: 11.94
 iteration       73/     100 | elapsed time per iteration (ms): 603.2 | learning rate: 5.859E-07 | lm loss: 1.051774E+01 | sop loss: 7.008383E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.93 | forward: 227.46 | backward: 367.34 | allreduce: 9.07 | optimizer: 5.37 | bias in backward: 5.91 | dropout in backward: 11.94
 iteration       74/     100 | elapsed time per iteration (ms): 604.3 | learning rate: 5.960E-07 | lm loss: 1.051388E+01 | sop loss: 7.489597E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.94 | forward: 227.08 | backward: 368.63 | allreduce: 9.40 | optimizer: 5.39 | bias in backward: 5.95 | dropout in backward: 11.98
 iteration       75/     100 | elapsed time per iteration (ms): 605.8 | learning rate: 6.061E-07 | lm loss: 1.051079E+01 | sop loss: 7.216894E-01 | loss scale: 262144.0 |
time (ms) | total time: 605.45 | forward: 227.43 | backward: 369.72 | allreduce: 9.38 | optimizer: 5.38 | bias in backward: 5.94 | dropout in backward: 11.99
 iteration       76/     100 | elapsed time per iteration (ms): 602.2 | learning rate: 6.162E-07 | lm loss: 1.051687E+01 | sop loss: 7.011598E-01 | loss scale: 262144.0 |
time (ms) | total time: 601.84 | forward: 227.10 | backward: 366.35 | allreduce: 9.10 | optimizer: 5.41 | bias in backward: 5.99 | dropout in backward: 11.96
 iteration       77/     100 | elapsed time per iteration (ms): 603.8 | learning rate: 6.263E-07 | lm loss: 1.051398E+01 | sop loss: 7.957513E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.41 | forward: 227.29 | backward: 367.83 | allreduce: 9.38 | optimizer: 5.37 | bias in backward: 5.94 | dropout in backward: 11.98
 iteration       78/     100 | elapsed time per iteration (ms): 603.8 | learning rate: 6.364E-07 | lm loss: 1.050830E+01 | sop loss: 7.410538E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.45 | forward: 227.61 | backward: 367.66 | allreduce: 9.12 | optimizer: 5.37 | bias in backward: 6.05 | dropout in backward: 11.99
 iteration       79/     100 | elapsed time per iteration (ms): 605.0 | learning rate: 6.465E-07 | lm loss: 1.053955E+01 | sop loss: 6.576849E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.60 | forward: 227.42 | backward: 369.23 | allreduce: 9.31 | optimizer: 5.37 | bias in backward: 5.93 | dropout in backward: 11.99
 iteration       80/     100 | elapsed time per iteration (ms): 605.2 | learning rate: 6.566E-07 | lm loss: 1.050104E+01 | sop loss: 6.820442E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.84 | forward: 227.60 | backward: 368.97 | allreduce: 9.48 | optimizer: 5.38 | bias in backward: 5.96 | dropout in backward: 11.97
 iteration       81/     100 | elapsed time per iteration (ms): 605.9 | learning rate: 6.667E-07 | lm loss: 1.052186E+01 | sop loss: 7.228897E-01 | loss scale: 262144.0 |
time (ms) | total time: 605.54 | forward: 227.80 | backward: 369.46 | allreduce: 9.39 | optimizer: 5.38 | bias in backward: 6.02 | dropout in backward: 12.10
 iteration       82/     100 | elapsed time per iteration (ms): 604.3 | learning rate: 6.768E-07 | lm loss: 1.052207E+01 | sop loss: 7.452323E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.93 | forward: 227.65 | backward: 368.07 | allreduce: 9.42 | optimizer: 5.38 | bias in backward: 5.97 | dropout in backward: 12.02
 iteration       83/     100 | elapsed time per iteration (ms): 602.6 | learning rate: 6.869E-07 | lm loss: 1.051012E+01 | sop loss: 7.098687E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.26 | forward: 227.34 | backward: 366.68 | allreduce: 9.32 | optimizer: 5.39 | bias in backward: 5.95 | dropout in backward: 12.01
 iteration       84/     100 | elapsed time per iteration (ms): 602.5 | learning rate: 6.970E-07 | lm loss: 1.050725E+01 | sop loss: 7.401249E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.08 | forward: 227.35 | backward: 366.46 | allreduce: 9.47 | optimizer: 5.38 | bias in backward: 6.03 | dropout in backward: 12.05
 iteration       85/     100 | elapsed time per iteration (ms): 603.1 | learning rate: 7.071E-07 | lm loss: 1.051317E+01 | sop loss: 7.415488E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.75 | forward: 227.23 | backward: 367.25 | allreduce: 9.44 | optimizer: 5.36 | bias in backward: 5.94 | dropout in backward: 11.97
 iteration       86/     100 | elapsed time per iteration (ms): 602.5 | learning rate: 7.172E-07 | lm loss: 1.051534E+01 | sop loss: 7.120127E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.18 | forward: 227.90 | backward: 366.17 | allreduce: 9.24 | optimizer: 5.35 | bias in backward: 6.04 | dropout in backward: 12.00
 iteration       87/     100 | elapsed time per iteration (ms): 604.6 | learning rate: 7.273E-07 | lm loss: 1.050055E+01 | sop loss: 6.938762E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.21 | forward: 227.30 | backward: 368.79 | allreduce: 9.17 | optimizer: 5.37 | bias in backward: 5.99 | dropout in backward: 11.97
 iteration       88/     100 | elapsed time per iteration (ms): 603.6 | learning rate: 7.374E-07 | lm loss: 1.048542E+01 | sop loss: 7.690544E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.27 | forward: 227.71 | backward: 367.32 | allreduce: 9.41 | optimizer: 5.37 | bias in backward: 5.94 | dropout in backward: 12.00
 iteration       89/     100 | elapsed time per iteration (ms): 601.8 | learning rate: 7.475E-07 | lm loss: 1.050557E+01 | sop loss: 6.921198E-01 | loss scale: 262144.0 |
time (ms) | total time: 601.48 | forward: 227.25 | backward: 366.18 | allreduce: 9.05 | optimizer: 5.34 | bias in backward: 5.92 | dropout in backward: 11.95
 iteration       90/     100 | elapsed time per iteration (ms): 604.7 | learning rate: 7.576E-07 | lm loss: 1.049313E+01 | sop loss: 7.171786E-01 | loss scale: 262144.0 |
time (ms) | total time: 604.31 | forward: 227.44 | backward: 368.58 | allreduce: 9.19 | optimizer: 5.41 | bias in backward: 5.97 | dropout in backward: 12.17
 iteration       91/     100 | elapsed time per iteration (ms): 603.5 | learning rate: 7.677E-07 | lm loss: 1.048823E+01 | sop loss: 6.996559E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.10 | forward: 227.36 | backward: 367.52 | allreduce: 9.24 | optimizer: 5.37 | bias in backward: 5.95 | dropout in backward: 12.04
 iteration       92/     100 | elapsed time per iteration (ms): 607.5 | learning rate: 7.778E-07 | lm loss: 1.048954E+01 | sop loss: 7.111199E-01 | loss scale: 262144.0 |
time (ms) | total time: 607.13 | forward: 227.48 | backward: 371.54 | allreduce: 9.21 | optimizer: 5.36 | bias in backward: 6.24 | dropout in backward: 12.10
 iteration       93/     100 | elapsed time per iteration (ms): 605.3 | learning rate: 7.879E-07 | lm loss: 1.052260E+01 | sop loss: 7.218924E-01 | loss scale: 262144.0 |
time (ms) | total time: 605.04 | forward: 228.56 | backward: 368.22 | allreduce: 9.43 | optimizer: 5.38 | bias in backward: 5.95 | dropout in backward: 11.99
 iteration       94/     100 | elapsed time per iteration (ms): 604.1 | learning rate: 7.980E-07 | lm loss: 1.048741E+01 | sop loss: 7.371373E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.77 | forward: 227.43 | backward: 367.97 | allreduce: 9.32 | optimizer: 5.37 | bias in backward: 6.00 | dropout in backward: 11.98
 iteration       95/     100 | elapsed time per iteration (ms): 603.2 | learning rate: 8.081E-07 | lm loss: 1.049504E+01 | sop loss: 7.161381E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.85 | forward: 227.40 | backward: 367.31 | allreduce: 9.34 | optimizer: 5.35 | bias in backward: 6.03 | dropout in backward: 11.99
 iteration       96/     100 | elapsed time per iteration (ms): 627.8 | learning rate: 8.182E-07 | lm loss: 1.049290E+01 | sop loss: 7.744985E-01 | loss scale: 262144.0 |
time (ms) | total time: 627.39 | forward: 227.85 | backward: 391.30 | allreduce: 33.20 | optimizer: 5.36 | bias in backward: 6.34 | dropout in backward: 11.99
 iteration       97/     100 | elapsed time per iteration (ms): 603.7 | learning rate: 8.283E-07 | lm loss: 1.047975E+01 | sop loss: 6.507065E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.30 | forward: 227.34 | backward: 367.77 | allreduce: 8.98 | optimizer: 5.41 | bias in backward: 5.96 | dropout in backward: 12.07
 iteration       98/     100 | elapsed time per iteration (ms): 603.9 | learning rate: 8.384E-07 | lm loss: 1.048602E+01 | sop loss: 7.489393E-01 | loss scale: 262144.0 |
time (ms) | total time: 603.51 | forward: 227.54 | backward: 367.63 | allreduce: 9.16 | optimizer: 5.40 | bias in backward: 6.02 | dropout in backward: 11.96
 iteration       99/     100 | elapsed time per iteration (ms): 628.8 | learning rate: 8.485E-07 | lm loss: 1.046086E+01 | sop loss: 7.306148E-01 | loss scale: 262144.0 |
time (ms) | total time: 628.38 | forward: 227.73 | backward: 392.25 | allreduce: 9.39 | optimizer: 5.40 | bias in backward: 6.03 | dropout in backward: 11.98
 iteration      100/     100 | elapsed time per iteration (ms): 602.6 | learning rate: 8.586E-07 | lm loss: 1.046676E+01 | sop loss: 7.021841E-01 | loss scale: 262144.0 |
time (ms) | total time: 602.24 | forward: 227.57 | backward: 366.43 | allreduce: 9.39 | optimizer: 5.36 | bias in backward: 5.94 | dropout in backward: 11.96
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

128

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.098448 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_12800mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.004 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_12800mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_12800mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 13773
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3562.91 | train/valid/test data iterators: 2500.99
training ...
