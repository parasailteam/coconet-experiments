
1

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.138983 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_100mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_100mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_100mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3533.67 | train/valid/test data iterators: 2352.01
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 2255.3 | learning rate: 0.000E+00 | lm loss: 1.064787E+01 | sop loss: 6.328852E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 686.59228515625 | max allocated: 1061.9423828125 | cached: 1242.0 | max cached: 1242.0
time (ms) | total time: 2255.11 | forward: 1924.85 | backward: 316.81 | allreduce: 12.55 | optimizer: 0.05 | bias in backward: 2.27 | dropout in backward: 1.73
 iteration        2/     100 | elapsed time per iteration (ms): 104.3 | learning rate: 0.000E+00 | lm loss: 1.051176E+01 | sop loss: 7.948946E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 102.67 | forward: 55.60 | backward: 45.34 | allreduce: 9.01 | optimizer: 0.04 | bias in backward: 2.27 | dropout in backward: 1.73
 iteration        3/     100 | elapsed time per iteration (ms): 83.1 | learning rate: 0.000E+00 | lm loss: 1.067548E+01 | sop loss: 8.174582E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 82.79 | forward: 32.43 | backward: 48.51 | allreduce: 8.95 | optimizer: 0.04 | bias in backward: 2.46 | dropout in backward: 1.99
 iteration        4/     100 | elapsed time per iteration (ms): 82.5 | learning rate: 0.000E+00 | lm loss: 1.036485E+01 | sop loss: 7.583328E-01 | loss scale: 536870912.0 |
time (ms) | total time: 82.20 | forward: 35.32 | backward: 45.07 | allreduce: 8.82 | optimizer: 0.04 | bias in backward: 2.32 | dropout in backward: 1.73
 iteration        5/     100 | elapsed time per iteration (ms): 80.5 | learning rate: 0.000E+00 | lm loss: 1.110780E+01 | sop loss: 6.209034E-01 | loss scale: 268435456.0 |
time (ms) | total time: 80.20 | forward: 33.53 | backward: 44.98 | allreduce: 8.82 | optimizer: 0.03 | bias in backward: 2.28 | dropout in backward: 1.71
 iteration        6/     100 | elapsed time per iteration (ms): 79.7 | learning rate: 0.000E+00 | lm loss: 1.052962E+01 | sop loss: 4.100540E-01 | loss scale: 134217728.0 |
time (ms) | total time: 79.46 | forward: 32.71 | backward: 45.10 | allreduce: 8.73 | optimizer: 0.03 | bias in backward: 2.28 | dropout in backward: 1.74
 iteration        7/     100 | elapsed time per iteration (ms): 80.8 | learning rate: 0.000E+00 | lm loss: 1.062332E+01 | sop loss: 8.568311E-01 | loss scale: 67108864.0 |
time (ms) | total time: 80.50 | forward: 33.50 | backward: 45.29 | allreduce: 8.91 | optimizer: 0.03 | bias in backward: 2.26 | dropout in backward: 1.71
 iteration        8/     100 | elapsed time per iteration (ms): 78.7 | learning rate: 0.000E+00 | lm loss: 1.051886E+01 | sop loss: 7.480426E-01 | loss scale: 33554432.0 |
time (ms) | total time: 78.46 | forward: 32.06 | backward: 44.76 | allreduce: 8.77 | optimizer: 0.03 | bias in backward: 2.31 | dropout in backward: 1.76
 iteration        9/     100 | elapsed time per iteration (ms): 78.5 | learning rate: 0.000E+00 | lm loss: 1.068060E+01 | sop loss: 9.669122E-01 | loss scale: 16777216.0 |
time (ms) | total time: 78.20 | forward: 31.96 | backward: 44.65 | allreduce: 8.75 | optimizer: 0.03 | bias in backward: 2.26 | dropout in backward: 1.70
 iteration       10/     100 | elapsed time per iteration (ms): 80.8 | learning rate: 0.000E+00 | lm loss: 1.034388E+01 | sop loss: 9.711921E-01 | loss scale: 8388608.0 |
time (ms) | total time: 80.53 | forward: 33.47 | backward: 45.39 | allreduce: 8.93 | optimizer: 0.03 | bias in backward: 2.28 | dropout in backward: 1.72
 iteration       11/     100 | elapsed time per iteration (ms): 78.8 | learning rate: 0.000E+00 | lm loss: 1.048812E+01 | sop loss: 8.385332E-01 | loss scale: 4194304.0 |
time (ms) | total time: 78.51 | forward: 32.36 | backward: 44.50 | allreduce: 8.94 | optimizer: 0.03 | bias in backward: 2.28 | dropout in backward: 1.74
 iteration       12/     100 | elapsed time per iteration (ms): 78.6 | learning rate: 0.000E+00 | lm loss: 1.048792E+01 | sop loss: 8.921309E-01 | loss scale: 2097152.0 |
time (ms) | total time: 78.35 | forward: 32.40 | backward: 44.36 | allreduce: 8.80 | optimizer: 0.03 | bias in backward: 2.27 | dropout in backward: 1.70
 iteration       13/     100 | elapsed time per iteration (ms): 78.2 | learning rate: 0.000E+00 | lm loss: 1.076807E+01 | sop loss: 8.573317E-01 | loss scale: 1048576.0 |
time (ms) | total time: 77.90 | forward: 32.04 | backward: 44.26 | allreduce: 8.77 | optimizer: 0.03 | bias in backward: 2.28 | dropout in backward: 1.71
 iteration       14/     100 | elapsed time per iteration (ms): 79.3 | learning rate: 0.000E+00 | lm loss: 1.061292E+01 | sop loss: 7.063559E-01 | loss scale: 524288.0 |
time (ms) | total time: 79.01 | forward: 32.51 | backward: 44.91 | allreduce: 8.76 | optimizer: 0.03 | bias in backward: 2.26 | dropout in backward: 1.70
 iteration       15/     100 | elapsed time per iteration (ms): 78.5 | learning rate: 0.000E+00 | lm loss: 1.049009E+01 | sop loss: 8.319409E-01 | loss scale: 262144.0 |
time (ms) | total time: 78.29 | forward: 31.90 | backward: 44.69 | allreduce: 8.75 | optimizer: 0.03 | bias in backward: 2.28 | dropout in backward: 1.71
 iteration       16/     100 | elapsed time per iteration (ms): 79.0 | learning rate: 0.000E+00 | lm loss: 1.044565E+01 | sop loss: 6.813765E-01 | loss scale: 131072.0 |
time (ms) | total time: 78.74 | forward: 32.54 | backward: 44.62 | allreduce: 8.76 | optimizer: 0.03 | bias in backward: 2.33 | dropout in backward: 1.71
 iteration       17/     100 | elapsed time per iteration (ms): 79.0 | learning rate: 0.000E+00 | lm loss: 1.051586E+01 | sop loss: 6.569613E-01 | loss scale: 65536.0 |
time (ms) | total time: 78.73 | forward: 31.89 | backward: 45.22 | allreduce: 8.76 | optimizer: 0.04 | bias in backward: 2.38 | dropout in backward: 1.75
 iteration       18/     100 | elapsed time per iteration (ms): 243.3 | learning rate: 1.010E-08 | lm loss: 1.042056E+01 | sop loss: 7.122471E-01 | loss scale: 65536.0 |
time (ms) | total time: 242.95 | forward: 32.77 | backward: 82.83 | allreduce: 8.83 | optimizer: 125.62 | bias in backward: 2.27 | dropout in backward: 1.70
 iteration       19/     100 | elapsed time per iteration (ms): 272.5 | learning rate: 1.010E-08 | lm loss: 1.039176E+01 | sop loss: 9.280131E-01 | loss scale: 32768.0 |
time (ms) | total time: 272.25 | forward: 205.76 | backward: 64.59 | allreduce: 12.27 | optimizer: 0.03 | bias in backward: 2.30 | dropout in backward: 1.72
 iteration       20/     100 | elapsed time per iteration (ms): 123.8 | learning rate: 2.020E-08 | lm loss: 1.040948E+01 | sop loss: 6.005548E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.50 | forward: 33.64 | backward: 82.75 | allreduce: 8.83 | optimizer: 5.32 | bias in backward: 2.34 | dropout in backward: 1.77
 iteration       21/     100 | elapsed time per iteration (ms): 131.6 | learning rate: 3.030E-08 | lm loss: 1.024970E+01 | sop loss: 7.907515E-01 | loss scale: 32768.0 |
time (ms) | total time: 131.34 | forward: 39.52 | backward: 84.41 | allreduce: 8.94 | optimizer: 5.34 | bias in backward: 2.26 | dropout in backward: 1.71
 iteration       22/     100 | elapsed time per iteration (ms): 124.1 | learning rate: 4.040E-08 | lm loss: 1.045164E+01 | sop loss: 5.767415E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.78 | forward: 33.38 | backward: 83.27 | allreduce: 8.93 | optimizer: 5.32 | bias in backward: 2.29 | dropout in backward: 1.70
 iteration       23/     100 | elapsed time per iteration (ms): 128.3 | learning rate: 5.051E-08 | lm loss: 1.090982E+01 | sop loss: 7.325919E-01 | loss scale: 32768.0 |
time (ms) | total time: 128.00 | forward: 37.68 | backward: 83.07 | allreduce: 8.95 | optimizer: 5.29 | bias in backward: 2.27 | dropout in backward: 1.71
 iteration       24/     100 | elapsed time per iteration (ms): 123.4 | learning rate: 6.061E-08 | lm loss: 1.050529E+01 | sop loss: 8.097107E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.16 | forward: 33.14 | backward: 82.96 | allreduce: 8.77 | optimizer: 5.28 | bias in backward: 2.26 | dropout in backward: 1.70
 iteration       25/     100 | elapsed time per iteration (ms): 125.9 | learning rate: 7.071E-08 | lm loss: 1.053330E+01 | sop loss: 4.648388E-01 | loss scale: 32768.0 |
time (ms) | total time: 125.59 | forward: 35.00 | backward: 83.21 | allreduce: 8.76 | optimizer: 5.30 | bias in backward: 2.25 | dropout in backward: 1.70
 iteration       26/     100 | elapsed time per iteration (ms): 123.9 | learning rate: 8.081E-08 | lm loss: 1.050300E+01 | sop loss: 7.947189E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.62 | forward: 33.16 | backward: 83.43 | allreduce: 8.87 | optimizer: 5.31 | bias in backward: 2.27 | dropout in backward: 1.70
 iteration       27/     100 | elapsed time per iteration (ms): 123.5 | learning rate: 9.091E-08 | lm loss: 1.069478E+01 | sop loss: 7.032071E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.25 | forward: 33.08 | backward: 82.73 | allreduce: 8.72 | optimizer: 5.29 | bias in backward: 2.27 | dropout in backward: 1.71
 iteration       28/     100 | elapsed time per iteration (ms): 122.7 | learning rate: 1.010E-07 | lm loss: 1.053793E+01 | sop loss: 6.888078E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.41 | forward: 32.62 | backward: 82.94 | allreduce: 8.76 | optimizer: 5.28 | bias in backward: 2.26 | dropout in backward: 1.70
 iteration       29/     100 | elapsed time per iteration (ms): 135.1 | learning rate: 1.111E-07 | lm loss: 1.055501E+01 | sop loss: 5.305468E-01 | loss scale: 32768.0 |
time (ms) | total time: 134.87 | forward: 45.11 | backward: 82.57 | allreduce: 8.75 | optimizer: 5.27 | bias in backward: 2.27 | dropout in backward: 1.71
 iteration       30/     100 | elapsed time per iteration (ms): 122.6 | learning rate: 1.212E-07 | lm loss: 1.063960E+01 | sop loss: 7.911518E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.36 | forward: 32.53 | backward: 82.77 | allreduce: 8.85 | optimizer: 5.28 | bias in backward: 2.28 | dropout in backward: 1.70
 iteration       31/     100 | elapsed time per iteration (ms): 128.8 | learning rate: 1.313E-07 | lm loss: 1.081037E+01 | sop loss: 7.231245E-01 | loss scale: 32768.0 |
time (ms) | total time: 128.57 | forward: 37.85 | backward: 83.44 | allreduce: 8.95 | optimizer: 5.32 | bias in backward: 2.27 | dropout in backward: 1.71
 iteration       32/     100 | elapsed time per iteration (ms): 122.6 | learning rate: 1.414E-07 | lm loss: 1.047011E+01 | sop loss: 9.132491E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.32 | forward: 32.63 | backward: 82.67 | allreduce: 8.77 | optimizer: 5.26 | bias in backward: 2.26 | dropout in backward: 1.70
 iteration       33/     100 | elapsed time per iteration (ms): 135.7 | learning rate: 1.515E-07 | lm loss: 1.056787E+01 | sop loss: 1.061669E+00 | loss scale: 32768.0 |
time (ms) | total time: 135.48 | forward: 45.37 | backward: 82.82 | allreduce: 8.77 | optimizer: 5.28 | bias in backward: 2.26 | dropout in backward: 1.74
 iteration       34/     100 | elapsed time per iteration (ms): 123.7 | learning rate: 1.616E-07 | lm loss: 1.044936E+01 | sop loss: 8.360453E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.45 | forward: 32.33 | backward: 84.02 | allreduce: 8.86 | optimizer: 5.30 | bias in backward: 2.42 | dropout in backward: 1.71
 iteration       35/     100 | elapsed time per iteration (ms): 135.9 | learning rate: 1.717E-07 | lm loss: 1.014760E+01 | sop loss: 5.896873E-01 | loss scale: 32768.0 |
time (ms) | total time: 135.64 | forward: 45.84 | backward: 82.45 | allreduce: 8.79 | optimizer: 5.30 | bias in backward: 2.27 | dropout in backward: 1.74
 iteration       36/     100 | elapsed time per iteration (ms): 122.3 | learning rate: 1.818E-07 | lm loss: 1.029967E+01 | sop loss: 7.135150E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.04 | forward: 32.84 | backward: 82.20 | allreduce: 8.73 | optimizer: 5.27 | bias in backward: 2.31 | dropout in backward: 1.70
 iteration       37/     100 | elapsed time per iteration (ms): 123.8 | learning rate: 1.919E-07 | lm loss: 1.036848E+01 | sop loss: 5.547453E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.55 | forward: 33.21 | backward: 83.08 | allreduce: 8.73 | optimizer: 5.29 | bias in backward: 2.27 | dropout in backward: 1.71
 iteration       38/     100 | elapsed time per iteration (ms): 131.8 | learning rate: 2.020E-07 | lm loss: 1.048691E+01 | sop loss: 7.511009E-01 | loss scale: 32768.0 |
time (ms) | total time: 131.56 | forward: 35.08 | backward: 89.40 | allreduce: 8.90 | optimizer: 5.31 | bias in backward: 2.28 | dropout in backward: 1.71
 iteration       39/     100 | elapsed time per iteration (ms): 127.1 | learning rate: 2.121E-07 | lm loss: 1.063091E+01 | sop loss: 6.173958E-01 | loss scale: 32768.0 |
time (ms) | total time: 126.78 | forward: 35.70 | backward: 83.61 | allreduce: 8.71 | optimizer: 5.30 | bias in backward: 2.27 | dropout in backward: 1.72
 iteration       40/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 2.222E-07 | lm loss: 1.052308E+01 | sop loss: 9.222667E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.80 | forward: 32.90 | backward: 83.04 | allreduce: 8.74 | optimizer: 5.30 | bias in backward: 2.28 | dropout in backward: 1.71
 iteration       41/     100 | elapsed time per iteration (ms): 123.7 | learning rate: 2.323E-07 | lm loss: 1.062551E+01 | sop loss: 6.979346E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.40 | forward: 32.76 | backward: 83.41 | allreduce: 8.74 | optimizer: 5.26 | bias in backward: 2.27 | dropout in backward: 1.72
 iteration       42/     100 | elapsed time per iteration (ms): 124.6 | learning rate: 2.424E-07 | lm loss: 1.058609E+01 | sop loss: 5.260258E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.31 | forward: 33.00 | backward: 84.08 | allreduce: 8.90 | optimizer: 5.32 | bias in backward: 2.27 | dropout in backward: 1.71
 iteration       43/     100 | elapsed time per iteration (ms): 139.0 | learning rate: 2.525E-07 | lm loss: 1.053797E+01 | sop loss: 4.783782E-01 | loss scale: 32768.0 |
time (ms) | total time: 138.71 | forward: 46.05 | backward: 84.80 | allreduce: 9.06 | optimizer: 5.34 | bias in backward: 2.29 | dropout in backward: 1.71
 iteration       44/     100 | elapsed time per iteration (ms): 127.2 | learning rate: 2.626E-07 | lm loss: 1.046699E+01 | sop loss: 5.397537E-01 | loss scale: 32768.0 |
time (ms) | total time: 126.93 | forward: 33.93 | backward: 85.49 | allreduce: 9.36 | optimizer: 5.35 | bias in backward: 2.28 | dropout in backward: 1.72
 iteration       45/     100 | elapsed time per iteration (ms): 127.2 | learning rate: 2.727E-07 | lm loss: 1.003601E+01 | sop loss: 7.259796E-01 | loss scale: 32768.0 |
time (ms) | total time: 126.92 | forward: 34.73 | backward: 84.30 | allreduce: 9.08 | optimizer: 5.33 | bias in backward: 2.29 | dropout in backward: 1.71
 iteration       46/     100 | elapsed time per iteration (ms): 125.3 | learning rate: 2.828E-07 | lm loss: 1.122674E+01 | sop loss: 9.079229E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.96 | forward: 33.53 | backward: 83.89 | allreduce: 8.95 | optimizer: 5.32 | bias in backward: 2.27 | dropout in backward: 1.71
 iteration       47/     100 | elapsed time per iteration (ms): 128.2 | learning rate: 2.929E-07 | lm loss: 1.030799E+01 | sop loss: 6.993922E-01 | loss scale: 32768.0 |
time (ms) | total time: 127.91 | forward: 36.59 | backward: 83.86 | allreduce: 8.93 | optimizer: 5.29 | bias in backward: 2.29 | dropout in backward: 1.73
 iteration       48/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 3.030E-07 | lm loss: 1.059259E+01 | sop loss: 7.579232E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.79 | forward: 32.80 | backward: 82.94 | allreduce: 8.80 | optimizer: 5.29 | bias in backward: 2.28 | dropout in backward: 1.70
 iteration       49/     100 | elapsed time per iteration (ms): 135.3 | learning rate: 3.131E-07 | lm loss: 1.044118E+01 | sop loss: 3.683690E-01 | loss scale: 32768.0 |
time (ms) | total time: 134.99 | forward: 44.52 | backward: 83.18 | allreduce: 8.73 | optimizer: 5.29 | bias in backward: 2.32 | dropout in backward: 1.77
 iteration       50/     100 | elapsed time per iteration (ms): 123.7 | learning rate: 3.232E-07 | lm loss: 1.042728E+01 | sop loss: 8.573273E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.42 | forward: 32.94 | backward: 83.38 | allreduce: 8.78 | optimizer: 5.31 | bias in backward: 2.28 | dropout in backward: 1.72
 iteration       51/     100 | elapsed time per iteration (ms): 125.0 | learning rate: 3.333E-07 | lm loss: 1.036796E+01 | sop loss: 5.064732E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.76 | forward: 34.02 | backward: 83.39 | allreduce: 8.79 | optimizer: 5.29 | bias in backward: 2.31 | dropout in backward: 1.73
 iteration       52/     100 | elapsed time per iteration (ms): 124.7 | learning rate: 3.434E-07 | lm loss: 1.056257E+01 | sop loss: 7.038237E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.44 | forward: 33.45 | backward: 83.91 | allreduce: 8.85 | optimizer: 5.31 | bias in backward: 2.32 | dropout in backward: 1.72
 iteration       53/     100 | elapsed time per iteration (ms): 136.0 | learning rate: 3.535E-07 | lm loss: 1.042577E+01 | sop loss: 1.166255E+00 | loss scale: 32768.0 |
time (ms) | total time: 135.77 | forward: 45.63 | backward: 82.75 | allreduce: 8.76 | optimizer: 5.30 | bias in backward: 2.30 | dropout in backward: 1.75
 iteration       54/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 3.636E-07 | lm loss: 1.050457E+01 | sop loss: 6.926590E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.86 | forward: 32.75 | backward: 83.00 | allreduce: 8.81 | optimizer: 5.28 | bias in backward: 2.28 | dropout in backward: 1.73
 iteration       55/     100 | elapsed time per iteration (ms): 136.4 | learning rate: 3.737E-07 | lm loss: 1.064746E+01 | sop loss: 6.966935E-01 | loss scale: 32768.0 |
time (ms) | total time: 136.15 | forward: 45.26 | backward: 83.51 | allreduce: 8.79 | optimizer: 5.31 | bias in backward: 2.31 | dropout in backward: 1.71
 iteration       56/     100 | elapsed time per iteration (ms): 125.2 | learning rate: 3.838E-07 | lm loss: 1.086050E+01 | sop loss: 7.819778E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.92 | forward: 33.45 | backward: 84.32 | allreduce: 8.93 | optimizer: 5.31 | bias in backward: 2.29 | dropout in backward: 1.71
 iteration       57/     100 | elapsed time per iteration (ms): 124.0 | learning rate: 3.939E-07 | lm loss: 1.052010E+01 | sop loss: 6.319126E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.73 | forward: 33.69 | backward: 82.63 | allreduce: 8.79 | optimizer: 5.32 | bias in backward: 2.27 | dropout in backward: 1.71
 iteration       58/     100 | elapsed time per iteration (ms): 123.2 | learning rate: 4.040E-07 | lm loss: 1.049359E+01 | sop loss: 6.910741E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.96 | forward: 32.83 | backward: 83.10 | allreduce: 8.76 | optimizer: 5.28 | bias in backward: 2.29 | dropout in backward: 1.72
 iteration       59/     100 | elapsed time per iteration (ms): 136.2 | learning rate: 4.141E-07 | lm loss: 1.036079E+01 | sop loss: 9.291022E-01 | loss scale: 32768.0 |
time (ms) | total time: 135.88 | forward: 45.56 | backward: 83.00 | allreduce: 8.76 | optimizer: 5.30 | bias in backward: 2.30 | dropout in backward: 1.72
 iteration       60/     100 | elapsed time per iteration (ms): 122.6 | learning rate: 4.242E-07 | lm loss: 1.041930E+01 | sop loss: 7.731372E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.36 | forward: 32.81 | backward: 82.56 | allreduce: 8.74 | optimizer: 5.29 | bias in backward: 2.28 | dropout in backward: 1.71
 iteration       61/     100 | elapsed time per iteration (ms): 128.1 | learning rate: 4.343E-07 | lm loss: 1.049886E+01 | sop loss: 8.059224E-01 | loss scale: 32768.0 |
time (ms) | total time: 127.88 | forward: 36.93 | backward: 83.69 | allreduce: 8.88 | optimizer: 5.31 | bias in backward: 2.27 | dropout in backward: 1.70
 iteration       62/     100 | elapsed time per iteration (ms): 122.3 | learning rate: 4.444E-07 | lm loss: 1.050521E+01 | sop loss: 5.956386E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.01 | forward: 31.99 | backward: 82.94 | allreduce: 8.72 | optimizer: 5.28 | bias in backward: 2.26 | dropout in backward: 1.71
 iteration       63/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 4.545E-07 | lm loss: 1.045741E+01 | sop loss: 6.039652E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.79 | forward: 33.10 | backward: 82.39 | allreduce: 8.79 | optimizer: 5.30 | bias in backward: 2.28 | dropout in backward: 1.72
 iteration       64/     100 | elapsed time per iteration (ms): 122.1 | learning rate: 4.646E-07 | lm loss: 1.048507E+01 | sop loss: 6.566674E-01 | loss scale: 32768.0 |
time (ms) | total time: 121.87 | forward: 32.33 | backward: 82.53 | allreduce: 8.77 | optimizer: 5.30 | bias in backward: 2.28 | dropout in backward: 1.70
 iteration       65/     100 | elapsed time per iteration (ms): 137.1 | learning rate: 4.747E-07 | lm loss: 1.040469E+01 | sop loss: 6.421749E-01 | loss scale: 32768.0 |
time (ms) | total time: 136.88 | forward: 44.96 | backward: 84.67 | allreduce: 8.94 | optimizer: 5.29 | bias in backward: 2.44 | dropout in backward: 1.81
 iteration       66/     100 | elapsed time per iteration (ms): 122.8 | learning rate: 4.848E-07 | lm loss: 1.085717E+01 | sop loss: 7.053360E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.50 | forward: 32.07 | backward: 83.45 | allreduce: 8.81 | optimizer: 5.28 | bias in backward: 2.29 | dropout in backward: 1.73
 iteration       67/     100 | elapsed time per iteration (ms): 126.8 | learning rate: 4.949E-07 | lm loss: 1.052882E+01 | sop loss: 6.738964E-01 | loss scale: 32768.0 |
time (ms) | total time: 126.53 | forward: 35.47 | backward: 83.77 | allreduce: 8.79 | optimizer: 5.29 | bias in backward: 2.29 | dropout in backward: 1.75
 iteration       68/     100 | elapsed time per iteration (ms): 122.7 | learning rate: 5.051E-07 | lm loss: 1.021805E+01 | sop loss: 7.844306E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.42 | forward: 32.47 | backward: 82.96 | allreduce: 8.79 | optimizer: 5.29 | bias in backward: 2.27 | dropout in backward: 1.71
 iteration       69/     100 | elapsed time per iteration (ms): 124.6 | learning rate: 5.152E-07 | lm loss: 1.038727E+01 | sop loss: 5.525445E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.29 | forward: 34.17 | backward: 82.96 | allreduce: 8.86 | optimizer: 5.28 | bias in backward: 2.27 | dropout in backward: 1.72
 iteration       70/     100 | elapsed time per iteration (ms): 122.9 | learning rate: 5.253E-07 | lm loss: 1.051685E+01 | sop loss: 6.400120E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.60 | forward: 33.37 | backward: 82.17 | allreduce: 8.88 | optimizer: 5.28 | bias in backward: 2.26 | dropout in backward: 1.70
 iteration       71/     100 | elapsed time per iteration (ms): 135.3 | learning rate: 5.354E-07 | lm loss: 1.052264E+01 | sop loss: 5.725930E-01 | loss scale: 32768.0 |
time (ms) | total time: 135.00 | forward: 45.39 | backward: 82.33 | allreduce: 8.76 | optimizer: 5.28 | bias in backward: 2.27 | dropout in backward: 1.69
 iteration       72/     100 | elapsed time per iteration (ms): 122.4 | learning rate: 5.455E-07 | lm loss: 1.041500E+01 | sop loss: 7.021827E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.13 | forward: 31.98 | backward: 83.18 | allreduce: 8.72 | optimizer: 5.28 | bias in backward: 2.26 | dropout in backward: 1.70
 iteration       73/     100 | elapsed time per iteration (ms): 135.7 | learning rate: 5.556E-07 | lm loss: 1.075436E+01 | sop loss: 7.919195E-01 | loss scale: 32768.0 |
time (ms) | total time: 135.48 | forward: 45.24 | backward: 83.04 | allreduce: 8.83 | optimizer: 5.29 | bias in backward: 2.30 | dropout in backward: 1.72
 iteration       74/     100 | elapsed time per iteration (ms): 123.0 | learning rate: 5.657E-07 | lm loss: 9.921457E+00 | sop loss: 1.024162E+00 | loss scale: 32768.0 |
time (ms) | total time: 122.75 | forward: 32.26 | backward: 83.51 | allreduce: 8.73 | optimizer: 5.29 | bias in backward: 2.25 | dropout in backward: 1.70
 iteration       75/     100 | elapsed time per iteration (ms): 135.8 | learning rate: 5.758E-07 | lm loss: 1.048405E+01 | sop loss: 9.657400E-01 | loss scale: 32768.0 |
time (ms) | total time: 135.50 | forward: 45.53 | backward: 82.68 | allreduce: 8.71 | optimizer: 5.30 | bias in backward: 2.27 | dropout in backward: 1.70
 iteration       76/     100 | elapsed time per iteration (ms): 121.6 | learning rate: 5.859E-07 | lm loss: 1.034192E+01 | sop loss: 5.954742E-01 | loss scale: 32768.0 |
time (ms) | total time: 121.38 | forward: 32.00 | backward: 82.37 | allreduce: 8.75 | optimizer: 5.29 | bias in backward: 2.26 | dropout in backward: 1.70
 iteration       77/     100 | elapsed time per iteration (ms): 122.6 | learning rate: 5.960E-07 | lm loss: 1.030099E+01 | sop loss: 2.763395E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.33 | forward: 32.37 | backward: 82.66 | allreduce: 8.75 | optimizer: 5.28 | bias in backward: 2.32 | dropout in backward: 1.69
 iteration       78/     100 | elapsed time per iteration (ms): 122.1 | learning rate: 6.061E-07 | lm loss: 1.035822E+01 | sop loss: 9.218255E-01 | loss scale: 32768.0 |
time (ms) | total time: 121.89 | forward: 32.15 | backward: 82.67 | allreduce: 8.72 | optimizer: 5.28 | bias in backward: 2.27 | dropout in backward: 1.70
 iteration       79/     100 | elapsed time per iteration (ms): 124.0 | learning rate: 6.162E-07 | lm loss: 1.048729E+01 | sop loss: 6.221889E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.76 | forward: 34.03 | backward: 82.49 | allreduce: 8.73 | optimizer: 5.30 | bias in backward: 2.28 | dropout in backward: 1.70
 iteration       80/     100 | elapsed time per iteration (ms): 121.4 | learning rate: 6.263E-07 | lm loss: 1.020750E+01 | sop loss: 6.376852E-01 | loss scale: 32768.0 |
time (ms) | total time: 121.11 | forward: 31.90 | backward: 82.25 | allreduce: 8.71 | optimizer: 5.27 | bias in backward: 2.27 | dropout in backward: 1.73
 iteration       81/     100 | elapsed time per iteration (ms): 129.1 | learning rate: 6.364E-07 | lm loss: 1.016388E+01 | sop loss: 7.328455E-01 | loss scale: 32768.0 |
time (ms) | total time: 128.81 | forward: 37.40 | backward: 83.86 | allreduce: 9.02 | optimizer: 5.34 | bias in backward: 2.27 | dropout in backward: 1.70
 iteration       82/     100 | elapsed time per iteration (ms): 123.3 | learning rate: 6.465E-07 | lm loss: 1.042656E+01 | sop loss: 4.830369E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.98 | forward: 32.64 | backward: 83.17 | allreduce: 8.79 | optimizer: 5.30 | bias in backward: 2.25 | dropout in backward: 1.69
 iteration       83/     100 | elapsed time per iteration (ms): 126.7 | learning rate: 6.566E-07 | lm loss: 1.041533E+01 | sop loss: 7.580125E-01 | loss scale: 32768.0 |
time (ms) | total time: 126.43 | forward: 36.25 | backward: 82.88 | allreduce: 8.82 | optimizer: 5.28 | bias in backward: 2.27 | dropout in backward: 1.71
 iteration       84/     100 | elapsed time per iteration (ms): 122.3 | learning rate: 6.667E-07 | lm loss: 1.016939E+01 | sop loss: 7.085534E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.06 | forward: 32.43 | backward: 82.62 | allreduce: 8.73 | optimizer: 5.27 | bias in backward: 2.27 | dropout in backward: 1.74
 iteration       85/     100 | elapsed time per iteration (ms): 127.8 | learning rate: 6.768E-07 | lm loss: 1.046005E+01 | sop loss: 5.025075E-01 | loss scale: 32768.0 |
time (ms) | total time: 127.52 | forward: 35.84 | backward: 84.39 | allreduce: 8.86 | optimizer: 5.31 | bias in backward: 2.42 | dropout in backward: 1.74
 iteration       86/     100 | elapsed time per iteration (ms): 122.5 | learning rate: 6.869E-07 | lm loss: 1.065670E+01 | sop loss: 7.847624E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.22 | forward: 32.34 | backward: 82.67 | allreduce: 8.75 | optimizer: 5.32 | bias in backward: 2.24 | dropout in backward: 1.70
 iteration       87/     100 | elapsed time per iteration (ms): 125.6 | learning rate: 6.970E-07 | lm loss: 1.034259E+01 | sop loss: 8.527714E-01 | loss scale: 32768.0 |
time (ms) | total time: 125.32 | forward: 34.03 | backward: 83.66 | allreduce: 9.15 | optimizer: 5.33 | bias in backward: 2.27 | dropout in backward: 1.69
 iteration       88/     100 | elapsed time per iteration (ms): 124.6 | learning rate: 7.071E-07 | lm loss: 1.004340E+01 | sop loss: 1.118217E+00 | loss scale: 32768.0 |
time (ms) | total time: 124.34 | forward: 32.84 | backward: 84.02 | allreduce: 8.97 | optimizer: 5.33 | bias in backward: 2.27 | dropout in backward: 1.70
 iteration       89/     100 | elapsed time per iteration (ms): 127.5 | learning rate: 7.172E-07 | lm loss: 1.024580E+01 | sop loss: 4.494659E-01 | loss scale: 32768.0 |
time (ms) | total time: 127.23 | forward: 35.25 | backward: 84.21 | allreduce: 9.18 | optimizer: 5.33 | bias in backward: 2.30 | dropout in backward: 1.70
 iteration       90/     100 | elapsed time per iteration (ms): 124.4 | learning rate: 7.273E-07 | lm loss: 1.049074E+01 | sop loss: 5.641385E-01 | loss scale: 32768.0 |
time (ms) | total time: 124.12 | forward: 32.92 | backward: 83.79 | allreduce: 9.06 | optimizer: 5.32 | bias in backward: 2.26 | dropout in backward: 1.70
 iteration       91/     100 | elapsed time per iteration (ms): 137.1 | learning rate: 7.374E-07 | lm loss: 1.022953E+01 | sop loss: 7.253575E-01 | loss scale: 32768.0 |
time (ms) | total time: 136.86 | forward: 45.34 | backward: 83.96 | allreduce: 8.99 | optimizer: 5.31 | bias in backward: 2.29 | dropout in backward: 1.71
 iteration       92/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 7.475E-07 | lm loss: 1.042272E+01 | sop loss: 4.947908E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.84 | forward: 32.43 | backward: 83.33 | allreduce: 8.78 | optimizer: 5.29 | bias in backward: 2.30 | dropout in backward: 1.72
 iteration       93/     100 | elapsed time per iteration (ms): 123.8 | learning rate: 7.576E-07 | lm loss: 1.039882E+01 | sop loss: 8.847111E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.54 | forward: 32.90 | backward: 83.33 | allreduce: 8.80 | optimizer: 5.30 | bias in backward: 2.28 | dropout in backward: 1.71
 iteration       94/     100 | elapsed time per iteration (ms): 123.8 | learning rate: 7.677E-07 | lm loss: 1.028391E+01 | sop loss: 3.633572E-01 | loss scale: 32768.0 |
time (ms) | total time: 123.53 | forward: 32.34 | backward: 84.08 | allreduce: 8.88 | optimizer: 5.28 | bias in backward: 2.27 | dropout in backward: 1.71
 iteration       95/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 7.778E-07 | lm loss: 1.028612E+01 | sop loss: 6.446837E-01 | loss scale: 32768.0 |
time (ms) | total time: 122.81 | forward: 32.63 | backward: 82.91 | allreduce: 8.75 | optimizer: 5.28 | bias in backward: 2.29 | dropout in backward: 1.70
 iteration       96/     100 | elapsed time per iteration (ms): 147.9 | learning rate: 7.879E-07 | lm loss: 1.022181E+01 | sop loss: 7.101038E-01 | loss scale: 32768.0 |
time (ms) | total time: 147.53 | forward: 32.12 | backward: 108.13 | allreduce: 34.42 | optimizer: 5.30 | bias in backward: 2.26 | dropout in backward: 1.71
 iteration       97/     100 | elapsed time per iteration (ms): 125.5 | learning rate: 7.980E-07 | lm loss: 1.070045E+01 | sop loss: 1.110590E+00 | loss scale: 32768.0 |
time (ms) | total time: 125.18 | forward: 35.02 | backward: 82.80 | allreduce: 8.79 | optimizer: 5.27 | bias in backward: 2.30 | dropout in backward: 1.73
 iteration       98/     100 | elapsed time per iteration (ms): 125.8 | learning rate: 8.081E-07 | lm loss: 1.033866E+01 | sop loss: 1.124142E+00 | loss scale: 32768.0 |
time (ms) | total time: 125.50 | forward: 33.00 | backward: 85.43 | allreduce: 8.88 | optimizer: 5.30 | bias in backward: 2.28 | dropout in backward: 1.73
 iteration       99/     100 | elapsed time per iteration (ms): 134.0 | learning rate: 8.081E-07 | lm loss: 1.069351E+01 | sop loss: 1.127936E+00 | loss scale: 16384.0 |
time (ms) | total time: 133.64 | forward: 45.47 | backward: 85.51 | allreduce: 8.74 | optimizer: 0.04 | bias in backward: 2.27 | dropout in backward: 1.70
 iteration      100/     100 | elapsed time per iteration (ms): 124.3 | learning rate: 8.182E-07 | lm loss: 1.031752E+01 | sop loss: 5.156253E-01 | loss scale: 16384.0 |
time (ms) | total time: 123.95 | forward: 33.14 | backward: 83.34 | allreduce: 8.86 | optimizer: 5.33 | bias in backward: 2.29 | dropout in backward: 1.72
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

2

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.096155 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3560.74 | train/valid/test data iterators: 2336.19
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 2104.5 | learning rate: 0.000E+00 | lm loss: 1.056576E+01 | sop loss: 7.576529E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 689.09228515625 | max allocated: 1653.666015625 | cached: 1868.0 | max cached: 1868.0
time (ms) | total time: 2104.29 | forward: 1780.79 | backward: 309.20 | allreduce: 13.83 | optimizer: 0.05 | bias in backward: 2.23 | dropout in backward: 1.64
 iteration        2/     100 | elapsed time per iteration (ms): 113.7 | learning rate: 0.000E+00 | lm loss: 1.055798E+01 | sop loss: 6.296840E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 112.00 | forward: 56.55 | backward: 53.16 | allreduce: 9.37 | optimizer: 0.04 | bias in backward: 2.25 | dropout in backward: 1.65
 iteration        3/     100 | elapsed time per iteration (ms): 86.2 | learning rate: 0.000E+00 | lm loss: 1.051961E+01 | sop loss: 7.010107E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 85.92 | forward: 33.52 | backward: 50.01 | allreduce: 9.48 | optimizer: 0.03 | bias in backward: 2.21 | dropout in backward: 1.64
 iteration        4/     100 | elapsed time per iteration (ms): 82.9 | learning rate: 0.000E+00 | lm loss: 1.049026E+01 | sop loss: 6.926261E-01 | loss scale: 536870912.0 |
time (ms) | total time: 82.64 | forward: 30.83 | backward: 49.41 | allreduce: 11.25 | optimizer: 0.03 | bias in backward: 2.44 | dropout in backward: 1.75
 iteration        5/     100 | elapsed time per iteration (ms): 80.3 | learning rate: 0.000E+00 | lm loss: 1.059519E+01 | sop loss: 8.265194E-01 | loss scale: 268435456.0 |
time (ms) | total time: 80.01 | forward: 30.50 | backward: 47.22 | allreduce: 9.00 | optimizer: 0.03 | bias in backward: 2.31 | dropout in backward: 1.75
 iteration        6/     100 | elapsed time per iteration (ms): 80.3 | learning rate: 0.000E+00 | lm loss: 1.033954E+01 | sop loss: 6.301445E-01 | loss scale: 134217728.0 |
time (ms) | total time: 80.07 | forward: 30.48 | backward: 47.30 | allreduce: 9.37 | optimizer: 0.03 | bias in backward: 2.36 | dropout in backward: 1.71
 iteration        7/     100 | elapsed time per iteration (ms): 81.8 | learning rate: 0.000E+00 | lm loss: 1.045154E+01 | sop loss: 7.857776E-01 | loss scale: 67108864.0 |
time (ms) | total time: 81.56 | forward: 32.43 | backward: 46.87 | allreduce: 9.23 | optimizer: 0.03 | bias in backward: 2.31 | dropout in backward: 1.69
 iteration        8/     100 | elapsed time per iteration (ms): 85.5 | learning rate: 0.000E+00 | lm loss: 1.042130E+01 | sop loss: 6.284914E-01 | loss scale: 33554432.0 |
time (ms) | total time: 85.25 | forward: 34.25 | backward: 48.68 | allreduce: 9.55 | optimizer: 0.05 | bias in backward: 2.39 | dropout in backward: 1.76
 iteration        9/     100 | elapsed time per iteration (ms): 84.7 | learning rate: 0.000E+00 | lm loss: 1.048605E+01 | sop loss: 6.493297E-01 | loss scale: 16777216.0 |
time (ms) | total time: 84.40 | forward: 33.95 | backward: 47.99 | allreduce: 9.56 | optimizer: 0.03 | bias in backward: 2.32 | dropout in backward: 1.68
 iteration       10/     100 | elapsed time per iteration (ms): 82.6 | learning rate: 0.000E+00 | lm loss: 1.060788E+01 | sop loss: 8.511937E-01 | loss scale: 8388608.0 |
time (ms) | total time: 82.33 | forward: 31.42 | backward: 48.63 | allreduce: 9.32 | optimizer: 0.03 | bias in backward: 2.41 | dropout in backward: 1.70
 iteration       11/     100 | elapsed time per iteration (ms): 82.4 | learning rate: 0.000E+00 | lm loss: 1.023677E+01 | sop loss: 1.100836E+00 | loss scale: 4194304.0 |
time (ms) | total time: 82.16 | forward: 32.38 | backward: 47.46 | allreduce: 9.56 | optimizer: 0.03 | bias in backward: 2.22 | dropout in backward: 1.63
 iteration       12/     100 | elapsed time per iteration (ms): 81.4 | learning rate: 0.000E+00 | lm loss: 1.068755E+01 | sop loss: 8.197852E-01 | loss scale: 2097152.0 |
time (ms) | total time: 81.17 | forward: 31.77 | backward: 47.07 | allreduce: 9.09 | optimizer: 0.03 | bias in backward: 2.22 | dropout in backward: 1.64
 iteration       13/     100 | elapsed time per iteration (ms): 80.7 | learning rate: 0.000E+00 | lm loss: 1.069516E+01 | sop loss: 7.124939E-01 | loss scale: 1048576.0 |
time (ms) | total time: 80.48 | forward: 30.72 | backward: 47.67 | allreduce: 9.06 | optimizer: 0.03 | bias in backward: 2.34 | dropout in backward: 1.72
 iteration       14/     100 | elapsed time per iteration (ms): 83.6 | learning rate: 0.000E+00 | lm loss: 1.049780E+01 | sop loss: 6.486735E-01 | loss scale: 524288.0 |
time (ms) | total time: 83.30 | forward: 33.40 | backward: 47.62 | allreduce: 9.45 | optimizer: 0.03 | bias in backward: 2.23 | dropout in backward: 1.66
 iteration       15/     100 | elapsed time per iteration (ms): 82.0 | learning rate: 0.000E+00 | lm loss: 1.063076E+01 | sop loss: 5.535492E-01 | loss scale: 262144.0 |
time (ms) | total time: 81.70 | forward: 30.99 | backward: 48.45 | allreduce: 9.23 | optimizer: 0.03 | bias in backward: 2.40 | dropout in backward: 1.80
 iteration       16/     100 | elapsed time per iteration (ms): 86.1 | learning rate: 0.000E+00 | lm loss: 1.067644E+01 | sop loss: 5.598666E-01 | loss scale: 131072.0 |
time (ms) | total time: 85.86 | forward: 30.71 | backward: 52.93 | allreduce: 9.07 | optimizer: 0.03 | bias in backward: 2.40 | dropout in backward: 1.80
 iteration       17/     100 | elapsed time per iteration (ms): 95.0 | learning rate: 0.000E+00 | lm loss: 1.044317E+01 | sop loss: 7.512242E-01 | loss scale: 65536.0 |
time (ms) | total time: 94.78 | forward: 30.49 | backward: 62.11 | allreduce: 8.98 | optimizer: 0.03 | bias in backward: 2.25 | dropout in backward: 1.72
 iteration       18/     100 | elapsed time per iteration (ms): 174.1 | learning rate: 1.010E-08 | lm loss: 1.030375E+01 | sop loss: 3.555968E-01 | loss scale: 65536.0 |
time (ms) | total time: 173.83 | forward: 30.43 | backward: 85.59 | allreduce: 9.23 | optimizer: 55.72 | bias in backward: 2.41 | dropout in backward: 1.78
 iteration       19/     100 | elapsed time per iteration (ms): 315.2 | learning rate: 2.020E-08 | lm loss: 1.055324E+01 | sop loss: 8.255026E-01 | loss scale: 65536.0 |
time (ms) | total time: 314.92 | forward: 213.23 | backward: 94.03 | allreduce: 12.21 | optimizer: 5.33 | bias in backward: 2.25 | dropout in backward: 1.66
 iteration       20/     100 | elapsed time per iteration (ms): 125.4 | learning rate: 3.030E-08 | lm loss: 1.068345E+01 | sop loss: 7.048808E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.09 | forward: 31.25 | backward: 86.15 | allreduce: 9.34 | optimizer: 5.30 | bias in backward: 2.35 | dropout in backward: 1.70
 iteration       21/     100 | elapsed time per iteration (ms): 125.2 | learning rate: 4.040E-08 | lm loss: 1.061067E+01 | sop loss: 8.204826E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.91 | forward: 30.68 | backward: 86.65 | allreduce: 9.39 | optimizer: 5.29 | bias in backward: 2.30 | dropout in backward: 1.68
 iteration       22/     100 | elapsed time per iteration (ms): 131.2 | learning rate: 5.051E-08 | lm loss: 1.053644E+01 | sop loss: 6.454183E-01 | loss scale: 65536.0 |
time (ms) | total time: 130.89 | forward: 34.41 | backward: 88.71 | allreduce: 9.94 | optimizer: 5.29 | bias in backward: 2.61 | dropout in backward: 1.89
 iteration       23/     100 | elapsed time per iteration (ms): 124.6 | learning rate: 6.061E-08 | lm loss: 1.083405E+01 | sop loss: 5.189915E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.31 | forward: 31.18 | backward: 85.98 | allreduce: 9.04 | optimizer: 5.24 | bias in backward: 2.41 | dropout in backward: 1.92
 iteration       24/     100 | elapsed time per iteration (ms): 126.1 | learning rate: 7.071E-08 | lm loss: 1.062243E+01 | sop loss: 6.347317E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.76 | forward: 32.71 | backward: 86.03 | allreduce: 8.91 | optimizer: 5.27 | bias in backward: 2.31 | dropout in backward: 1.70
 iteration       25/     100 | elapsed time per iteration (ms): 123.2 | learning rate: 8.081E-08 | lm loss: 1.052216E+01 | sop loss: 7.023293E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.93 | forward: 30.96 | backward: 85.02 | allreduce: 8.72 | optimizer: 5.25 | bias in backward: 2.31 | dropout in backward: 1.70
 iteration       26/     100 | elapsed time per iteration (ms): 123.9 | learning rate: 9.091E-08 | lm loss: 1.039545E+01 | sop loss: 6.541386E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.61 | forward: 30.59 | backward: 86.12 | allreduce: 8.71 | optimizer: 5.26 | bias in backward: 2.52 | dropout in backward: 1.76
 iteration       27/     100 | elapsed time per iteration (ms): 124.0 | learning rate: 1.010E-07 | lm loss: 1.051445E+01 | sop loss: 5.925058E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.71 | forward: 31.55 | backward: 85.28 | allreduce: 8.66 | optimizer: 5.24 | bias in backward: 2.29 | dropout in backward: 1.69
 iteration       28/     100 | elapsed time per iteration (ms): 123.4 | learning rate: 1.111E-07 | lm loss: 1.057746E+01 | sop loss: 8.695749E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.12 | forward: 30.78 | backward: 85.42 | allreduce: 8.93 | optimizer: 5.26 | bias in backward: 2.38 | dropout in backward: 1.72
 iteration       29/     100 | elapsed time per iteration (ms): 125.4 | learning rate: 1.212E-07 | lm loss: 1.062051E+01 | sop loss: 6.776342E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.12 | forward: 32.53 | backward: 85.57 | allreduce: 8.82 | optimizer: 5.29 | bias in backward: 2.31 | dropout in backward: 1.70
 iteration       30/     100 | elapsed time per iteration (ms): 127.9 | learning rate: 1.313E-07 | lm loss: 1.057202E+01 | sop loss: 8.426001E-01 | loss scale: 65536.0 |
time (ms) | total time: 127.63 | forward: 31.39 | backward: 88.74 | allreduce: 8.97 | optimizer: 5.33 | bias in backward: 2.50 | dropout in backward: 1.78
 iteration       31/     100 | elapsed time per iteration (ms): 135.3 | learning rate: 1.414E-07 | lm loss: 1.063463E+01 | sop loss: 6.819719E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.03 | forward: 36.51 | backward: 91.23 | allreduce: 8.97 | optimizer: 5.30 | bias in backward: 2.50 | dropout in backward: 1.74
 iteration       32/     100 | elapsed time per iteration (ms): 139.0 | learning rate: 1.515E-07 | lm loss: 1.058855E+01 | sop loss: 7.232713E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.67 | forward: 39.58 | backward: 91.61 | allreduce: 9.01 | optimizer: 5.33 | bias in backward: 2.31 | dropout in backward: 1.71
 iteration       33/     100 | elapsed time per iteration (ms): 138.6 | learning rate: 1.616E-07 | lm loss: 1.047597E+01 | sop loss: 5.262134E-01 | loss scale: 65536.0 |
time (ms) | total time: 138.29 | forward: 39.84 | backward: 91.20 | allreduce: 8.93 | optimizer: 5.29 | bias in backward: 2.30 | dropout in backward: 1.69
 iteration       34/     100 | elapsed time per iteration (ms): 135.6 | learning rate: 1.717E-07 | lm loss: 1.064093E+01 | sop loss: 6.342516E-01 | loss scale: 65536.0 |
time (ms) | total time: 135.31 | forward: 40.18 | backward: 88.14 | allreduce: 8.68 | optimizer: 5.27 | bias in backward: 2.30 | dropout in backward: 1.70
 iteration       35/     100 | elapsed time per iteration (ms): 124.4 | learning rate: 1.818E-07 | lm loss: 1.052400E+01 | sop loss: 1.008515E+00 | loss scale: 65536.0 |
time (ms) | total time: 124.14 | forward: 32.27 | backward: 84.90 | allreduce: 8.62 | optimizer: 5.27 | bias in backward: 2.50 | dropout in backward: 1.80
 iteration       36/     100 | elapsed time per iteration (ms): 121.7 | learning rate: 1.919E-07 | lm loss: 1.066903E+01 | sop loss: 6.598561E-01 | loss scale: 65536.0 |
time (ms) | total time: 121.47 | forward: 30.50 | backward: 84.00 | allreduce: 8.59 | optimizer: 5.24 | bias in backward: 2.39 | dropout in backward: 1.73
 iteration       37/     100 | elapsed time per iteration (ms): 124.1 | learning rate: 2.020E-07 | lm loss: 1.035221E+01 | sop loss: 5.791082E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.81 | forward: 31.09 | backward: 84.62 | allreduce: 8.63 | optimizer: 6.27 | bias in backward: 2.28 | dropout in backward: 1.70
 iteration       38/     100 | elapsed time per iteration (ms): 124.8 | learning rate: 2.121E-07 | lm loss: 1.049873E+01 | sop loss: 1.073243E+00 | loss scale: 65536.0 |
time (ms) | total time: 124.53 | forward: 31.50 | backward: 85.91 | allreduce: 8.79 | optimizer: 5.24 | bias in backward: 2.29 | dropout in backward: 1.71
 iteration       39/     100 | elapsed time per iteration (ms): 123.3 | learning rate: 2.222E-07 | lm loss: 1.047691E+01 | sop loss: 8.403072E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.03 | forward: 31.62 | backward: 84.50 | allreduce: 8.72 | optimizer: 5.25 | bias in backward: 2.31 | dropout in backward: 1.70
 iteration       40/     100 | elapsed time per iteration (ms): 122.5 | learning rate: 2.323E-07 | lm loss: 1.048705E+01 | sop loss: 9.326818E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.22 | forward: 30.56 | backward: 84.76 | allreduce: 8.69 | optimizer: 5.25 | bias in backward: 2.54 | dropout in backward: 1.75
 iteration       41/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 2.424E-07 | lm loss: 1.048852E+01 | sop loss: 9.296573E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.82 | forward: 30.67 | backward: 85.19 | allreduce: 8.68 | optimizer: 5.35 | bias in backward: 2.43 | dropout in backward: 1.71
 iteration       42/     100 | elapsed time per iteration (ms): 123.6 | learning rate: 2.525E-07 | lm loss: 1.051363E+01 | sop loss: 5.671820E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.31 | forward: 31.05 | backward: 84.87 | allreduce: 8.82 | optimizer: 5.33 | bias in backward: 2.30 | dropout in backward: 1.70
 iteration       43/     100 | elapsed time per iteration (ms): 124.4 | learning rate: 2.626E-07 | lm loss: 1.044647E+01 | sop loss: 7.094553E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.11 | forward: 32.41 | backward: 84.50 | allreduce: 8.89 | optimizer: 5.29 | bias in backward: 2.30 | dropout in backward: 1.71
 iteration       44/     100 | elapsed time per iteration (ms): 122.9 | learning rate: 2.727E-07 | lm loss: 1.054015E+01 | sop loss: 7.511193E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.65 | forward: 30.47 | backward: 85.01 | allreduce: 8.92 | optimizer: 5.29 | bias in backward: 2.35 | dropout in backward: 1.70
 iteration       45/     100 | elapsed time per iteration (ms): 123.8 | learning rate: 2.828E-07 | lm loss: 1.054253E+01 | sop loss: 7.660618E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.50 | forward: 32.27 | backward: 84.28 | allreduce: 8.74 | optimizer: 5.28 | bias in backward: 2.29 | dropout in backward: 1.70
 iteration       46/     100 | elapsed time per iteration (ms): 122.5 | learning rate: 2.929E-07 | lm loss: 1.051192E+01 | sop loss: 8.294149E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.23 | forward: 31.24 | backward: 84.05 | allreduce: 8.66 | optimizer: 5.25 | bias in backward: 2.31 | dropout in backward: 1.69
 iteration       47/     100 | elapsed time per iteration (ms): 122.8 | learning rate: 3.030E-07 | lm loss: 1.048361E+01 | sop loss: 9.324172E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.58 | forward: 31.13 | backward: 84.45 | allreduce: 8.62 | optimizer: 5.26 | bias in backward: 2.35 | dropout in backward: 1.77
 iteration       48/     100 | elapsed time per iteration (ms): 121.3 | learning rate: 3.131E-07 | lm loss: 1.051837E+01 | sop loss: 5.960808E-01 | loss scale: 65536.0 |
time (ms) | total time: 121.07 | forward: 30.36 | backward: 83.87 | allreduce: 8.57 | optimizer: 5.22 | bias in backward: 2.32 | dropout in backward: 1.76
 iteration       49/     100 | elapsed time per iteration (ms): 125.3 | learning rate: 3.232E-07 | lm loss: 1.061187E+01 | sop loss: 8.417939E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.99 | forward: 31.18 | backward: 86.45 | allreduce: 9.33 | optimizer: 5.25 | bias in backward: 2.34 | dropout in backward: 1.72
 iteration       50/     100 | elapsed time per iteration (ms): 122.8 | learning rate: 3.333E-07 | lm loss: 1.036742E+01 | sop loss: 8.954514E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.58 | forward: 30.19 | backward: 85.31 | allreduce: 8.77 | optimizer: 5.31 | bias in backward: 2.40 | dropout in backward: 1.73
 iteration       51/     100 | elapsed time per iteration (ms): 122.2 | learning rate: 3.434E-07 | lm loss: 1.053677E+01 | sop loss: 9.964914E-01 | loss scale: 65536.0 |
time (ms) | total time: 121.98 | forward: 30.14 | backward: 84.83 | allreduce: 8.86 | optimizer: 5.27 | bias in backward: 2.40 | dropout in backward: 1.79
 iteration       52/     100 | elapsed time per iteration (ms): 123.9 | learning rate: 3.535E-07 | lm loss: 1.053789E+01 | sop loss: 8.064806E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.66 | forward: 32.44 | backward: 84.40 | allreduce: 8.82 | optimizer: 5.27 | bias in backward: 2.31 | dropout in backward: 1.70
 iteration       53/     100 | elapsed time per iteration (ms): 126.0 | learning rate: 3.636E-07 | lm loss: 1.045053E+01 | sop loss: 7.272050E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.75 | forward: 31.68 | backward: 86.55 | allreduce: 9.49 | optimizer: 5.34 | bias in backward: 2.42 | dropout in backward: 1.76
 iteration       54/     100 | elapsed time per iteration (ms): 123.6 | learning rate: 3.737E-07 | lm loss: 1.050308E+01 | sop loss: 7.551734E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.35 | forward: 30.76 | backward: 84.89 | allreduce: 9.09 | optimizer: 5.29 | bias in backward: 2.45 | dropout in backward: 1.73
 iteration       55/     100 | elapsed time per iteration (ms): 122.9 | learning rate: 3.838E-07 | lm loss: 1.037602E+01 | sop loss: 6.408823E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.62 | forward: 30.55 | backward: 84.34 | allreduce: 8.99 | optimizer: 5.31 | bias in backward: 2.48 | dropout in backward: 1.72
 iteration       56/     100 | elapsed time per iteration (ms): 124.9 | learning rate: 3.939E-07 | lm loss: 1.057219E+01 | sop loss: 8.763865E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.58 | forward: 30.94 | backward: 85.73 | allreduce: 9.65 | optimizer: 5.35 | bias in backward: 2.46 | dropout in backward: 1.76
 iteration       57/     100 | elapsed time per iteration (ms): 126.4 | learning rate: 4.040E-07 | lm loss: 1.048692E+01 | sop loss: 5.977671E-01 | loss scale: 65536.0 |
time (ms) | total time: 126.10 | forward: 33.16 | backward: 85.05 | allreduce: 9.65 | optimizer: 5.29 | bias in backward: 2.31 | dropout in backward: 1.71
 iteration       58/     100 | elapsed time per iteration (ms): 126.0 | learning rate: 4.141E-07 | lm loss: 1.043004E+01 | sop loss: 8.122433E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.72 | forward: 32.47 | backward: 85.29 | allreduce: 9.85 | optimizer: 5.33 | bias in backward: 2.32 | dropout in backward: 1.70
 iteration       59/     100 | elapsed time per iteration (ms): 126.2 | learning rate: 4.242E-07 | lm loss: 1.044294E+01 | sop loss: 7.224603E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.87 | forward: 33.14 | backward: 84.96 | allreduce: 9.73 | optimizer: 5.32 | bias in backward: 2.32 | dropout in backward: 1.70
 iteration       60/     100 | elapsed time per iteration (ms): 125.9 | learning rate: 4.343E-07 | lm loss: 1.037264E+01 | sop loss: 6.304466E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.56 | forward: 32.84 | backward: 84.87 | allreduce: 9.39 | optimizer: 5.33 | bias in backward: 2.30 | dropout in backward: 1.71
 iteration       61/     100 | elapsed time per iteration (ms): 123.4 | learning rate: 4.444E-07 | lm loss: 1.058804E+01 | sop loss: 6.652493E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.14 | forward: 31.33 | backward: 84.06 | allreduce: 9.06 | optimizer: 5.30 | bias in backward: 2.33 | dropout in backward: 1.70
 iteration       62/     100 | elapsed time per iteration (ms): 123.7 | learning rate: 4.545E-07 | lm loss: 1.047275E+01 | sop loss: 5.922968E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.42 | forward: 30.59 | backward: 85.19 | allreduce: 9.44 | optimizer: 5.28 | bias in backward: 2.50 | dropout in backward: 1.80
 iteration       63/     100 | elapsed time per iteration (ms): 123.2 | learning rate: 4.646E-07 | lm loss: 1.022314E+01 | sop loss: 6.612176E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.89 | forward: 30.54 | backward: 84.75 | allreduce: 9.36 | optimizer: 5.28 | bias in backward: 2.41 | dropout in backward: 1.76
 iteration       64/     100 | elapsed time per iteration (ms): 124.5 | learning rate: 4.747E-07 | lm loss: 1.044651E+01 | sop loss: 7.566180E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.23 | forward: 32.03 | backward: 84.33 | allreduce: 9.07 | optimizer: 5.33 | bias in backward: 2.34 | dropout in backward: 1.73
 iteration       65/     100 | elapsed time per iteration (ms): 132.5 | learning rate: 4.848E-07 | lm loss: 1.050853E+01 | sop loss: 7.953715E-01 | loss scale: 65536.0 |
time (ms) | total time: 132.23 | forward: 33.10 | backward: 91.30 | allreduce: 9.11 | optimizer: 5.29 | bias in backward: 2.90 | dropout in backward: 1.91
 iteration       66/     100 | elapsed time per iteration (ms): 125.0 | learning rate: 4.949E-07 | lm loss: 1.047112E+01 | sop loss: 7.127080E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.75 | forward: 32.53 | backward: 84.55 | allreduce: 9.10 | optimizer: 5.28 | bias in backward: 2.35 | dropout in backward: 1.71
 iteration       67/     100 | elapsed time per iteration (ms): 123.5 | learning rate: 5.051E-07 | lm loss: 1.043389E+01 | sop loss: 8.777214E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.23 | forward: 30.54 | backward: 84.99 | allreduce: 9.03 | optimizer: 5.29 | bias in backward: 2.52 | dropout in backward: 1.84
 iteration       68/     100 | elapsed time per iteration (ms): 123.9 | learning rate: 5.152E-07 | lm loss: 1.047204E+01 | sop loss: 7.570356E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.62 | forward: 32.01 | backward: 83.95 | allreduce: 9.05 | optimizer: 5.25 | bias in backward: 2.33 | dropout in backward: 1.70
 iteration       69/     100 | elapsed time per iteration (ms): 124.2 | learning rate: 5.253E-07 | lm loss: 1.041789E+01 | sop loss: 8.648373E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.91 | forward: 32.35 | backward: 83.95 | allreduce: 8.98 | optimizer: 5.24 | bias in backward: 2.30 | dropout in backward: 1.69
 iteration       70/     100 | elapsed time per iteration (ms): 124.1 | learning rate: 5.354E-07 | lm loss: 1.042877E+01 | sop loss: 9.632648E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.79 | forward: 32.21 | backward: 83.94 | allreduce: 9.06 | optimizer: 5.28 | bias in backward: 2.31 | dropout in backward: 1.70
 iteration       71/     100 | elapsed time per iteration (ms): 122.8 | learning rate: 5.455E-07 | lm loss: 1.039234E+01 | sop loss: 4.982281E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.53 | forward: 30.47 | backward: 84.42 | allreduce: 9.02 | optimizer: 5.28 | bias in backward: 2.41 | dropout in backward: 1.74
 iteration       72/     100 | elapsed time per iteration (ms): 123.9 | learning rate: 5.556E-07 | lm loss: 1.044814E+01 | sop loss: 6.899244E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.68 | forward: 32.40 | backward: 83.67 | allreduce: 8.98 | optimizer: 5.26 | bias in backward: 2.31 | dropout in backward: 1.71
 iteration       73/     100 | elapsed time per iteration (ms): 124.0 | learning rate: 5.657E-07 | lm loss: 1.040043E+01 | sop loss: 8.072398E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.71 | forward: 32.29 | backward: 83.80 | allreduce: 9.01 | optimizer: 5.27 | bias in backward: 2.31 | dropout in backward: 1.69
 iteration       74/     100 | elapsed time per iteration (ms): 124.3 | learning rate: 5.758E-07 | lm loss: 1.040689E+01 | sop loss: 6.395430E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.98 | forward: 32.40 | backward: 83.99 | allreduce: 9.00 | optimizer: 5.24 | bias in backward: 2.34 | dropout in backward: 1.71
 iteration       75/     100 | elapsed time per iteration (ms): 124.4 | learning rate: 5.859E-07 | lm loss: 1.042252E+01 | sop loss: 5.521127E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.11 | forward: 32.43 | backward: 84.09 | allreduce: 9.05 | optimizer: 5.29 | bias in backward: 2.33 | dropout in backward: 1.70
 iteration       76/     100 | elapsed time per iteration (ms): 122.7 | learning rate: 5.960E-07 | lm loss: 1.045218E+01 | sop loss: 7.579178E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.45 | forward: 30.68 | backward: 84.09 | allreduce: 9.33 | optimizer: 5.27 | bias in backward: 2.44 | dropout in backward: 1.74
 iteration       77/     100 | elapsed time per iteration (ms): 122.7 | learning rate: 6.061E-07 | lm loss: 1.045583E+01 | sop loss: 8.634617E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.41 | forward: 30.52 | backward: 84.33 | allreduce: 8.96 | optimizer: 5.29 | bias in backward: 2.41 | dropout in backward: 1.77
 iteration       78/     100 | elapsed time per iteration (ms): 125.6 | learning rate: 6.162E-07 | lm loss: 1.036285E+01 | sop loss: 4.701384E-01 | loss scale: 65536.0 |
time (ms) | total time: 125.37 | forward: 32.58 | backward: 84.96 | allreduce: 9.08 | optimizer: 5.38 | bias in backward: 2.38 | dropout in backward: 1.76
 iteration       79/     100 | elapsed time per iteration (ms): 124.5 | learning rate: 6.263E-07 | lm loss: 1.050343E+01 | sop loss: 5.273022E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.25 | forward: 31.44 | backward: 84.98 | allreduce: 9.46 | optimizer: 5.29 | bias in backward: 2.33 | dropout in backward: 1.70
 iteration       80/     100 | elapsed time per iteration (ms): 124.7 | learning rate: 6.364E-07 | lm loss: 1.038980E+01 | sop loss: 1.100369E+00 | loss scale: 65536.0 |
time (ms) | total time: 124.44 | forward: 32.43 | backward: 84.33 | allreduce: 9.41 | optimizer: 5.29 | bias in backward: 2.33 | dropout in backward: 1.73
 iteration       81/     100 | elapsed time per iteration (ms): 124.5 | learning rate: 6.465E-07 | lm loss: 1.039757E+01 | sop loss: 8.144231E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.23 | forward: 32.56 | backward: 83.95 | allreduce: 9.44 | optimizer: 5.28 | bias in backward: 2.30 | dropout in backward: 1.73
 iteration       82/     100 | elapsed time per iteration (ms): 123.3 | learning rate: 6.566E-07 | lm loss: 1.053232E+01 | sop loss: 6.056406E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.00 | forward: 30.62 | backward: 84.74 | allreduce: 9.45 | optimizer: 5.28 | bias in backward: 2.53 | dropout in backward: 1.73
 iteration       83/     100 | elapsed time per iteration (ms): 123.1 | learning rate: 6.667E-07 | lm loss: 1.033763E+01 | sop loss: 4.530839E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.77 | forward: 30.92 | backward: 84.23 | allreduce: 9.47 | optimizer: 5.28 | bias in backward: 2.33 | dropout in backward: 1.70
 iteration       84/     100 | elapsed time per iteration (ms): 123.5 | learning rate: 6.768E-07 | lm loss: 1.034426E+01 | sop loss: 6.447726E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.21 | forward: 30.78 | backward: 84.79 | allreduce: 9.45 | optimizer: 5.28 | bias in backward: 2.42 | dropout in backward: 1.71
 iteration       85/     100 | elapsed time per iteration (ms): 123.8 | learning rate: 6.869E-07 | lm loss: 1.030309E+01 | sop loss: 1.054084E+00 | loss scale: 65536.0 |
time (ms) | total time: 123.57 | forward: 32.25 | backward: 83.79 | allreduce: 9.01 | optimizer: 5.27 | bias in backward: 2.32 | dropout in backward: 1.72
 iteration       86/     100 | elapsed time per iteration (ms): 124.0 | learning rate: 6.970E-07 | lm loss: 1.031874E+01 | sop loss: 5.070660E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.74 | forward: 32.31 | backward: 83.77 | allreduce: 9.41 | optimizer: 5.30 | bias in backward: 2.31 | dropout in backward: 1.70
 iteration       87/     100 | elapsed time per iteration (ms): 122.7 | learning rate: 7.071E-07 | lm loss: 1.035072E+01 | sop loss: 4.913671E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.45 | forward: 30.58 | backward: 84.22 | allreduce: 8.96 | optimizer: 5.29 | bias in backward: 2.31 | dropout in backward: 1.77
 iteration       88/     100 | elapsed time per iteration (ms): 124.1 | learning rate: 7.172E-07 | lm loss: 1.036060E+01 | sop loss: 1.278448E+00 | loss scale: 65536.0 |
time (ms) | total time: 123.79 | forward: 32.56 | backward: 83.62 | allreduce: 8.99 | optimizer: 5.27 | bias in backward: 2.32 | dropout in backward: 1.70
 iteration       89/     100 | elapsed time per iteration (ms): 124.1 | learning rate: 7.273E-07 | lm loss: 1.054606E+01 | sop loss: 9.094174E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.79 | forward: 32.31 | backward: 83.87 | allreduce: 8.98 | optimizer: 5.28 | bias in backward: 2.32 | dropout in backward: 1.70
 iteration       90/     100 | elapsed time per iteration (ms): 124.6 | learning rate: 7.374E-07 | lm loss: 1.025459E+01 | sop loss: 4.826267E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.30 | forward: 32.44 | backward: 84.20 | allreduce: 9.39 | optimizer: 5.29 | bias in backward: 2.34 | dropout in backward: 1.70
 iteration       91/     100 | elapsed time per iteration (ms): 122.7 | learning rate: 7.475E-07 | lm loss: 1.018259E+01 | sop loss: 4.489013E-01 | loss scale: 65536.0 |
time (ms) | total time: 122.39 | forward: 30.56 | backward: 84.20 | allreduce: 9.30 | optimizer: 5.28 | bias in backward: 2.33 | dropout in backward: 1.74
 iteration       92/     100 | elapsed time per iteration (ms): 124.5 | learning rate: 7.576E-07 | lm loss: 1.046633E+01 | sop loss: 7.486142E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.26 | forward: 32.65 | backward: 84.02 | allreduce: 9.33 | optimizer: 5.26 | bias in backward: 2.31 | dropout in backward: 1.70
 iteration       93/     100 | elapsed time per iteration (ms): 124.1 | learning rate: 7.677E-07 | lm loss: 1.027884E+01 | sop loss: 1.163519E+00 | loss scale: 65536.0 |
time (ms) | total time: 123.80 | forward: 32.32 | backward: 83.88 | allreduce: 9.28 | optimizer: 5.28 | bias in backward: 2.31 | dropout in backward: 1.71
 iteration       94/     100 | elapsed time per iteration (ms): 125.0 | learning rate: 7.778E-07 | lm loss: 1.031691E+01 | sop loss: 6.587418E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.72 | forward: 30.55 | backward: 86.53 | allreduce: 9.43 | optimizer: 5.27 | bias in backward: 2.56 | dropout in backward: 1.84
 iteration       95/     100 | elapsed time per iteration (ms): 124.8 | learning rate: 7.879E-07 | lm loss: 1.030799E+01 | sop loss: 6.018562E-01 | loss scale: 65536.0 |
time (ms) | total time: 124.57 | forward: 32.54 | backward: 84.38 | allreduce: 9.39 | optimizer: 5.29 | bias in backward: 2.32 | dropout in backward: 1.72
 iteration       96/     100 | elapsed time per iteration (ms): 150.6 | learning rate: 7.980E-07 | lm loss: 1.046868E+01 | sop loss: 1.058047E+00 | loss scale: 65536.0 |
time (ms) | total time: 150.30 | forward: 32.40 | backward: 110.10 | allreduce: 34.52 | optimizer: 5.32 | bias in backward: 2.34 | dropout in backward: 1.73
 iteration       97/     100 | elapsed time per iteration (ms): 123.6 | learning rate: 8.081E-07 | lm loss: 1.032863E+01 | sop loss: 9.318024E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.28 | forward: 31.13 | backward: 84.35 | allreduce: 9.36 | optimizer: 5.29 | bias in backward: 2.34 | dropout in backward: 1.70
 iteration       98/     100 | elapsed time per iteration (ms): 123.5 | learning rate: 8.182E-07 | lm loss: 1.020979E+01 | sop loss: 3.434458E-01 | loss scale: 65536.0 |
time (ms) | total time: 123.20 | forward: 30.51 | backward: 85.05 | allreduce: 9.33 | optimizer: 5.29 | bias in backward: 2.48 | dropout in backward: 1.75
 iteration       99/     100 | elapsed time per iteration (ms): 150.7 | learning rate: 8.283E-07 | lm loss: 1.036662E+01 | sop loss: 3.721904E-01 | loss scale: 65536.0 |
time (ms) | total time: 150.43 | forward: 30.56 | backward: 111.96 | allreduce: 9.79 | optimizer: 5.36 | bias in backward: 2.52 | dropout in backward: 1.75
 iteration      100/     100 | elapsed time per iteration (ms): 126.4 | learning rate: 8.384E-07 | lm loss: 1.037805E+01 | sop loss: 7.654020E-01 | loss scale: 65536.0 |
time (ms) | total time: 126.01 | forward: 33.27 | backward: 84.83 | allreduce: 9.64 | optimizer: 5.33 | bias in backward: 2.36 | dropout in backward: 1.73
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

4

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.138231 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.003 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3480.01 | train/valid/test data iterators: 2588.08
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 2516.5 | learning rate: 0.000E+00 | lm loss: 1.048841E+01 | sop loss: 7.050651E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 687.59228515625 | max allocated: 2758.6123046875 | cached: 3028.0 | max cached: 3028.0
time (ms) | total time: 2516.25 | forward: 2170.00 | backward: 338.98 | allreduce: 13.08 | optimizer: 0.04 | bias in backward: 2.35 | dropout in backward: 1.80
 iteration        2/     100 | elapsed time per iteration (ms): 120.2 | learning rate: 0.000E+00 | lm loss: 1.054400E+01 | sop loss: 8.610222E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 118.66 | forward: 57.09 | backward: 59.22 | allreduce: 9.32 | optimizer: 0.04 | bias in backward: 2.33 | dropout in backward: 1.78
 iteration        3/     100 | elapsed time per iteration (ms): 114.3 | learning rate: 0.000E+00 | lm loss: 1.062273E+01 | sop loss: 6.712811E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 114.04 | forward: 48.93 | backward: 62.66 | allreduce: 9.28 | optimizer: 0.03 | bias in backward: 2.51 | dropout in backward: 1.90
 iteration        4/     100 | elapsed time per iteration (ms): 100.5 | learning rate: 0.000E+00 | lm loss: 1.054635E+01 | sop loss: 5.485986E-01 | loss scale: 536870912.0 |
time (ms) | total time: 100.19 | forward: 38.38 | backward: 59.25 | allreduce: 9.37 | optimizer: 0.04 | bias in backward: 2.32 | dropout in backward: 1.80
 iteration        5/     100 | elapsed time per iteration (ms): 100.4 | learning rate: 0.000E+00 | lm loss: 1.053844E+01 | sop loss: 6.736216E-01 | loss scale: 268435456.0 |
time (ms) | total time: 100.13 | forward: 38.33 | backward: 59.38 | allreduce: 9.15 | optimizer: 0.04 | bias in backward: 2.41 | dropout in backward: 1.91
 iteration        6/     100 | elapsed time per iteration (ms): 99.3 | learning rate: 0.000E+00 | lm loss: 1.041794E+01 | sop loss: 6.784045E-01 | loss scale: 134217728.0 |
time (ms) | total time: 99.03 | forward: 38.10 | backward: 58.65 | allreduce: 9.09 | optimizer: 0.03 | bias in backward: 2.32 | dropout in backward: 1.78
 iteration        7/     100 | elapsed time per iteration (ms): 98.7 | learning rate: 0.000E+00 | lm loss: 1.056647E+01 | sop loss: 5.332336E-01 | loss scale: 67108864.0 |
time (ms) | total time: 98.41 | forward: 37.51 | backward: 58.66 | allreduce: 9.02 | optimizer: 0.03 | bias in backward: 2.40 | dropout in backward: 1.85
 iteration        8/     100 | elapsed time per iteration (ms): 101.5 | learning rate: 0.000E+00 | lm loss: 1.049175E+01 | sop loss: 7.181420E-01 | loss scale: 33554432.0 |
time (ms) | total time: 101.18 | forward: 38.57 | backward: 60.24 | allreduce: 9.41 | optimizer: 0.04 | bias in backward: 2.56 | dropout in backward: 1.92
 iteration        9/     100 | elapsed time per iteration (ms): 100.6 | learning rate: 0.000E+00 | lm loss: 1.048026E+01 | sop loss: 6.071126E-01 | loss scale: 16777216.0 |
time (ms) | total time: 100.30 | forward: 38.24 | backward: 59.66 | allreduce: 9.21 | optimizer: 0.03 | bias in backward: 2.50 | dropout in backward: 1.84
 iteration       10/     100 | elapsed time per iteration (ms): 99.8 | learning rate: 0.000E+00 | lm loss: 1.056305E+01 | sop loss: 6.242901E-01 | loss scale: 8388608.0 |
time (ms) | total time: 99.55 | forward: 37.99 | backward: 59.25 | allreduce: 9.14 | optimizer: 0.03 | bias in backward: 2.51 | dropout in backward: 1.90
 iteration       11/     100 | elapsed time per iteration (ms): 98.9 | learning rate: 0.000E+00 | lm loss: 1.057845E+01 | sop loss: 6.416928E-01 | loss scale: 4194304.0 |
time (ms) | total time: 98.61 | forward: 37.60 | backward: 58.69 | allreduce: 9.16 | optimizer: 0.03 | bias in backward: 2.45 | dropout in backward: 1.78
 iteration       12/     100 | elapsed time per iteration (ms): 99.6 | learning rate: 0.000E+00 | lm loss: 1.047894E+01 | sop loss: 7.300603E-01 | loss scale: 2097152.0 |
time (ms) | total time: 99.34 | forward: 37.39 | backward: 59.68 | allreduce: 9.00 | optimizer: 0.03 | bias in backward: 2.58 | dropout in backward: 1.85
 iteration       13/     100 | elapsed time per iteration (ms): 99.4 | learning rate: 0.000E+00 | lm loss: 1.052268E+01 | sop loss: 5.569701E-01 | loss scale: 1048576.0 |
time (ms) | total time: 99.16 | forward: 37.95 | backward: 59.43 | allreduce: 8.68 | optimizer: 0.03 | bias in backward: 2.54 | dropout in backward: 1.87
 iteration       14/     100 | elapsed time per iteration (ms): 100.4 | learning rate: 0.000E+00 | lm loss: 1.061578E+01 | sop loss: 5.166630E-01 | loss scale: 524288.0 |
time (ms) | total time: 100.18 | forward: 38.97 | backward: 59.53 | allreduce: 8.76 | optimizer: 0.03 | bias in backward: 2.50 | dropout in backward: 1.91
 iteration       15/     100 | elapsed time per iteration (ms): 107.3 | learning rate: 0.000E+00 | lm loss: 1.046509E+01 | sop loss: 6.348035E-01 | loss scale: 262144.0 |
time (ms) | total time: 107.08 | forward: 38.57 | backward: 66.81 | allreduce: 8.63 | optimizer: 0.03 | bias in backward: 2.45 | dropout in backward: 1.81
 iteration       16/     100 | elapsed time per iteration (ms): 109.3 | learning rate: 0.000E+00 | lm loss: 1.046410E+01 | sop loss: 6.641442E-01 | loss scale: 131072.0 |
time (ms) | total time: 109.01 | forward: 38.07 | backward: 69.26 | allreduce: 11.03 | optimizer: 0.03 | bias in backward: 2.30 | dropout in backward: 1.78
 iteration       17/     100 | elapsed time per iteration (ms): 153.2 | learning rate: 1.010E-08 | lm loss: 1.048377E+01 | sop loss: 9.202322E-01 | loss scale: 131072.0 |
time (ms) | total time: 152.86 | forward: 38.27 | backward: 100.50 | allreduce: 8.62 | optimizer: 12.33 | bias in backward: 2.35 | dropout in backward: 1.81
 iteration       18/     100 | elapsed time per iteration (ms): 405.5 | learning rate: 2.020E-08 | lm loss: 1.054321E+01 | sop loss: 6.869979E-01 | loss scale: 131072.0 |
time (ms) | total time: 405.12 | forward: 289.21 | backward: 108.52 | allreduce: 14.45 | optimizer: 5.38 | bias in backward: 2.29 | dropout in backward: 1.77
 iteration       19/     100 | elapsed time per iteration (ms): 152.7 | learning rate: 3.030E-08 | lm loss: 1.049680E+01 | sop loss: 7.097961E-01 | loss scale: 131072.0 |
time (ms) | total time: 152.39 | forward: 43.29 | backward: 101.59 | allreduce: 9.01 | optimizer: 5.38 | bias in backward: 2.47 | dropout in backward: 1.83
 iteration       20/     100 | elapsed time per iteration (ms): 149.9 | learning rate: 4.040E-08 | lm loss: 1.046340E+01 | sop loss: 7.357370E-01 | loss scale: 131072.0 |
time (ms) | total time: 149.58 | forward: 41.68 | backward: 100.67 | allreduce: 8.75 | optimizer: 5.36 | bias in backward: 2.51 | dropout in backward: 1.95
 iteration       21/     100 | elapsed time per iteration (ms): 153.4 | learning rate: 5.051E-08 | lm loss: 1.056324E+01 | sop loss: 6.978797E-01 | loss scale: 131072.0 |
time (ms) | total time: 153.11 | forward: 46.04 | backward: 99.92 | allreduce: 8.70 | optimizer: 5.38 | bias in backward: 2.28 | dropout in backward: 1.77
 iteration       22/     100 | elapsed time per iteration (ms): 116.4 | learning rate: 5.051E-08 | lm loss: 1.058110E+01 | sop loss: 7.967921E-01 | loss scale: 65536.0 |
time (ms) | total time: 116.15 | forward: 41.64 | backward: 72.56 | allreduce: 10.48 | optimizer: 0.03 | bias in backward: 2.44 | dropout in backward: 1.97
 iteration       23/     100 | elapsed time per iteration (ms): 146.0 | learning rate: 6.061E-08 | lm loss: 1.057559E+01 | sop loss: 6.555985E-01 | loss scale: 65536.0 |
time (ms) | total time: 145.71 | forward: 38.75 | backward: 99.76 | allreduce: 8.82 | optimizer: 5.36 | bias in backward: 2.44 | dropout in backward: 1.82
 iteration       24/     100 | elapsed time per iteration (ms): 148.9 | learning rate: 7.071E-08 | lm loss: 1.052358E+01 | sop loss: 8.583734E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.56 | forward: 41.15 | backward: 100.31 | allreduce: 8.74 | optimizer: 5.35 | bias in backward: 2.45 | dropout in backward: 1.85
 iteration       25/     100 | elapsed time per iteration (ms): 149.2 | learning rate: 8.081E-08 | lm loss: 1.049826E+01 | sop loss: 6.898242E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.94 | forward: 41.41 | backward: 100.47 | allreduce: 8.76 | optimizer: 5.35 | bias in backward: 2.47 | dropout in backward: 1.93
 iteration       26/     100 | elapsed time per iteration (ms): 151.5 | learning rate: 9.091E-08 | lm loss: 1.057103E+01 | sop loss: 5.605674E-01 | loss scale: 65536.0 |
time (ms) | total time: 151.17 | forward: 41.19 | backward: 102.48 | allreduce: 9.11 | optimizer: 5.42 | bias in backward: 2.34 | dropout in backward: 1.81
 iteration       27/     100 | elapsed time per iteration (ms): 150.9 | learning rate: 1.010E-07 | lm loss: 1.062658E+01 | sop loss: 7.651152E-01 | loss scale: 65536.0 |
time (ms) | total time: 150.53 | forward: 42.54 | backward: 100.68 | allreduce: 8.86 | optimizer: 5.35 | bias in backward: 2.31 | dropout in backward: 1.77
 iteration       28/     100 | elapsed time per iteration (ms): 154.2 | learning rate: 1.111E-07 | lm loss: 1.050883E+01 | sop loss: 5.562647E-01 | loss scale: 65536.0 |
time (ms) | total time: 153.86 | forward: 46.85 | backward: 99.71 | allreduce: 8.67 | optimizer: 5.37 | bias in backward: 2.29 | dropout in backward: 1.76
 iteration       29/     100 | elapsed time per iteration (ms): 151.9 | learning rate: 1.212E-07 | lm loss: 1.056803E+01 | sop loss: 6.381745E-01 | loss scale: 65536.0 |
time (ms) | total time: 151.60 | forward: 43.56 | backward: 100.82 | allreduce: 8.85 | optimizer: 5.35 | bias in backward: 2.29 | dropout in backward: 1.77
 iteration       30/     100 | elapsed time per iteration (ms): 148.6 | learning rate: 1.313E-07 | lm loss: 1.050583E+01 | sop loss: 7.037164E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.29 | forward: 41.11 | backward: 100.06 | allreduce: 8.69 | optimizer: 5.35 | bias in backward: 2.41 | dropout in backward: 1.81
 iteration       31/     100 | elapsed time per iteration (ms): 149.7 | learning rate: 1.414E-07 | lm loss: 1.051977E+01 | sop loss: 8.590894E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.42 | forward: 42.03 | backward: 100.33 | allreduce: 8.70 | optimizer: 5.37 | bias in backward: 2.32 | dropout in backward: 1.79
 iteration       32/     100 | elapsed time per iteration (ms): 148.1 | learning rate: 1.515E-07 | lm loss: 1.053078E+01 | sop loss: 7.592310E-01 | loss scale: 65536.0 |
time (ms) | total time: 147.81 | forward: 40.92 | backward: 99.86 | allreduce: 8.62 | optimizer: 5.33 | bias in backward: 2.41 | dropout in backward: 1.84
 iteration       33/     100 | elapsed time per iteration (ms): 148.5 | learning rate: 1.616E-07 | lm loss: 1.046695E+01 | sop loss: 8.123014E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.23 | forward: 41.05 | backward: 100.07 | allreduce: 8.66 | optimizer: 5.34 | bias in backward: 2.30 | dropout in backward: 1.77
 iteration       34/     100 | elapsed time per iteration (ms): 148.6 | learning rate: 1.717E-07 | lm loss: 1.050910E+01 | sop loss: 8.835081E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.34 | forward: 41.25 | backward: 99.93 | allreduce: 8.67 | optimizer: 5.36 | bias in backward: 2.42 | dropout in backward: 1.87
 iteration       35/     100 | elapsed time per iteration (ms): 149.2 | learning rate: 1.818E-07 | lm loss: 1.064132E+01 | sop loss: 6.876231E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.85 | forward: 41.35 | backward: 100.37 | allreduce: 8.63 | optimizer: 5.34 | bias in backward: 2.49 | dropout in backward: 1.87
 iteration       36/     100 | elapsed time per iteration (ms): 149.3 | learning rate: 1.919E-07 | lm loss: 1.057390E+01 | sop loss: 7.815434E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.01 | forward: 41.65 | backward: 100.16 | allreduce: 8.65 | optimizer: 5.38 | bias in backward: 2.42 | dropout in backward: 1.79
 iteration       37/     100 | elapsed time per iteration (ms): 151.3 | learning rate: 2.020E-07 | lm loss: 1.046958E+01 | sop loss: 8.571534E-01 | loss scale: 65536.0 |
time (ms) | total time: 151.02 | forward: 42.90 | backward: 100.86 | allreduce: 8.89 | optimizer: 5.36 | bias in backward: 2.56 | dropout in backward: 1.90
 iteration       38/     100 | elapsed time per iteration (ms): 148.9 | learning rate: 2.121E-07 | lm loss: 1.049300E+01 | sop loss: 6.293994E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.57 | forward: 41.07 | backward: 100.01 | allreduce: 8.70 | optimizer: 5.40 | bias in backward: 2.54 | dropout in backward: 1.79
 iteration       39/     100 | elapsed time per iteration (ms): 150.2 | learning rate: 2.222E-07 | lm loss: 1.052986E+01 | sop loss: 7.686269E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.91 | forward: 42.17 | backward: 100.42 | allreduce: 8.85 | optimizer: 5.35 | bias in backward: 2.45 | dropout in backward: 1.82
 iteration       40/     100 | elapsed time per iteration (ms): 149.2 | learning rate: 2.323E-07 | lm loss: 1.055058E+01 | sop loss: 7.184448E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.93 | forward: 41.34 | backward: 100.38 | allreduce: 8.69 | optimizer: 5.36 | bias in backward: 2.55 | dropout in backward: 1.89
 iteration       41/     100 | elapsed time per iteration (ms): 148.8 | learning rate: 2.424E-07 | lm loss: 1.058343E+01 | sop loss: 7.832785E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.57 | forward: 41.64 | backward: 99.87 | allreduce: 8.66 | optimizer: 5.35 | bias in backward: 2.29 | dropout in backward: 1.78
 iteration       42/     100 | elapsed time per iteration (ms): 148.6 | learning rate: 2.525E-07 | lm loss: 1.052928E+01 | sop loss: 7.398630E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.33 | forward: 40.88 | backward: 100.24 | allreduce: 8.67 | optimizer: 5.34 | bias in backward: 2.28 | dropout in backward: 1.76
 iteration       43/     100 | elapsed time per iteration (ms): 148.9 | learning rate: 2.626E-07 | lm loss: 1.043250E+01 | sop loss: 7.760450E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.59 | forward: 41.23 | backward: 100.20 | allreduce: 8.67 | optimizer: 5.34 | bias in backward: 2.28 | dropout in backward: 1.76
 iteration       44/     100 | elapsed time per iteration (ms): 148.3 | learning rate: 2.727E-07 | lm loss: 1.050553E+01 | sop loss: 7.202720E-01 | loss scale: 65536.0 |
time (ms) | total time: 147.99 | forward: 41.33 | backward: 99.58 | allreduce: 8.67 | optimizer: 5.37 | bias in backward: 2.28 | dropout in backward: 1.77
 iteration       45/     100 | elapsed time per iteration (ms): 148.0 | learning rate: 2.828E-07 | lm loss: 1.062196E+01 | sop loss: 7.515614E-01 | loss scale: 65536.0 |
time (ms) | total time: 147.77 | forward: 40.86 | backward: 99.88 | allreduce: 8.66 | optimizer: 5.34 | bias in backward: 2.52 | dropout in backward: 1.81
 iteration       46/     100 | elapsed time per iteration (ms): 148.5 | learning rate: 2.929E-07 | lm loss: 1.044067E+01 | sop loss: 7.264886E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.15 | forward: 40.84 | backward: 100.19 | allreduce: 8.60 | optimizer: 5.34 | bias in backward: 2.28 | dropout in backward: 1.76
 iteration       47/     100 | elapsed time per iteration (ms): 148.9 | learning rate: 3.030E-07 | lm loss: 1.058774E+01 | sop loss: 6.411215E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.61 | forward: 41.39 | backward: 100.15 | allreduce: 8.71 | optimizer: 5.34 | bias in backward: 2.48 | dropout in backward: 1.92
 iteration       48/     100 | elapsed time per iteration (ms): 160.0 | learning rate: 3.131E-07 | lm loss: 1.053060E+01 | sop loss: 6.479551E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.73 | forward: 41.04 | backward: 108.70 | allreduce: 8.85 | optimizer: 7.84 | bias in backward: 2.42 | dropout in backward: 1.85
 iteration       49/     100 | elapsed time per iteration (ms): 148.5 | learning rate: 3.232E-07 | lm loss: 1.049693E+01 | sop loss: 7.068239E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.23 | forward: 38.82 | backward: 101.69 | allreduce: 9.16 | optimizer: 5.39 | bias in backward: 2.30 | dropout in backward: 1.76
 iteration       50/     100 | elapsed time per iteration (ms): 150.0 | learning rate: 3.333E-07 | lm loss: 1.050311E+01 | sop loss: 6.935577E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.72 | forward: 42.08 | backward: 100.37 | allreduce: 8.72 | optimizer: 5.37 | bias in backward: 2.44 | dropout in backward: 1.82
 iteration       51/     100 | elapsed time per iteration (ms): 148.4 | learning rate: 3.434E-07 | lm loss: 1.038925E+01 | sop loss: 7.159736E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.16 | forward: 40.89 | backward: 100.19 | allreduce: 8.64 | optimizer: 5.34 | bias in backward: 2.57 | dropout in backward: 1.79
 iteration       52/     100 | elapsed time per iteration (ms): 148.2 | learning rate: 3.535E-07 | lm loss: 1.043560E+01 | sop loss: 5.863186E-01 | loss scale: 65536.0 |
time (ms) | total time: 147.91 | forward: 40.87 | backward: 99.89 | allreduce: 8.67 | optimizer: 5.34 | bias in backward: 2.30 | dropout in backward: 1.78
 iteration       53/     100 | elapsed time per iteration (ms): 148.1 | learning rate: 3.636E-07 | lm loss: 1.051722E+01 | sop loss: 6.959587E-01 | loss scale: 65536.0 |
time (ms) | total time: 147.86 | forward: 40.93 | backward: 99.98 | allreduce: 8.63 | optimizer: 5.36 | bias in backward: 2.48 | dropout in backward: 1.82
 iteration       54/     100 | elapsed time per iteration (ms): 149.2 | learning rate: 3.737E-07 | lm loss: 1.047663E+01 | sop loss: 7.374359E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.94 | forward: 41.65 | backward: 100.25 | allreduce: 8.67 | optimizer: 5.34 | bias in backward: 2.28 | dropout in backward: 1.79
 iteration       55/     100 | elapsed time per iteration (ms): 148.5 | learning rate: 3.838E-07 | lm loss: 1.042649E+01 | sop loss: 7.847754E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.22 | forward: 41.08 | backward: 100.10 | allreduce: 8.71 | optimizer: 5.35 | bias in backward: 2.39 | dropout in backward: 1.80
 iteration       56/     100 | elapsed time per iteration (ms): 149.0 | learning rate: 3.939E-07 | lm loss: 1.044428E+01 | sop loss: 6.915731E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.71 | forward: 40.97 | backward: 100.69 | allreduce: 8.61 | optimizer: 5.35 | bias in backward: 2.41 | dropout in backward: 1.89
 iteration       57/     100 | elapsed time per iteration (ms): 150.1 | learning rate: 4.040E-07 | lm loss: 1.041183E+01 | sop loss: 6.466221E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.88 | forward: 42.34 | backward: 100.45 | allreduce: 8.74 | optimizer: 5.34 | bias in backward: 2.43 | dropout in backward: 1.97
 iteration       58/     100 | elapsed time per iteration (ms): 149.1 | learning rate: 4.141E-07 | lm loss: 1.045382E+01 | sop loss: 7.954780E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.80 | forward: 41.01 | backward: 100.34 | allreduce: 8.62 | optimizer: 5.40 | bias in backward: 2.28 | dropout in backward: 1.76
 iteration       59/     100 | elapsed time per iteration (ms): 149.7 | learning rate: 4.242E-07 | lm loss: 1.047282E+01 | sop loss: 6.808672E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.37 | forward: 41.91 | backward: 100.11 | allreduce: 8.79 | optimizer: 5.37 | bias in backward: 2.31 | dropout in backward: 1.76
 iteration       60/     100 | elapsed time per iteration (ms): 149.4 | learning rate: 4.343E-07 | lm loss: 1.046495E+01 | sop loss: 7.887868E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.10 | forward: 41.49 | backward: 100.35 | allreduce: 8.75 | optimizer: 5.36 | bias in backward: 2.28 | dropout in backward: 1.76
 iteration       61/     100 | elapsed time per iteration (ms): 149.2 | learning rate: 4.444E-07 | lm loss: 1.040860E+01 | sop loss: 6.032709E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.95 | forward: 41.69 | backward: 100.08 | allreduce: 8.72 | optimizer: 5.39 | bias in backward: 2.28 | dropout in backward: 1.75
 iteration       62/     100 | elapsed time per iteration (ms): 148.4 | learning rate: 4.545E-07 | lm loss: 1.050656E+01 | sop loss: 6.549652E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.10 | forward: 41.01 | backward: 100.03 | allreduce: 8.68 | optimizer: 5.34 | bias in backward: 2.30 | dropout in backward: 1.78
 iteration       63/     100 | elapsed time per iteration (ms): 147.9 | learning rate: 4.646E-07 | lm loss: 1.038697E+01 | sop loss: 6.899042E-01 | loss scale: 65536.0 |
time (ms) | total time: 147.66 | forward: 41.10 | backward: 99.54 | allreduce: 8.65 | optimizer: 5.35 | bias in backward: 2.28 | dropout in backward: 1.76
 iteration       64/     100 | elapsed time per iteration (ms): 148.2 | learning rate: 4.747E-07 | lm loss: 1.046197E+01 | sop loss: 6.640087E-01 | loss scale: 65536.0 |
time (ms) | total time: 147.99 | forward: 40.89 | backward: 100.04 | allreduce: 8.62 | optimizer: 5.34 | bias in backward: 2.49 | dropout in backward: 1.86
 iteration       65/     100 | elapsed time per iteration (ms): 148.2 | learning rate: 4.848E-07 | lm loss: 1.031270E+01 | sop loss: 7.825624E-01 | loss scale: 65536.0 |
time (ms) | total time: 147.90 | forward: 41.14 | backward: 99.61 | allreduce: 8.62 | optimizer: 5.34 | bias in backward: 2.30 | dropout in backward: 1.77
 iteration       66/     100 | elapsed time per iteration (ms): 149.5 | learning rate: 4.949E-07 | lm loss: 1.037350E+01 | sop loss: 7.744198E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.26 | forward: 41.46 | backward: 100.60 | allreduce: 8.94 | optimizer: 5.38 | bias in backward: 2.28 | dropout in backward: 1.77
 iteration       67/     100 | elapsed time per iteration (ms): 153.1 | learning rate: 5.051E-07 | lm loss: 1.050864E+01 | sop loss: 7.367274E-01 | loss scale: 65536.0 |
time (ms) | total time: 152.75 | forward: 41.43 | backward: 103.49 | allreduce: 9.25 | optimizer: 5.42 | bias in backward: 2.75 | dropout in backward: 2.04
 iteration       68/     100 | elapsed time per iteration (ms): 152.2 | learning rate: 5.152E-07 | lm loss: 1.043375E+01 | sop loss: 8.264478E-01 | loss scale: 65536.0 |
time (ms) | total time: 151.79 | forward: 42.80 | backward: 101.03 | allreduce: 9.27 | optimizer: 5.39 | bias in backward: 2.54 | dropout in backward: 1.89
 iteration       69/     100 | elapsed time per iteration (ms): 149.9 | learning rate: 5.253E-07 | lm loss: 1.043361E+01 | sop loss: 7.587292E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.50 | forward: 40.67 | backward: 100.95 | allreduce: 9.25 | optimizer: 5.43 | bias in backward: 2.45 | dropout in backward: 1.80
 iteration       70/     100 | elapsed time per iteration (ms): 150.1 | learning rate: 5.354E-07 | lm loss: 1.036143E+01 | sop loss: 6.824837E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.76 | forward: 41.63 | backward: 100.68 | allreduce: 8.91 | optimizer: 5.36 | bias in backward: 2.35 | dropout in backward: 1.89
 iteration       71/     100 | elapsed time per iteration (ms): 148.5 | learning rate: 5.455E-07 | lm loss: 1.041363E+01 | sop loss: 7.069305E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.18 | forward: 40.85 | backward: 100.20 | allreduce: 8.72 | optimizer: 5.33 | bias in backward: 2.52 | dropout in backward: 1.81
 iteration       72/     100 | elapsed time per iteration (ms): 158.5 | learning rate: 5.556E-07 | lm loss: 1.041887E+01 | sop loss: 6.138300E-01 | loss scale: 65536.0 |
time (ms) | total time: 158.16 | forward: 41.19 | backward: 109.45 | allreduce: 11.73 | optimizer: 5.38 | bias in backward: 3.54 | dropout in backward: 2.56
 iteration       73/     100 | elapsed time per iteration (ms): 149.3 | learning rate: 5.657E-07 | lm loss: 1.027990E+01 | sop loss: 6.625687E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.00 | forward: 41.56 | backward: 100.29 | allreduce: 8.71 | optimizer: 5.34 | bias in backward: 2.28 | dropout in backward: 1.76
 iteration       74/     100 | elapsed time per iteration (ms): 154.7 | learning rate: 5.758E-07 | lm loss: 1.037298E+01 | sop loss: 6.768419E-01 | loss scale: 65536.0 |
time (ms) | total time: 154.39 | forward: 41.39 | backward: 105.94 | allreduce: 8.72 | optimizer: 5.36 | bias in backward: 3.48 | dropout in backward: 2.41
 iteration       75/     100 | elapsed time per iteration (ms): 148.2 | learning rate: 5.859E-07 | lm loss: 1.028730E+01 | sop loss: 6.791278E-01 | loss scale: 65536.0 |
time (ms) | total time: 147.91 | forward: 40.96 | backward: 99.89 | allreduce: 8.69 | optimizer: 5.34 | bias in backward: 2.51 | dropout in backward: 2.02
 iteration       76/     100 | elapsed time per iteration (ms): 159.4 | learning rate: 5.960E-07 | lm loss: 1.040753E+01 | sop loss: 5.956942E-01 | loss scale: 65536.0 |
time (ms) | total time: 159.10 | forward: 41.06 | backward: 110.71 | allreduce: 9.04 | optimizer: 5.37 | bias in backward: 3.41 | dropout in backward: 2.41
 iteration       77/     100 | elapsed time per iteration (ms): 150.7 | learning rate: 6.061E-07 | lm loss: 1.035178E+01 | sop loss: 5.987488E-01 | loss scale: 65536.0 |
time (ms) | total time: 150.35 | forward: 41.81 | backward: 101.32 | allreduce: 8.83 | optimizer: 5.37 | bias in backward: 2.61 | dropout in backward: 1.94
 iteration       78/     100 | elapsed time per iteration (ms): 149.9 | learning rate: 6.162E-07 | lm loss: 1.039205E+01 | sop loss: 6.858418E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.64 | forward: 42.31 | backward: 100.26 | allreduce: 8.76 | optimizer: 5.35 | bias in backward: 2.38 | dropout in backward: 1.84
 iteration       79/     100 | elapsed time per iteration (ms): 151.2 | learning rate: 6.263E-07 | lm loss: 1.037326E+01 | sop loss: 5.695107E-01 | loss scale: 65536.0 |
time (ms) | total time: 150.93 | forward: 41.81 | backward: 101.53 | allreduce: 9.25 | optimizer: 5.38 | bias in backward: 2.50 | dropout in backward: 1.84
 iteration       80/     100 | elapsed time per iteration (ms): 148.9 | learning rate: 6.364E-07 | lm loss: 1.035119E+01 | sop loss: 5.971473E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.67 | forward: 40.95 | backward: 100.01 | allreduce: 9.12 | optimizer: 5.35 | bias in backward: 2.34 | dropout in backward: 1.78
 iteration       81/     100 | elapsed time per iteration (ms): 149.7 | learning rate: 6.465E-07 | lm loss: 1.027712E+01 | sop loss: 6.403747E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.45 | forward: 40.49 | backward: 101.11 | allreduce: 9.50 | optimizer: 5.42 | bias in backward: 2.50 | dropout in backward: 1.81
 iteration       82/     100 | elapsed time per iteration (ms): 149.9 | learning rate: 6.566E-07 | lm loss: 1.031592E+01 | sop loss: 7.118219E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.57 | forward: 40.99 | backward: 100.80 | allreduce: 9.14 | optimizer: 5.35 | bias in backward: 2.61 | dropout in backward: 1.82
 iteration       83/     100 | elapsed time per iteration (ms): 148.6 | learning rate: 6.667E-07 | lm loss: 1.034600E+01 | sop loss: 6.634474E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.28 | forward: 40.99 | backward: 99.64 | allreduce: 9.04 | optimizer: 5.35 | bias in backward: 2.35 | dropout in backward: 1.79
 iteration       84/     100 | elapsed time per iteration (ms): 149.2 | learning rate: 6.768E-07 | lm loss: 1.043535E+01 | sop loss: 6.920005E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.89 | forward: 40.41 | backward: 100.80 | allreduce: 9.24 | optimizer: 5.39 | bias in backward: 2.50 | dropout in backward: 1.92
 iteration       85/     100 | elapsed time per iteration (ms): 149.1 | learning rate: 6.869E-07 | lm loss: 1.041737E+01 | sop loss: 5.708122E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.86 | forward: 40.91 | backward: 100.20 | allreduce: 9.06 | optimizer: 5.35 | bias in backward: 2.54 | dropout in backward: 1.84
 iteration       86/     100 | elapsed time per iteration (ms): 148.3 | learning rate: 6.970E-07 | lm loss: 1.034773E+01 | sop loss: 7.089013E-01 | loss scale: 65536.0 |
time (ms) | total time: 147.98 | forward: 40.24 | backward: 100.09 | allreduce: 9.04 | optimizer: 5.34 | bias in backward: 2.33 | dropout in backward: 1.80
 iteration       87/     100 | elapsed time per iteration (ms): 149.3 | learning rate: 7.071E-07 | lm loss: 1.037769E+01 | sop loss: 6.614321E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.99 | forward: 41.27 | backward: 100.07 | allreduce: 9.04 | optimizer: 5.35 | bias in backward: 2.31 | dropout in backward: 1.78
 iteration       88/     100 | elapsed time per iteration (ms): 147.5 | learning rate: 7.172E-07 | lm loss: 1.021322E+01 | sop loss: 7.183324E-01 | loss scale: 65536.0 |
time (ms) | total time: 147.26 | forward: 40.03 | backward: 100.13 | allreduce: 8.68 | optimizer: 5.35 | bias in backward: 2.47 | dropout in backward: 1.82
 iteration       89/     100 | elapsed time per iteration (ms): 150.1 | learning rate: 7.273E-07 | lm loss: 1.029717E+01 | sop loss: 5.809422E-01 | loss scale: 65536.0 |
time (ms) | total time: 149.80 | forward: 40.72 | backward: 101.64 | allreduce: 8.64 | optimizer: 5.40 | bias in backward: 2.42 | dropout in backward: 1.89
 iteration       90/     100 | elapsed time per iteration (ms): 151.0 | learning rate: 7.374E-07 | lm loss: 1.037590E+01 | sop loss: 4.705686E-01 | loss scale: 65536.0 |
time (ms) | total time: 150.64 | forward: 41.94 | backward: 101.20 | allreduce: 9.14 | optimizer: 5.36 | bias in backward: 2.48 | dropout in backward: 1.84
 iteration       91/     100 | elapsed time per iteration (ms): 148.8 | learning rate: 7.475E-07 | lm loss: 1.028394E+01 | sop loss: 1.037406E+00 | loss scale: 65536.0 |
time (ms) | total time: 148.55 | forward: 41.67 | backward: 99.76 | allreduce: 11.04 | optimizer: 5.35 | bias in backward: 2.28 | dropout in backward: 1.76
 iteration       92/     100 | elapsed time per iteration (ms): 155.8 | learning rate: 7.576E-07 | lm loss: 1.019831E+01 | sop loss: 6.901798E-01 | loss scale: 65536.0 |
time (ms) | total time: 155.58 | forward: 40.97 | backward: 107.54 | allreduce: 8.61 | optimizer: 5.36 | bias in backward: 3.60 | dropout in backward: 2.54
 iteration       93/     100 | elapsed time per iteration (ms): 148.5 | learning rate: 7.677E-07 | lm loss: 1.028015E+01 | sop loss: 6.445349E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.27 | forward: 41.10 | backward: 100.10 | allreduce: 8.62 | optimizer: 5.35 | bias in backward: 2.29 | dropout in backward: 1.76
 iteration       94/     100 | elapsed time per iteration (ms): 155.9 | learning rate: 7.778E-07 | lm loss: 1.039416E+01 | sop loss: 7.499978E-01 | loss scale: 65536.0 |
time (ms) | total time: 155.63 | forward: 40.85 | backward: 107.74 | allreduce: 8.61 | optimizer: 5.32 | bias in backward: 3.60 | dropout in backward: 2.57
 iteration       95/     100 | elapsed time per iteration (ms): 148.3 | learning rate: 7.879E-07 | lm loss: 1.024246E+01 | sop loss: 5.289961E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.01 | forward: 41.05 | backward: 99.96 | allreduce: 8.67 | optimizer: 5.33 | bias in backward: 2.54 | dropout in backward: 1.83
 iteration       96/     100 | elapsed time per iteration (ms): 172.1 | learning rate: 7.980E-07 | lm loss: 1.030677E+01 | sop loss: 8.412776E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.84 | forward: 42.68 | backward: 121.66 | allreduce: 34.56 | optimizer: 5.37 | bias in backward: 2.54 | dropout in backward: 2.09
 iteration       97/     100 | elapsed time per iteration (ms): 150.9 | learning rate: 8.081E-07 | lm loss: 1.015704E+01 | sop loss: 9.188752E-01 | loss scale: 65536.0 |
time (ms) | total time: 150.59 | forward: 42.60 | backward: 100.59 | allreduce: 8.78 | optimizer: 5.36 | bias in backward: 2.34 | dropout in backward: 1.82
 iteration       98/     100 | elapsed time per iteration (ms): 149.2 | learning rate: 8.182E-07 | lm loss: 1.034685E+01 | sop loss: 5.517856E-01 | loss scale: 65536.0 |
time (ms) | total time: 148.90 | forward: 42.05 | backward: 99.60 | allreduce: 8.67 | optimizer: 5.35 | bias in backward: 2.27 | dropout in backward: 1.75
 iteration       99/     100 | elapsed time per iteration (ms): 170.4 | learning rate: 8.283E-07 | lm loss: 1.017954E+01 | sop loss: 9.473163E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.07 | forward: 41.83 | backward: 120.78 | allreduce: 8.70 | optimizer: 5.42 | bias in backward: 2.39 | dropout in backward: 1.94
 iteration      100/     100 | elapsed time per iteration (ms): 150.4 | learning rate: 8.384E-07 | lm loss: 1.021175E+01 | sop loss: 5.438882E-01 | loss scale: 65536.0 |
time (ms) | total time: 150.04 | forward: 41.46 | backward: 101.02 | allreduce: 8.79 | optimizer: 5.38 | bias in backward: 2.51 | dropout in backward: 1.84
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

8

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.101663 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_800mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.004 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_800mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_800mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3498.02 | train/valid/test data iterators: 2207.69
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 2682.0 | learning rate: 0.000E+00 | lm loss: 1.057139E+01 | sop loss: 8.339909E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 691.09228515625 | max allocated: 4921.64599609375 | cached: 5218.0 | max cached: 5218.0
time (ms) | total time: 2681.78 | forward: 2145.44 | backward: 382.58 | allreduce: 13.33 | optimizer: 0.05 | bias in backward: 25.76 | dropout in backward: 2.44
 iteration        2/     100 | elapsed time per iteration (ms): 131.5 | learning rate: 0.000E+00 | lm loss: 1.044129E+01 | sop loss: 9.387518E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 129.78 | forward: 46.74 | backward: 80.58 | allreduce: 10.08 | optimizer: 0.04 | bias in backward: 2.41 | dropout in backward: 2.42
 iteration        3/     100 | elapsed time per iteration (ms): 135.6 | learning rate: 0.000E+00 | lm loss: 1.055155E+01 | sop loss: 6.269439E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 135.31 | forward: 49.15 | backward: 83.33 | allreduce: 9.44 | optimizer: 0.04 | bias in backward: 2.44 | dropout in backward: 2.51
 iteration        4/     100 | elapsed time per iteration (ms): 130.6 | learning rate: 0.000E+00 | lm loss: 1.049546E+01 | sop loss: 6.466321E-01 | loss scale: 536870912.0 |
time (ms) | total time: 130.28 | forward: 46.81 | backward: 80.81 | allreduce: 9.95 | optimizer: 0.04 | bias in backward: 2.42 | dropout in backward: 2.40
 iteration        5/     100 | elapsed time per iteration (ms): 131.0 | learning rate: 0.000E+00 | lm loss: 1.059929E+01 | sop loss: 6.999204E-01 | loss scale: 268435456.0 |
time (ms) | total time: 130.67 | forward: 47.29 | backward: 80.57 | allreduce: 9.39 | optimizer: 0.04 | bias in backward: 2.53 | dropout in backward: 2.49
 iteration        6/     100 | elapsed time per iteration (ms): 129.7 | learning rate: 0.000E+00 | lm loss: 1.056037E+01 | sop loss: 7.066501E-01 | loss scale: 134217728.0 |
time (ms) | total time: 129.42 | forward: 46.95 | backward: 80.12 | allreduce: 9.48 | optimizer: 0.03 | bias in backward: 2.41 | dropout in backward: 2.40
 iteration        7/     100 | elapsed time per iteration (ms): 130.6 | learning rate: 0.000E+00 | lm loss: 1.058491E+01 | sop loss: 8.401177E-01 | loss scale: 67108864.0 |
time (ms) | total time: 130.28 | forward: 48.00 | backward: 79.72 | allreduce: 9.23 | optimizer: 0.03 | bias in backward: 2.47 | dropout in backward: 2.45
 iteration        8/     100 | elapsed time per iteration (ms): 129.0 | learning rate: 0.000E+00 | lm loss: 1.050702E+01 | sop loss: 7.583494E-01 | loss scale: 33554432.0 |
time (ms) | total time: 128.72 | forward: 46.73 | backward: 79.53 | allreduce: 10.71 | optimizer: 0.03 | bias in backward: 2.41 | dropout in backward: 2.39
 iteration        9/     100 | elapsed time per iteration (ms): 129.6 | learning rate: 0.000E+00 | lm loss: 1.050798E+01 | sop loss: 7.541428E-01 | loss scale: 16777216.0 |
time (ms) | total time: 129.30 | forward: 47.11 | backward: 79.65 | allreduce: 9.15 | optimizer: 0.03 | bias in backward: 2.54 | dropout in backward: 2.43
 iteration       10/     100 | elapsed time per iteration (ms): 129.6 | learning rate: 0.000E+00 | lm loss: 1.056716E+01 | sop loss: 7.566175E-01 | loss scale: 8388608.0 |
time (ms) | total time: 129.36 | forward: 46.39 | backward: 80.50 | allreduce: 9.36 | optimizer: 0.03 | bias in backward: 2.54 | dropout in backward: 2.46
 iteration       11/     100 | elapsed time per iteration (ms): 129.5 | learning rate: 0.000E+00 | lm loss: 1.058296E+01 | sop loss: 7.352783E-01 | loss scale: 4194304.0 |
time (ms) | total time: 129.14 | forward: 46.59 | backward: 79.94 | allreduce: 9.68 | optimizer: 0.04 | bias in backward: 2.41 | dropout in backward: 2.40
 iteration       12/     100 | elapsed time per iteration (ms): 129.5 | learning rate: 0.000E+00 | lm loss: 1.051050E+01 | sop loss: 6.306974E-01 | loss scale: 2097152.0 |
time (ms) | total time: 129.17 | forward: 46.24 | backward: 80.37 | allreduce: 9.63 | optimizer: 0.03 | bias in backward: 2.72 | dropout in backward: 2.49
 iteration       13/     100 | elapsed time per iteration (ms): 128.7 | learning rate: 0.000E+00 | lm loss: 1.058182E+01 | sop loss: 7.813334E-01 | loss scale: 1048576.0 |
time (ms) | total time: 128.24 | forward: 46.58 | backward: 79.22 | allreduce: 9.22 | optimizer: 0.03 | bias in backward: 2.40 | dropout in backward: 2.39
 iteration       14/     100 | elapsed time per iteration (ms): 131.6 | learning rate: 0.000E+00 | lm loss: 1.055017E+01 | sop loss: 6.637877E-01 | loss scale: 524288.0 |
time (ms) | total time: 131.24 | forward: 47.37 | backward: 80.41 | allreduce: 11.32 | optimizer: 0.04 | bias in backward: 2.39 | dropout in backward: 2.40
 iteration       15/     100 | elapsed time per iteration (ms): 136.5 | learning rate: 0.000E+00 | lm loss: 1.057349E+01 | sop loss: 7.352324E-01 | loss scale: 262144.0 |
time (ms) | total time: 136.20 | forward: 47.12 | backward: 87.01 | allreduce: 9.14 | optimizer: 0.03 | bias in backward: 2.56 | dropout in backward: 2.47
 iteration       16/     100 | elapsed time per iteration (ms): 138.3 | learning rate: 0.000E+00 | lm loss: 1.055573E+01 | sop loss: 7.627271E-01 | loss scale: 131072.0 |
time (ms) | total time: 138.02 | forward: 47.29 | backward: 88.92 | allreduce: 8.80 | optimizer: 0.03 | bias in backward: 2.49 | dropout in backward: 2.49
 iteration       17/     100 | elapsed time per iteration (ms): 312.5 | learning rate: 1.010E-08 | lm loss: 1.059040E+01 | sop loss: 6.818453E-01 | loss scale: 131072.0 |
time (ms) | total time: 312.21 | forward: 46.81 | backward: 159.28 | allreduce: 8.73 | optimizer: 104.37 | bias in backward: 2.49 | dropout in backward: 2.41
 iteration       18/     100 | elapsed time per iteration (ms): 232.8 | learning rate: 2.020E-08 | lm loss: 1.051558E+01 | sop loss: 5.943501E-01 | loss scale: 131072.0 |
time (ms) | total time: 232.47 | forward: 104.11 | backward: 119.16 | allreduce: 9.23 | optimizer: 5.32 | bias in backward: 2.44 | dropout in backward: 2.50
 iteration       19/     100 | elapsed time per iteration (ms): 172.0 | learning rate: 3.030E-08 | lm loss: 1.059883E+01 | sop loss: 7.575934E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.73 | forward: 47.16 | backward: 117.37 | allreduce: 8.88 | optimizer: 5.33 | bias in backward: 2.54 | dropout in backward: 2.54
 iteration       20/     100 | elapsed time per iteration (ms): 172.2 | learning rate: 4.040E-08 | lm loss: 1.056662E+01 | sop loss: 9.368101E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.89 | forward: 47.41 | backward: 117.43 | allreduce: 8.76 | optimizer: 5.31 | bias in backward: 2.46 | dropout in backward: 2.41
 iteration       21/     100 | elapsed time per iteration (ms): 170.3 | learning rate: 5.051E-08 | lm loss: 1.058613E+01 | sop loss: 6.433234E-01 | loss scale: 131072.0 |
time (ms) | total time: 169.97 | forward: 46.80 | backward: 116.03 | allreduce: 8.77 | optimizer: 5.30 | bias in backward: 2.55 | dropout in backward: 2.46
 iteration       22/     100 | elapsed time per iteration (ms): 171.4 | learning rate: 6.061E-08 | lm loss: 1.054227E+01 | sop loss: 8.228316E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.12 | forward: 47.58 | backward: 116.71 | allreduce: 8.72 | optimizer: 5.29 | bias in backward: 2.35 | dropout in backward: 2.38
 iteration       23/     100 | elapsed time per iteration (ms): 171.4 | learning rate: 7.071E-08 | lm loss: 1.057940E+01 | sop loss: 7.134607E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.14 | forward: 46.98 | backward: 116.81 | allreduce: 9.37 | optimizer: 5.32 | bias in backward: 2.52 | dropout in backward: 2.45
 iteration       24/     100 | elapsed time per iteration (ms): 171.3 | learning rate: 8.081E-08 | lm loss: 1.055739E+01 | sop loss: 7.835291E-01 | loss scale: 131072.0 |
time (ms) | total time: 170.97 | forward: 47.18 | backward: 116.58 | allreduce: 8.84 | optimizer: 5.30 | bias in backward: 2.54 | dropout in backward: 2.46
 iteration       25/     100 | elapsed time per iteration (ms): 170.6 | learning rate: 9.091E-08 | lm loss: 1.057475E+01 | sop loss: 7.259322E-01 | loss scale: 131072.0 |
time (ms) | total time: 170.37 | forward: 46.74 | backward: 116.59 | allreduce: 8.73 | optimizer: 5.28 | bias in backward: 2.48 | dropout in backward: 2.41
 iteration       26/     100 | elapsed time per iteration (ms): 171.3 | learning rate: 1.010E-07 | lm loss: 1.056780E+01 | sop loss: 6.502716E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.05 | forward: 47.32 | backward: 116.79 | allreduce: 8.73 | optimizer: 5.28 | bias in backward: 2.34 | dropout in backward: 2.39
 iteration       27/     100 | elapsed time per iteration (ms): 170.1 | learning rate: 1.111E-07 | lm loss: 1.051612E+01 | sop loss: 7.056373E-01 | loss scale: 131072.0 |
time (ms) | total time: 169.76 | forward: 46.90 | backward: 115.83 | allreduce: 8.88 | optimizer: 5.28 | bias in backward: 2.51 | dropout in backward: 2.44
 iteration       28/     100 | elapsed time per iteration (ms): 172.0 | learning rate: 1.212E-07 | lm loss: 1.056589E+01 | sop loss: 6.415693E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.75 | forward: 47.85 | backward: 116.84 | allreduce: 9.01 | optimizer: 5.33 | bias in backward: 2.55 | dropout in backward: 2.45
 iteration       29/     100 | elapsed time per iteration (ms): 171.6 | learning rate: 1.313E-07 | lm loss: 1.053471E+01 | sop loss: 5.820190E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.37 | forward: 47.02 | backward: 117.18 | allreduce: 8.90 | optimizer: 5.33 | bias in backward: 2.49 | dropout in backward: 2.46
 iteration       30/     100 | elapsed time per iteration (ms): 171.2 | learning rate: 1.414E-07 | lm loss: 1.053175E+01 | sop loss: 7.115240E-01 | loss scale: 131072.0 |
time (ms) | total time: 170.89 | forward: 47.02 | backward: 116.59 | allreduce: 9.04 | optimizer: 5.31 | bias in backward: 2.47 | dropout in backward: 2.51
 iteration       31/     100 | elapsed time per iteration (ms): 170.6 | learning rate: 1.515E-07 | lm loss: 1.062188E+01 | sop loss: 7.279400E-01 | loss scale: 131072.0 |
time (ms) | total time: 170.23 | forward: 46.93 | backward: 116.21 | allreduce: 8.75 | optimizer: 5.27 | bias in backward: 2.52 | dropout in backward: 2.47
 iteration       32/     100 | elapsed time per iteration (ms): 177.3 | learning rate: 1.616E-07 | lm loss: 1.047686E+01 | sop loss: 7.018944E-01 | loss scale: 131072.0 |
time (ms) | total time: 177.05 | forward: 47.75 | backward: 121.92 | allreduce: 9.29 | optimizer: 5.39 | bias in backward: 2.36 | dropout in backward: 2.40
 iteration       33/     100 | elapsed time per iteration (ms): 173.9 | learning rate: 1.717E-07 | lm loss: 1.059629E+01 | sop loss: 7.881712E-01 | loss scale: 131072.0 |
time (ms) | total time: 173.61 | forward: 47.12 | backward: 118.89 | allreduce: 8.80 | optimizer: 5.31 | bias in backward: 2.45 | dropout in backward: 2.42
 iteration       34/     100 | elapsed time per iteration (ms): 173.5 | learning rate: 1.818E-07 | lm loss: 1.058032E+01 | sop loss: 7.688583E-01 | loss scale: 131072.0 |
time (ms) | total time: 173.23 | forward: 48.09 | backward: 118.18 | allreduce: 10.86 | optimizer: 5.30 | bias in backward: 2.36 | dropout in backward: 2.41
 iteration       35/     100 | elapsed time per iteration (ms): 175.5 | learning rate: 1.919E-07 | lm loss: 1.056599E+01 | sop loss: 8.100387E-01 | loss scale: 131072.0 |
time (ms) | total time: 175.26 | forward: 48.39 | backward: 117.71 | allreduce: 9.51 | optimizer: 7.06 | bias in backward: 2.41 | dropout in backward: 2.41
 iteration       36/     100 | elapsed time per iteration (ms): 171.7 | learning rate: 2.020E-07 | lm loss: 1.056895E+01 | sop loss: 6.984477E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.45 | forward: 46.97 | backward: 117.15 | allreduce: 8.83 | optimizer: 5.32 | bias in backward: 2.36 | dropout in backward: 2.38
 iteration       37/     100 | elapsed time per iteration (ms): 171.7 | learning rate: 2.121E-07 | lm loss: 1.060366E+01 | sop loss: 7.749457E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.43 | forward: 47.40 | backward: 117.07 | allreduce: 8.70 | optimizer: 5.29 | bias in backward: 2.43 | dropout in backward: 2.39
 iteration       38/     100 | elapsed time per iteration (ms): 173.2 | learning rate: 2.222E-07 | lm loss: 1.055224E+01 | sop loss: 7.035664E-01 | loss scale: 131072.0 |
time (ms) | total time: 172.84 | forward: 47.91 | backward: 117.74 | allreduce: 9.20 | optimizer: 5.36 | bias in backward: 2.50 | dropout in backward: 2.50
 iteration       39/     100 | elapsed time per iteration (ms): 171.6 | learning rate: 2.323E-07 | lm loss: 1.052568E+01 | sop loss: 6.226183E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.35 | forward: 47.21 | backward: 117.12 | allreduce: 10.36 | optimizer: 5.29 | bias in backward: 2.37 | dropout in backward: 2.39
 iteration       40/     100 | elapsed time per iteration (ms): 171.6 | learning rate: 2.424E-07 | lm loss: 1.054584E+01 | sop loss: 6.004426E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.30 | forward: 47.29 | backward: 116.70 | allreduce: 9.23 | optimizer: 5.37 | bias in backward: 2.59 | dropout in backward: 2.41
 iteration       41/     100 | elapsed time per iteration (ms): 172.8 | learning rate: 2.525E-07 | lm loss: 1.056814E+01 | sop loss: 7.326182E-01 | loss scale: 131072.0 |
time (ms) | total time: 172.49 | forward: 46.99 | backward: 118.17 | allreduce: 11.13 | optimizer: 5.33 | bias in backward: 2.40 | dropout in backward: 2.40
 iteration       42/     100 | elapsed time per iteration (ms): 171.5 | learning rate: 2.626E-07 | lm loss: 1.056058E+01 | sop loss: 7.327356E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.17 | forward: 47.35 | backward: 116.52 | allreduce: 8.80 | optimizer: 5.35 | bias in backward: 2.50 | dropout in backward: 2.54
 iteration       43/     100 | elapsed time per iteration (ms): 171.1 | learning rate: 2.727E-07 | lm loss: 1.059081E+01 | sop loss: 7.302988E-01 | loss scale: 131072.0 |
time (ms) | total time: 170.79 | forward: 47.02 | backward: 116.67 | allreduce: 8.79 | optimizer: 5.30 | bias in backward: 2.52 | dropout in backward: 2.62
 iteration       44/     100 | elapsed time per iteration (ms): 169.9 | learning rate: 2.828E-07 | lm loss: 1.049934E+01 | sop loss: 6.255041E-01 | loss scale: 131072.0 |
time (ms) | total time: 169.68 | forward: 47.14 | backward: 115.50 | allreduce: 8.85 | optimizer: 5.32 | bias in backward: 2.35 | dropout in backward: 2.39
 iteration       45/     100 | elapsed time per iteration (ms): 169.4 | learning rate: 2.929E-07 | lm loss: 1.055474E+01 | sop loss: 6.731700E-01 | loss scale: 131072.0 |
time (ms) | total time: 169.14 | forward: 46.49 | backward: 115.58 | allreduce: 8.75 | optimizer: 5.26 | bias in backward: 2.38 | dropout in backward: 2.40
 iteration       46/     100 | elapsed time per iteration (ms): 170.2 | learning rate: 3.030E-07 | lm loss: 1.057010E+01 | sop loss: 8.000235E-01 | loss scale: 131072.0 |
time (ms) | total time: 169.91 | forward: 47.15 | backward: 115.78 | allreduce: 8.75 | optimizer: 5.29 | bias in backward: 2.41 | dropout in backward: 2.41
 iteration       47/     100 | elapsed time per iteration (ms): 170.7 | learning rate: 3.131E-07 | lm loss: 1.053450E+01 | sop loss: 7.721481E-01 | loss scale: 131072.0 |
time (ms) | total time: 170.47 | forward: 47.31 | backward: 116.15 | allreduce: 8.79 | optimizer: 5.28 | bias in backward: 2.60 | dropout in backward: 2.43
 iteration       48/     100 | elapsed time per iteration (ms): 171.2 | learning rate: 3.232E-07 | lm loss: 1.056301E+01 | sop loss: 7.628757E-01 | loss scale: 131072.0 |
time (ms) | total time: 170.85 | forward: 47.12 | backward: 116.66 | allreduce: 8.72 | optimizer: 5.27 | bias in backward: 2.39 | dropout in backward: 2.40
 iteration       49/     100 | elapsed time per iteration (ms): 171.4 | learning rate: 3.333E-07 | lm loss: 1.060628E+01 | sop loss: 7.002217E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.12 | forward: 47.16 | backward: 116.63 | allreduce: 9.08 | optimizer: 5.34 | bias in backward: 2.43 | dropout in backward: 2.41
 iteration       50/     100 | elapsed time per iteration (ms): 171.4 | learning rate: 3.434E-07 | lm loss: 1.057061E+01 | sop loss: 5.896216E-01 | loss scale: 131072.0 |
time (ms) | total time: 171.14 | forward: 47.24 | backward: 116.71 | allreduce: 8.83 | optimizer: 5.31 | bias in backward: 2.48 | dropout in backward: 2.43
 iteration       51/     100 | elapsed time per iteration (ms): 170.4 | learning rate: 3.535E-07 | lm loss: 1.056603E+01 | sop loss: 7.723346E-01 | loss scale: 131072.0 |
time (ms) | total time: 170.09 | forward: 47.17 | backward: 115.85 | allreduce: 8.82 | optimizer: 5.28 | bias in backward: 2.48 | dropout in backward: 2.48
 iteration       52/     100 | elapsed time per iteration (ms): 174.8 | learning rate: 3.636E-07 | lm loss: 1.055173E+01 | sop loss: 6.339190E-01 | loss scale: 131072.0 |
time (ms) | total time: 174.49 | forward: 47.39 | backward: 119.69 | allreduce: 9.21 | optimizer: 5.36 | bias in backward: 2.48 | dropout in backward: 2.49
 iteration       53/     100 | elapsed time per iteration (ms): 171.0 | learning rate: 3.737E-07 | lm loss: 1.059466E+01 | sop loss: 6.257644E-01 | loss scale: 131072.0 |
time (ms) | total time: 170.74 | forward: 46.87 | backward: 116.92 | allreduce: 8.79 | optimizer: 5.29 | bias in backward: 2.52 | dropout in backward: 2.41
 iteration       54/     100 | elapsed time per iteration (ms): 170.9 | learning rate: 3.838E-07 | lm loss: 1.055220E+01 | sop loss: 7.628909E-01 | loss scale: 131072.0 |
time (ms) | total time: 170.66 | forward: 47.35 | backward: 116.23 | allreduce: 9.07 | optimizer: 5.29 | bias in backward: 2.54 | dropout in backward: 2.48
 iteration       55/     100 | elapsed time per iteration (ms): 170.8 | learning rate: 3.939E-07 | lm loss: 1.052401E+01 | sop loss: 6.722125E-01 | loss scale: 131072.0 |
time (ms) | total time: 170.48 | forward: 46.93 | backward: 116.63 | allreduce: 8.70 | optimizer: 5.31 | bias in backward: 2.63 | dropout in backward: 2.42
 iteration       56/     100 | elapsed time per iteration (ms): 142.6 | learning rate: 3.939E-07 | lm loss: 1.055810E+01 | sop loss: 7.588130E-01 | loss scale: 65536.0 |
time (ms) | total time: 142.32 | forward: 47.49 | backward: 93.00 | allreduce: 8.78 | optimizer: 0.03 | bias in backward: 2.47 | dropout in backward: 2.41
 iteration       57/     100 | elapsed time per iteration (ms): 170.8 | learning rate: 4.040E-07 | lm loss: 1.058403E+01 | sop loss: 7.093524E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.53 | forward: 47.41 | backward: 116.19 | allreduce: 8.71 | optimizer: 5.30 | bias in backward: 2.50 | dropout in backward: 2.41
 iteration       58/     100 | elapsed time per iteration (ms): 170.2 | learning rate: 4.141E-07 | lm loss: 1.058445E+01 | sop loss: 5.879651E-01 | loss scale: 65536.0 |
time (ms) | total time: 169.90 | forward: 46.99 | backward: 116.01 | allreduce: 8.70 | optimizer: 5.31 | bias in backward: 2.49 | dropout in backward: 2.47
 iteration       59/     100 | elapsed time per iteration (ms): 172.5 | learning rate: 4.242E-07 | lm loss: 1.052989E+01 | sop loss: 7.292869E-01 | loss scale: 65536.0 |
time (ms) | total time: 172.23 | forward: 47.43 | backward: 117.52 | allreduce: 8.97 | optimizer: 5.36 | bias in backward: 2.58 | dropout in backward: 2.43
 iteration       60/     100 | elapsed time per iteration (ms): 173.7 | learning rate: 4.343E-07 | lm loss: 1.053643E+01 | sop loss: 8.100690E-01 | loss scale: 65536.0 |
time (ms) | total time: 173.43 | forward: 47.00 | backward: 119.09 | allreduce: 11.59 | optimizer: 5.35 | bias in backward: 2.45 | dropout in backward: 2.41
 iteration       61/     100 | elapsed time per iteration (ms): 173.8 | learning rate: 4.444E-07 | lm loss: 1.054913E+01 | sop loss: 7.371576E-01 | loss scale: 65536.0 |
time (ms) | total time: 173.54 | forward: 47.62 | backward: 118.40 | allreduce: 9.17 | optimizer: 5.33 | bias in backward: 2.50 | dropout in backward: 2.42
 iteration       62/     100 | elapsed time per iteration (ms): 175.4 | learning rate: 4.545E-07 | lm loss: 1.053732E+01 | sop loss: 7.933170E-01 | loss scale: 65536.0 |
time (ms) | total time: 175.05 | forward: 47.64 | backward: 118.66 | allreduce: 8.80 | optimizer: 6.71 | bias in backward: 2.54 | dropout in backward: 2.45
 iteration       63/     100 | elapsed time per iteration (ms): 172.2 | learning rate: 4.646E-07 | lm loss: 1.049711E+01 | sop loss: 7.698132E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.85 | forward: 47.16 | backward: 117.32 | allreduce: 8.89 | optimizer: 5.33 | bias in backward: 2.35 | dropout in backward: 2.40
 iteration       64/     100 | elapsed time per iteration (ms): 172.9 | learning rate: 4.747E-07 | lm loss: 1.050578E+01 | sop loss: 7.911913E-01 | loss scale: 65536.0 |
time (ms) | total time: 172.58 | forward: 47.21 | backward: 117.76 | allreduce: 9.10 | optimizer: 5.40 | bias in backward: 2.54 | dropout in backward: 2.44
 iteration       65/     100 | elapsed time per iteration (ms): 173.2 | learning rate: 4.848E-07 | lm loss: 1.050920E+01 | sop loss: 6.389158E-01 | loss scale: 65536.0 |
time (ms) | total time: 172.90 | forward: 46.80 | backward: 117.04 | allreduce: 8.96 | optimizer: 6.99 | bias in backward: 2.37 | dropout in backward: 2.40
 iteration       66/     100 | elapsed time per iteration (ms): 171.2 | learning rate: 4.949E-07 | lm loss: 1.053531E+01 | sop loss: 7.448714E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.93 | forward: 46.96 | backward: 116.98 | allreduce: 8.71 | optimizer: 5.30 | bias in backward: 2.38 | dropout in backward: 2.40
 iteration       67/     100 | elapsed time per iteration (ms): 173.2 | learning rate: 5.051E-07 | lm loss: 1.054088E+01 | sop loss: 7.221980E-01 | loss scale: 65536.0 |
time (ms) | total time: 172.85 | forward: 47.40 | backward: 118.39 | allreduce: 11.01 | optimizer: 5.30 | bias in backward: 2.36 | dropout in backward: 2.40
 iteration       68/     100 | elapsed time per iteration (ms): 172.0 | learning rate: 5.152E-07 | lm loss: 1.053004E+01 | sop loss: 7.425219E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.70 | forward: 47.77 | backward: 116.95 | allreduce: 8.73 | optimizer: 5.31 | bias in backward: 2.43 | dropout in backward: 2.40
 iteration       69/     100 | elapsed time per iteration (ms): 171.9 | learning rate: 5.253E-07 | lm loss: 1.054825E+01 | sop loss: 6.586486E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.60 | forward: 48.03 | backward: 116.29 | allreduce: 9.05 | optimizer: 5.33 | bias in backward: 2.53 | dropout in backward: 2.42
 iteration       70/     100 | elapsed time per iteration (ms): 174.3 | learning rate: 5.354E-07 | lm loss: 1.055378E+01 | sop loss: 8.550422E-01 | loss scale: 65536.0 |
time (ms) | total time: 173.99 | forward: 47.34 | backward: 119.15 | allreduce: 11.77 | optimizer: 5.37 | bias in backward: 2.40 | dropout in backward: 2.40
 iteration       71/     100 | elapsed time per iteration (ms): 170.5 | learning rate: 5.455E-07 | lm loss: 1.051113E+01 | sop loss: 7.535803E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.20 | forward: 46.94 | backward: 116.07 | allreduce: 8.74 | optimizer: 5.29 | bias in backward: 2.44 | dropout in backward: 2.41
 iteration       72/     100 | elapsed time per iteration (ms): 170.7 | learning rate: 5.556E-07 | lm loss: 1.050951E+01 | sop loss: 6.990322E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.45 | forward: 47.07 | backward: 116.42 | allreduce: 8.67 | optimizer: 5.28 | bias in backward: 2.39 | dropout in backward: 2.40
 iteration       73/     100 | elapsed time per iteration (ms): 170.4 | learning rate: 5.657E-07 | lm loss: 1.050417E+01 | sop loss: 7.820886E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.15 | forward: 47.19 | backward: 115.86 | allreduce: 8.69 | optimizer: 5.30 | bias in backward: 2.51 | dropout in backward: 2.47
 iteration       74/     100 | elapsed time per iteration (ms): 170.9 | learning rate: 5.758E-07 | lm loss: 1.054801E+01 | sop loss: 6.266322E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.58 | forward: 46.75 | backward: 116.69 | allreduce: 8.95 | optimizer: 5.31 | bias in backward: 2.61 | dropout in backward: 2.50
 iteration       75/     100 | elapsed time per iteration (ms): 170.4 | learning rate: 5.859E-07 | lm loss: 1.052186E+01 | sop loss: 7.109868E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.16 | forward: 46.96 | backward: 116.13 | allreduce: 8.74 | optimizer: 5.31 | bias in backward: 2.58 | dropout in backward: 2.50
 iteration       76/     100 | elapsed time per iteration (ms): 171.1 | learning rate: 5.960E-07 | lm loss: 1.052734E+01 | sop loss: 6.470559E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.83 | forward: 47.80 | backward: 116.05 | allreduce: 8.77 | optimizer: 5.28 | bias in backward: 2.45 | dropout in backward: 2.52
 iteration       77/     100 | elapsed time per iteration (ms): 170.5 | learning rate: 6.061E-07 | lm loss: 1.046538E+01 | sop loss: 6.924346E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.17 | forward: 46.99 | backward: 116.18 | allreduce: 8.78 | optimizer: 5.26 | bias in backward: 2.52 | dropout in backward: 2.46
 iteration       78/     100 | elapsed time per iteration (ms): 170.2 | learning rate: 6.162E-07 | lm loss: 1.062023E+01 | sop loss: 7.282020E-01 | loss scale: 65536.0 |
time (ms) | total time: 169.94 | forward: 47.16 | backward: 115.87 | allreduce: 8.68 | optimizer: 5.28 | bias in backward: 2.64 | dropout in backward: 2.45
 iteration       79/     100 | elapsed time per iteration (ms): 170.3 | learning rate: 6.263E-07 | lm loss: 1.049535E+01 | sop loss: 7.158816E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.00 | forward: 47.01 | backward: 116.00 | allreduce: 8.70 | optimizer: 5.28 | bias in backward: 2.58 | dropout in backward: 2.46
 iteration       80/     100 | elapsed time per iteration (ms): 171.9 | learning rate: 6.364E-07 | lm loss: 1.053189E+01 | sop loss: 6.820586E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.63 | forward: 48.03 | backward: 116.40 | allreduce: 9.07 | optimizer: 5.34 | bias in backward: 2.42 | dropout in backward: 2.42
 iteration       81/     100 | elapsed time per iteration (ms): 172.7 | learning rate: 6.465E-07 | lm loss: 1.051118E+01 | sop loss: 6.757948E-01 | loss scale: 65536.0 |
time (ms) | total time: 172.44 | forward: 47.48 | backward: 117.80 | allreduce: 8.85 | optimizer: 5.32 | bias in backward: 2.41 | dropout in backward: 2.43
 iteration       82/     100 | elapsed time per iteration (ms): 170.6 | learning rate: 6.566E-07 | lm loss: 1.053243E+01 | sop loss: 7.015514E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.35 | forward: 47.13 | backward: 116.18 | allreduce: 8.67 | optimizer: 5.29 | bias in backward: 2.54 | dropout in backward: 2.46
 iteration       83/     100 | elapsed time per iteration (ms): 170.5 | learning rate: 6.667E-07 | lm loss: 1.055429E+01 | sop loss: 7.424014E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.26 | forward: 47.45 | backward: 115.85 | allreduce: 8.68 | optimizer: 5.28 | bias in backward: 2.47 | dropout in backward: 2.48
 iteration       84/     100 | elapsed time per iteration (ms): 171.2 | learning rate: 6.768E-07 | lm loss: 1.054964E+01 | sop loss: 7.376043E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.93 | forward: 47.21 | backward: 116.76 | allreduce: 8.65 | optimizer: 5.28 | bias in backward: 2.44 | dropout in backward: 2.44
 iteration       85/     100 | elapsed time per iteration (ms): 172.1 | learning rate: 6.869E-07 | lm loss: 1.052503E+01 | sop loss: 5.409024E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.80 | forward: 48.03 | backward: 116.81 | allreduce: 8.68 | optimizer: 5.26 | bias in backward: 2.39 | dropout in backward: 2.47
 iteration       86/     100 | elapsed time per iteration (ms): 173.5 | learning rate: 6.970E-07 | lm loss: 1.047469E+01 | sop loss: 8.394578E-01 | loss scale: 65536.0 |
time (ms) | total time: 173.27 | forward: 47.80 | backward: 118.11 | allreduce: 9.31 | optimizer: 5.36 | bias in backward: 2.45 | dropout in backward: 2.42
 iteration       87/     100 | elapsed time per iteration (ms): 172.4 | learning rate: 7.071E-07 | lm loss: 1.052315E+01 | sop loss: 7.810665E-01 | loss scale: 65536.0 |
time (ms) | total time: 172.09 | forward: 46.57 | backward: 118.04 | allreduce: 10.89 | optimizer: 5.35 | bias in backward: 2.34 | dropout in backward: 2.40
 iteration       88/     100 | elapsed time per iteration (ms): 171.9 | learning rate: 7.172E-07 | lm loss: 1.051347E+01 | sop loss: 7.180831E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.64 | forward: 46.97 | backward: 117.36 | allreduce: 9.00 | optimizer: 5.35 | bias in backward: 2.60 | dropout in backward: 2.42
 iteration       89/     100 | elapsed time per iteration (ms): 171.7 | learning rate: 7.273E-07 | lm loss: 1.053629E+01 | sop loss: 5.631953E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.46 | forward: 47.23 | backward: 117.06 | allreduce: 8.91 | optimizer: 5.31 | bias in backward: 2.48 | dropout in backward: 2.50
 iteration       90/     100 | elapsed time per iteration (ms): 171.4 | learning rate: 7.374E-07 | lm loss: 1.049825E+01 | sop loss: 7.926722E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.07 | forward: 47.41 | backward: 116.60 | allreduce: 8.76 | optimizer: 5.30 | bias in backward: 2.54 | dropout in backward: 2.47
 iteration       91/     100 | elapsed time per iteration (ms): 170.7 | learning rate: 7.475E-07 | lm loss: 1.053083E+01 | sop loss: 7.197510E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.45 | forward: 47.08 | backward: 116.30 | allreduce: 8.73 | optimizer: 5.32 | bias in backward: 2.50 | dropout in backward: 2.44
 iteration       92/     100 | elapsed time per iteration (ms): 172.0 | learning rate: 7.576E-07 | lm loss: 1.053185E+01 | sop loss: 6.642394E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.67 | forward: 47.55 | backward: 117.13 | allreduce: 8.74 | optimizer: 5.29 | bias in backward: 2.50 | dropout in backward: 2.44
 iteration       93/     100 | elapsed time per iteration (ms): 172.3 | learning rate: 7.677E-07 | lm loss: 1.055609E+01 | sop loss: 7.114521E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.93 | forward: 47.47 | backward: 116.87 | allreduce: 8.99 | optimizer: 5.39 | bias in backward: 2.47 | dropout in backward: 2.51
 iteration       94/     100 | elapsed time per iteration (ms): 171.3 | learning rate: 7.778E-07 | lm loss: 1.050119E+01 | sop loss: 6.282904E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.93 | forward: 47.27 | backward: 116.44 | allreduce: 8.88 | optimizer: 5.31 | bias in backward: 2.57 | dropout in backward: 2.47
 iteration       95/     100 | elapsed time per iteration (ms): 170.1 | learning rate: 7.879E-07 | lm loss: 1.051923E+01 | sop loss: 7.571267E-01 | loss scale: 65536.0 |
time (ms) | total time: 169.78 | forward: 47.20 | backward: 115.62 | allreduce: 8.74 | optimizer: 5.29 | bias in backward: 2.37 | dropout in backward: 2.38
 iteration       96/     100 | elapsed time per iteration (ms): 197.4 | learning rate: 7.980E-07 | lm loss: 1.055402E+01 | sop loss: 7.855488E-01 | loss scale: 65536.0 |
time (ms) | total time: 197.14 | forward: 47.31 | backward: 142.53 | allreduce: 35.66 | optimizer: 5.32 | bias in backward: 2.39 | dropout in backward: 2.41
 iteration       97/     100 | elapsed time per iteration (ms): 170.9 | learning rate: 8.081E-07 | lm loss: 1.053096E+01 | sop loss: 7.204523E-01 | loss scale: 65536.0 |
time (ms) | total time: 170.60 | forward: 47.14 | backward: 116.06 | allreduce: 9.02 | optimizer: 5.33 | bias in backward: 2.37 | dropout in backward: 2.40
 iteration       98/     100 | elapsed time per iteration (ms): 172.7 | learning rate: 8.182E-07 | lm loss: 1.045914E+01 | sop loss: 7.546799E-01 | loss scale: 65536.0 |
time (ms) | total time: 172.30 | forward: 47.52 | backward: 117.38 | allreduce: 9.08 | optimizer: 5.35 | bias in backward: 2.57 | dropout in backward: 2.45
 iteration       99/     100 | elapsed time per iteration (ms): 198.8 | learning rate: 8.283E-07 | lm loss: 1.056124E+01 | sop loss: 6.902056E-01 | loss scale: 65536.0 |
time (ms) | total time: 198.56 | forward: 47.03 | backward: 144.42 | allreduce: 8.79 | optimizer: 5.29 | bias in backward: 2.50 | dropout in backward: 2.46
 iteration      100/     100 | elapsed time per iteration (ms): 171.7 | learning rate: 8.384E-07 | lm loss: 1.051027E+01 | sop loss: 7.827233E-01 | loss scale: 65536.0 |
time (ms) | total time: 171.44 | forward: 47.78 | backward: 116.68 | allreduce: 8.74 | optimizer: 5.27 | bias in backward: 2.41 | dropout in backward: 2.41
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

16

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.118266 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_1600mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.007 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_1600mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_1600mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3512.00 | train/valid/test data iterators: 2445.84
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 3434.2 | learning rate: 0.000E+00 | lm loss: 1.053881E+01 | sop loss: 7.020676E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 697.59228515625 | max allocated: 9333.59130859375 | cached: 9372.0 | max cached: 9372.0
time (ms) | total time: 3433.97 | forward: 2561.77 | backward: 439.40 | allreduce: 9.27 | optimizer: 0.05 | bias in backward: 24.76 | dropout in backward: 3.74
 iteration        2/     100 | elapsed time per iteration (ms): 203.2 | learning rate: 0.000E+00 | lm loss: 1.051439E+01 | sop loss: 7.438182E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 201.57 | forward: 79.17 | backward: 120.32 | allreduce: 9.32 | optimizer: 0.04 | bias in backward: 2.88 | dropout in backward: 3.73
 iteration        3/     100 | elapsed time per iteration (ms): 205.3 | learning rate: 0.000E+00 | lm loss: 1.055775E+01 | sop loss: 7.734784E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 205.02 | forward: 79.23 | backward: 122.40 | allreduce: 10.08 | optimizer: 0.04 | bias in backward: 3.06 | dropout in backward: 3.73
 iteration        4/     100 | elapsed time per iteration (ms): 202.2 | learning rate: 0.000E+00 | lm loss: 1.057105E+01 | sop loss: 7.949524E-01 | loss scale: 536870912.0 |
time (ms) | total time: 201.86 | forward: 79.19 | backward: 119.83 | allreduce: 9.95 | optimizer: 0.04 | bias in backward: 2.87 | dropout in backward: 3.70
 iteration        5/     100 | elapsed time per iteration (ms): 203.3 | learning rate: 0.000E+00 | lm loss: 1.050855E+01 | sop loss: 6.824275E-01 | loss scale: 268435456.0 |
time (ms) | total time: 202.98 | forward: 79.46 | backward: 120.60 | allreduce: 9.92 | optimizer: 0.04 | bias in backward: 2.87 | dropout in backward: 3.71
 iteration        6/     100 | elapsed time per iteration (ms): 203.8 | learning rate: 0.000E+00 | lm loss: 1.057665E+01 | sop loss: 6.937734E-01 | loss scale: 134217728.0 |
time (ms) | total time: 203.48 | forward: 79.74 | backward: 120.92 | allreduce: 9.98 | optimizer: 0.04 | bias in backward: 3.04 | dropout in backward: 3.83
 iteration        7/     100 | elapsed time per iteration (ms): 202.4 | learning rate: 0.000E+00 | lm loss: 1.056732E+01 | sop loss: 7.823294E-01 | loss scale: 67108864.0 |
time (ms) | total time: 202.05 | forward: 79.11 | backward: 120.06 | allreduce: 9.85 | optimizer: 0.04 | bias in backward: 2.88 | dropout in backward: 3.73
 iteration        8/     100 | elapsed time per iteration (ms): 202.6 | learning rate: 0.000E+00 | lm loss: 1.054732E+01 | sop loss: 8.063372E-01 | loss scale: 33554432.0 |
time (ms) | total time: 202.28 | forward: 79.14 | backward: 120.19 | allreduce: 9.71 | optimizer: 0.04 | bias in backward: 2.97 | dropout in backward: 3.73
 iteration        9/     100 | elapsed time per iteration (ms): 201.5 | learning rate: 0.000E+00 | lm loss: 1.053145E+01 | sop loss: 5.883591E-01 | loss scale: 16777216.0 |
time (ms) | total time: 201.22 | forward: 78.99 | backward: 119.73 | allreduce: 9.48 | optimizer: 0.03 | bias in backward: 2.91 | dropout in backward: 3.73
 iteration       10/     100 | elapsed time per iteration (ms): 202.3 | learning rate: 0.000E+00 | lm loss: 1.056799E+01 | sop loss: 7.987743E-01 | loss scale: 8388608.0 |
time (ms) | total time: 201.99 | forward: 79.16 | backward: 120.04 | allreduce: 9.74 | optimizer: 0.03 | bias in backward: 2.98 | dropout in backward: 3.73
 iteration       11/     100 | elapsed time per iteration (ms): 202.1 | learning rate: 0.000E+00 | lm loss: 1.056259E+01 | sop loss: 7.617154E-01 | loss scale: 4194304.0 |
time (ms) | total time: 201.83 | forward: 79.28 | backward: 119.85 | allreduce: 9.51 | optimizer: 0.04 | bias in backward: 3.07 | dropout in backward: 3.73
 iteration       12/     100 | elapsed time per iteration (ms): 201.3 | learning rate: 0.000E+00 | lm loss: 1.054055E+01 | sop loss: 7.273356E-01 | loss scale: 2097152.0 |
time (ms) | total time: 200.99 | forward: 79.13 | backward: 119.63 | allreduce: 9.18 | optimizer: 0.04 | bias in backward: 3.10 | dropout in backward: 3.75
 iteration       13/     100 | elapsed time per iteration (ms): 202.9 | learning rate: 0.000E+00 | lm loss: 1.054690E+01 | sop loss: 7.632462E-01 | loss scale: 1048576.0 |
time (ms) | total time: 202.61 | forward: 79.53 | backward: 120.09 | allreduce: 9.85 | optimizer: 0.04 | bias in backward: 3.02 | dropout in backward: 3.83
 iteration       14/     100 | elapsed time per iteration (ms): 207.6 | learning rate: 0.000E+00 | lm loss: 1.058479E+01 | sop loss: 7.904447E-01 | loss scale: 524288.0 |
time (ms) | total time: 207.28 | forward: 79.36 | backward: 125.07 | allreduce: 9.58 | optimizer: 0.04 | bias in backward: 2.88 | dropout in backward: 3.72
 iteration       15/     100 | elapsed time per iteration (ms): 207.8 | learning rate: 0.000E+00 | lm loss: 1.054043E+01 | sop loss: 6.944177E-01 | loss scale: 262144.0 |
time (ms) | total time: 207.46 | forward: 78.92 | backward: 125.65 | allreduce: 10.05 | optimizer: 0.04 | bias in backward: 2.87 | dropout in backward: 3.70
 iteration       16/     100 | elapsed time per iteration (ms): 419.9 | learning rate: 1.010E-08 | lm loss: 1.054086E+01 | sop loss: 7.343518E-01 | loss scale: 262144.0 |
time (ms) | total time: 419.57 | forward: 78.93 | backward: 212.51 | allreduce: 10.03 | optimizer: 125.15 | bias in backward: 2.87 | dropout in backward: 3.70
 iteration       17/     100 | elapsed time per iteration (ms): 251.5 | learning rate: 2.020E-08 | lm loss: 1.058626E+01 | sop loss: 7.704229E-01 | loss scale: 262144.0 |
time (ms) | total time: 251.19 | forward: 78.64 | backward: 159.83 | allreduce: 9.77 | optimizer: 5.37 | bias in backward: 2.97 | dropout in backward: 3.73
 iteration       18/     100 | elapsed time per iteration (ms): 249.0 | learning rate: 3.030E-08 | lm loss: 1.053218E+01 | sop loss: 6.502745E-01 | loss scale: 262144.0 |
time (ms) | total time: 248.69 | forward: 79.48 | backward: 161.12 | allreduce: 9.57 | optimizer: 5.37 | bias in backward: 2.92 | dropout in backward: 3.78
 iteration       19/     100 | elapsed time per iteration (ms): 248.0 | learning rate: 4.040E-08 | lm loss: 1.055232E+01 | sop loss: 6.234441E-01 | loss scale: 262144.0 |
time (ms) | total time: 247.62 | forward: 78.91 | backward: 160.70 | allreduce: 9.46 | optimizer: 5.34 | bias in backward: 2.90 | dropout in backward: 3.71
 iteration       20/     100 | elapsed time per iteration (ms): 246.8 | learning rate: 5.051E-08 | lm loss: 1.055249E+01 | sop loss: 6.620012E-01 | loss scale: 262144.0 |
time (ms) | total time: 246.56 | forward: 79.28 | backward: 159.39 | allreduce: 9.70 | optimizer: 5.39 | bias in backward: 2.89 | dropout in backward: 3.70
 iteration       21/     100 | elapsed time per iteration (ms): 246.0 | learning rate: 6.061E-08 | lm loss: 1.057210E+01 | sop loss: 7.777756E-01 | loss scale: 262144.0 |
time (ms) | total time: 245.64 | forward: 79.44 | backward: 158.01 | allreduce: 9.41 | optimizer: 5.35 | bias in backward: 2.89 | dropout in backward: 3.69
 iteration       22/     100 | elapsed time per iteration (ms): 248.3 | learning rate: 7.071E-08 | lm loss: 1.055163E+01 | sop loss: 7.085106E-01 | loss scale: 262144.0 |
time (ms) | total time: 247.97 | forward: 78.78 | backward: 161.16 | allreduce: 10.10 | optimizer: 5.47 | bias in backward: 3.09 | dropout in backward: 3.71
 iteration       23/     100 | elapsed time per iteration (ms): 245.7 | learning rate: 8.081E-08 | lm loss: 1.053543E+01 | sop loss: 7.072697E-01 | loss scale: 262144.0 |
time (ms) | total time: 245.40 | forward: 78.96 | backward: 158.41 | allreduce: 9.65 | optimizer: 5.33 | bias in backward: 2.89 | dropout in backward: 3.69
 iteration       24/     100 | elapsed time per iteration (ms): 247.3 | learning rate: 9.091E-08 | lm loss: 1.053998E+01 | sop loss: 5.899691E-01 | loss scale: 262144.0 |
time (ms) | total time: 247.01 | forward: 79.27 | backward: 159.77 | allreduce: 9.62 | optimizer: 5.35 | bias in backward: 2.88 | dropout in backward: 3.70
 iteration       25/     100 | elapsed time per iteration (ms): 245.5 | learning rate: 1.010E-07 | lm loss: 1.056505E+01 | sop loss: 6.514545E-01 | loss scale: 262144.0 |
time (ms) | total time: 245.24 | forward: 79.19 | backward: 158.07 | allreduce: 9.44 | optimizer: 5.37 | bias in backward: 3.02 | dropout in backward: 3.72
 iteration       26/     100 | elapsed time per iteration (ms): 247.2 | learning rate: 1.111E-07 | lm loss: 1.057887E+01 | sop loss: 7.342190E-01 | loss scale: 262144.0 |
time (ms) | total time: 246.94 | forward: 78.96 | backward: 159.93 | allreduce: 9.79 | optimizer: 5.40 | bias in backward: 3.04 | dropout in backward: 3.82
 iteration       27/     100 | elapsed time per iteration (ms): 247.7 | learning rate: 1.212E-07 | lm loss: 1.059495E+01 | sop loss: 6.644298E-01 | loss scale: 262144.0 |
time (ms) | total time: 247.43 | forward: 78.91 | backward: 160.50 | allreduce: 9.55 | optimizer: 5.36 | bias in backward: 2.88 | dropout in backward: 3.72
 iteration       28/     100 | elapsed time per iteration (ms): 219.2 | learning rate: 1.212E-07 | lm loss: 1.049593E+01 | sop loss: 7.530819E-01 | loss scale: 131072.0 |
time (ms) | total time: 218.93 | forward: 78.79 | backward: 137.29 | allreduce: 11.75 | optimizer: 0.03 | bias in backward: 2.88 | dropout in backward: 3.70
 iteration       29/     100 | elapsed time per iteration (ms): 247.4 | learning rate: 1.313E-07 | lm loss: 1.055957E+01 | sop loss: 7.431196E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.07 | forward: 78.94 | backward: 159.85 | allreduce: 9.91 | optimizer: 5.53 | bias in backward: 2.93 | dropout in backward: 3.74
 iteration       30/     100 | elapsed time per iteration (ms): 251.7 | learning rate: 1.414E-07 | lm loss: 1.055604E+01 | sop loss: 7.600431E-01 | loss scale: 131072.0 |
time (ms) | total time: 251.34 | forward: 79.04 | backward: 163.93 | allreduce: 10.23 | optimizer: 5.55 | bias in backward: 2.89 | dropout in backward: 3.70
 iteration       31/     100 | elapsed time per iteration (ms): 250.7 | learning rate: 1.515E-07 | lm loss: 1.056428E+01 | sop loss: 7.130276E-01 | loss scale: 131072.0 |
time (ms) | total time: 250.38 | forward: 79.14 | backward: 163.15 | allreduce: 9.76 | optimizer: 5.46 | bias in backward: 2.91 | dropout in backward: 3.77
 iteration       32/     100 | elapsed time per iteration (ms): 252.8 | learning rate: 1.616E-07 | lm loss: 1.052191E+01 | sop loss: 7.798068E-01 | loss scale: 131072.0 |
time (ms) | total time: 252.46 | forward: 79.31 | backward: 164.64 | allreduce: 10.01 | optimizer: 5.73 | bias in backward: 3.18 | dropout in backward: 3.73
 iteration       33/     100 | elapsed time per iteration (ms): 253.4 | learning rate: 1.717E-07 | lm loss: 1.055964E+01 | sop loss: 6.794389E-01 | loss scale: 131072.0 |
time (ms) | total time: 253.07 | forward: 79.22 | backward: 165.53 | allreduce: 9.87 | optimizer: 5.46 | bias in backward: 2.89 | dropout in backward: 3.71
 iteration       34/     100 | elapsed time per iteration (ms): 248.8 | learning rate: 1.818E-07 | lm loss: 1.062565E+01 | sop loss: 7.302799E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.38 | forward: 78.82 | backward: 160.93 | allreduce: 9.70 | optimizer: 5.69 | bias in backward: 2.89 | dropout in backward: 3.71
 iteration       35/     100 | elapsed time per iteration (ms): 248.4 | learning rate: 1.919E-07 | lm loss: 1.055056E+01 | sop loss: 6.560870E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.02 | forward: 79.11 | backward: 160.67 | allreduce: 10.11 | optimizer: 5.45 | bias in backward: 3.17 | dropout in backward: 3.79
 iteration       36/     100 | elapsed time per iteration (ms): 246.4 | learning rate: 2.020E-07 | lm loss: 1.051720E+01 | sop loss: 7.699816E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.05 | forward: 78.83 | backward: 159.15 | allreduce: 9.70 | optimizer: 5.40 | bias in backward: 2.99 | dropout in backward: 3.73
 iteration       37/     100 | elapsed time per iteration (ms): 248.2 | learning rate: 2.121E-07 | lm loss: 1.050725E+01 | sop loss: 7.621115E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.93 | forward: 79.08 | backward: 160.80 | allreduce: 12.37 | optimizer: 5.50 | bias in backward: 2.90 | dropout in backward: 3.71
 iteration       38/     100 | elapsed time per iteration (ms): 245.5 | learning rate: 2.222E-07 | lm loss: 1.053720E+01 | sop loss: 6.848378E-01 | loss scale: 131072.0 |
time (ms) | total time: 245.20 | forward: 79.00 | backward: 158.34 | allreduce: 9.30 | optimizer: 5.37 | bias in backward: 2.91 | dropout in backward: 3.85
 iteration       39/     100 | elapsed time per iteration (ms): 247.4 | learning rate: 2.323E-07 | lm loss: 1.059130E+01 | sop loss: 7.275472E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.13 | forward: 78.95 | backward: 160.62 | allreduce: 8.99 | optimizer: 5.37 | bias in backward: 2.91 | dropout in backward: 3.74
 iteration       40/     100 | elapsed time per iteration (ms): 244.7 | learning rate: 2.424E-07 | lm loss: 1.055801E+01 | sop loss: 6.937587E-01 | loss scale: 131072.0 |
time (ms) | total time: 244.39 | forward: 78.72 | backward: 158.23 | allreduce: 8.80 | optimizer: 5.33 | bias in backward: 2.91 | dropout in backward: 3.71
 iteration       41/     100 | elapsed time per iteration (ms): 247.3 | learning rate: 2.525E-07 | lm loss: 1.059601E+01 | sop loss: 7.025852E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.95 | forward: 79.71 | backward: 159.14 | allreduce: 9.35 | optimizer: 5.42 | bias in backward: 2.90 | dropout in backward: 3.72
 iteration       42/     100 | elapsed time per iteration (ms): 248.2 | learning rate: 2.626E-07 | lm loss: 1.055083E+01 | sop loss: 6.852110E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.87 | forward: 79.16 | backward: 160.47 | allreduce: 9.18 | optimizer: 6.14 | bias in backward: 2.89 | dropout in backward: 3.72
 iteration       43/     100 | elapsed time per iteration (ms): 247.7 | learning rate: 2.727E-07 | lm loss: 1.056426E+01 | sop loss: 7.395805E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.36 | forward: 79.40 | backward: 160.06 | allreduce: 9.35 | optimizer: 5.39 | bias in backward: 3.07 | dropout in backward: 3.71
 iteration       44/     100 | elapsed time per iteration (ms): 253.3 | learning rate: 2.828E-07 | lm loss: 1.055899E+01 | sop loss: 6.721475E-01 | loss scale: 131072.0 |
time (ms) | total time: 253.05 | forward: 79.12 | backward: 165.83 | allreduce: 12.56 | optimizer: 5.53 | bias in backward: 2.89 | dropout in backward: 3.70
 iteration       45/     100 | elapsed time per iteration (ms): 246.8 | learning rate: 2.929E-07 | lm loss: 1.055394E+01 | sop loss: 6.843289E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.50 | forward: 79.17 | backward: 159.19 | allreduce: 9.74 | optimizer: 5.38 | bias in backward: 3.10 | dropout in backward: 3.73
 iteration       46/     100 | elapsed time per iteration (ms): 248.0 | learning rate: 3.030E-07 | lm loss: 1.055780E+01 | sop loss: 6.396887E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.73 | forward: 79.41 | backward: 159.87 | allreduce: 9.90 | optimizer: 5.64 | bias in backward: 2.89 | dropout in backward: 3.71
 iteration       47/     100 | elapsed time per iteration (ms): 248.1 | learning rate: 3.131E-07 | lm loss: 1.056781E+01 | sop loss: 6.657076E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.77 | forward: 79.44 | backward: 159.96 | allreduce: 9.84 | optimizer: 5.50 | bias in backward: 2.89 | dropout in backward: 3.69
 iteration       48/     100 | elapsed time per iteration (ms): 250.7 | learning rate: 3.232E-07 | lm loss: 1.054796E+01 | sop loss: 6.954303E-01 | loss scale: 131072.0 |
time (ms) | total time: 250.42 | forward: 83.56 | backward: 158.80 | allreduce: 9.72 | optimizer: 5.46 | bias in backward: 2.89 | dropout in backward: 3.71
 iteration       49/     100 | elapsed time per iteration (ms): 247.6 | learning rate: 3.333E-07 | lm loss: 1.054381E+01 | sop loss: 7.401845E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.35 | forward: 79.40 | backward: 159.93 | allreduce: 9.51 | optimizer: 5.37 | bias in backward: 2.89 | dropout in backward: 3.70
 iteration       50/     100 | elapsed time per iteration (ms): 249.0 | learning rate: 3.434E-07 | lm loss: 1.055853E+01 | sop loss: 6.028649E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.72 | forward: 79.57 | backward: 160.98 | allreduce: 9.89 | optimizer: 5.51 | bias in backward: 2.89 | dropout in backward: 3.70
 iteration       51/     100 | elapsed time per iteration (ms): 247.3 | learning rate: 3.535E-07 | lm loss: 1.055282E+01 | sop loss: 6.815002E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.97 | forward: 79.04 | backward: 159.26 | allreduce: 9.84 | optimizer: 5.63 | bias in backward: 2.88 | dropout in backward: 3.70
 iteration       52/     100 | elapsed time per iteration (ms): 247.0 | learning rate: 3.636E-07 | lm loss: 1.055302E+01 | sop loss: 7.961071E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.68 | forward: 78.99 | backward: 159.52 | allreduce: 10.08 | optimizer: 5.47 | bias in backward: 2.89 | dropout in backward: 3.70
 iteration       53/     100 | elapsed time per iteration (ms): 249.3 | learning rate: 3.737E-07 | lm loss: 1.058666E+01 | sop loss: 6.681932E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.95 | forward: 79.05 | backward: 161.79 | allreduce: 13.10 | optimizer: 5.43 | bias in backward: 2.90 | dropout in backward: 3.72
 iteration       54/     100 | elapsed time per iteration (ms): 251.9 | learning rate: 3.838E-07 | lm loss: 1.057736E+01 | sop loss: 6.647534E-01 | loss scale: 131072.0 |
time (ms) | total time: 251.57 | forward: 79.13 | backward: 164.56 | allreduce: 9.46 | optimizer: 5.38 | bias in backward: 2.89 | dropout in backward: 3.71
 iteration       55/     100 | elapsed time per iteration (ms): 246.1 | learning rate: 3.939E-07 | lm loss: 1.051577E+01 | sop loss: 6.754167E-01 | loss scale: 131072.0 |
time (ms) | total time: 245.85 | forward: 79.07 | backward: 158.81 | allreduce: 9.42 | optimizer: 5.39 | bias in backward: 3.04 | dropout in backward: 3.88
 iteration       56/     100 | elapsed time per iteration (ms): 248.9 | learning rate: 4.040E-07 | lm loss: 1.054882E+01 | sop loss: 8.007042E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.57 | forward: 78.69 | backward: 161.90 | allreduce: 9.61 | optimizer: 5.36 | bias in backward: 2.91 | dropout in backward: 3.72
 iteration       57/     100 | elapsed time per iteration (ms): 245.5 | learning rate: 4.141E-07 | lm loss: 1.056067E+01 | sop loss: 6.137596E-01 | loss scale: 131072.0 |
time (ms) | total time: 245.23 | forward: 78.91 | backward: 157.40 | allreduce: 8.99 | optimizer: 6.74 | bias in backward: 2.88 | dropout in backward: 3.71
 iteration       58/     100 | elapsed time per iteration (ms): 246.8 | learning rate: 4.242E-07 | lm loss: 1.058343E+01 | sop loss: 7.164625E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.39 | forward: 78.98 | backward: 159.59 | allreduce: 9.07 | optimizer: 5.37 | bias in backward: 2.88 | dropout in backward: 3.71
 iteration       59/     100 | elapsed time per iteration (ms): 244.3 | learning rate: 4.343E-07 | lm loss: 1.052131E+01 | sop loss: 7.512167E-01 | loss scale: 131072.0 |
time (ms) | total time: 244.04 | forward: 79.27 | backward: 157.39 | allreduce: 9.00 | optimizer: 5.36 | bias in backward: 2.96 | dropout in backward: 3.87
 iteration       60/     100 | elapsed time per iteration (ms): 243.6 | learning rate: 4.444E-07 | lm loss: 1.053641E+01 | sop loss: 7.021835E-01 | loss scale: 131072.0 |
time (ms) | total time: 243.30 | forward: 78.73 | backward: 157.21 | allreduce: 8.89 | optimizer: 5.38 | bias in backward: 3.01 | dropout in backward: 3.80
 iteration       61/     100 | elapsed time per iteration (ms): 243.5 | learning rate: 4.545E-07 | lm loss: 1.055809E+01 | sop loss: 6.746722E-01 | loss scale: 131072.0 |
time (ms) | total time: 243.27 | forward: 78.81 | backward: 157.15 | allreduce: 8.88 | optimizer: 5.34 | bias in backward: 2.99 | dropout in backward: 3.71
 iteration       62/     100 | elapsed time per iteration (ms): 249.2 | learning rate: 4.646E-07 | lm loss: 1.055128E+01 | sop loss: 7.294629E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.87 | forward: 79.10 | backward: 162.49 | allreduce: 8.83 | optimizer: 5.34 | bias in backward: 2.88 | dropout in backward: 3.70
 iteration       63/     100 | elapsed time per iteration (ms): 252.1 | learning rate: 4.747E-07 | lm loss: 1.056070E+01 | sop loss: 6.490248E-01 | loss scale: 131072.0 |
time (ms) | total time: 251.84 | forward: 81.56 | backward: 161.35 | allreduce: 8.86 | optimizer: 6.94 | bias in backward: 2.87 | dropout in backward: 3.70
 iteration       64/     100 | elapsed time per iteration (ms): 248.3 | learning rate: 4.848E-07 | lm loss: 1.052568E+01 | sop loss: 7.614604E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.97 | forward: 79.01 | backward: 161.59 | allreduce: 8.94 | optimizer: 5.36 | bias in backward: 2.87 | dropout in backward: 3.70
 iteration       65/     100 | elapsed time per iteration (ms): 249.2 | learning rate: 4.949E-07 | lm loss: 1.053459E+01 | sop loss: 6.589782E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.90 | forward: 80.55 | backward: 160.92 | allreduce: 11.47 | optimizer: 5.35 | bias in backward: 2.88 | dropout in backward: 3.69
 iteration       66/     100 | elapsed time per iteration (ms): 245.4 | learning rate: 5.051E-07 | lm loss: 1.053524E+01 | sop loss: 7.538863E-01 | loss scale: 131072.0 |
time (ms) | total time: 244.96 | forward: 80.08 | backward: 157.39 | allreduce: 9.07 | optimizer: 5.35 | bias in backward: 2.89 | dropout in backward: 3.72
 iteration       67/     100 | elapsed time per iteration (ms): 245.3 | learning rate: 5.152E-07 | lm loss: 1.052899E+01 | sop loss: 7.157383E-01 | loss scale: 131072.0 |
time (ms) | total time: 244.95 | forward: 79.01 | backward: 157.00 | allreduce: 9.33 | optimizer: 5.33 | bias in backward: 2.88 | dropout in backward: 3.70
 iteration       68/     100 | elapsed time per iteration (ms): 248.1 | learning rate: 5.253E-07 | lm loss: 1.053142E+01 | sop loss: 6.401015E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.79 | forward: 82.43 | backward: 157.94 | allreduce: 8.98 | optimizer: 5.36 | bias in backward: 2.88 | dropout in backward: 3.70
 iteration       69/     100 | elapsed time per iteration (ms): 246.4 | learning rate: 5.354E-07 | lm loss: 1.053345E+01 | sop loss: 6.552363E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.08 | forward: 79.38 | backward: 159.08 | allreduce: 9.21 | optimizer: 5.38 | bias in backward: 3.19 | dropout in backward: 3.74
 iteration       70/     100 | elapsed time per iteration (ms): 250.4 | learning rate: 5.455E-07 | lm loss: 1.051748E+01 | sop loss: 6.924319E-01 | loss scale: 131072.0 |
time (ms) | total time: 250.08 | forward: 79.24 | backward: 162.33 | allreduce: 12.71 | optimizer: 5.57 | bias in backward: 2.88 | dropout in backward: 3.71
 iteration       71/     100 | elapsed time per iteration (ms): 248.0 | learning rate: 5.556E-07 | lm loss: 1.053784E+01 | sop loss: 7.668684E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.72 | forward: 79.07 | backward: 160.26 | allreduce: 9.69 | optimizer: 5.41 | bias in backward: 2.92 | dropout in backward: 3.72
 iteration       72/     100 | elapsed time per iteration (ms): 247.0 | learning rate: 5.657E-07 | lm loss: 1.053568E+01 | sop loss: 6.616085E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.67 | forward: 78.92 | backward: 159.41 | allreduce: 10.13 | optimizer: 5.54 | bias in backward: 2.90 | dropout in backward: 3.76
 iteration       73/     100 | elapsed time per iteration (ms): 257.8 | learning rate: 5.758E-07 | lm loss: 1.050849E+01 | sop loss: 7.009405E-01 | loss scale: 131072.0 |
time (ms) | total time: 257.55 | forward: 79.45 | backward: 169.72 | allreduce: 9.72 | optimizer: 5.42 | bias in backward: 2.91 | dropout in backward: 3.71
 iteration       74/     100 | elapsed time per iteration (ms): 251.4 | learning rate: 5.859E-07 | lm loss: 1.051049E+01 | sop loss: 6.497032E-01 | loss scale: 131072.0 |
time (ms) | total time: 251.04 | forward: 82.83 | backward: 159.86 | allreduce: 9.96 | optimizer: 5.68 | bias in backward: 2.99 | dropout in backward: 3.82
 iteration       75/     100 | elapsed time per iteration (ms): 249.3 | learning rate: 5.960E-07 | lm loss: 1.053820E+01 | sop loss: 7.297214E-01 | loss scale: 131072.0 |
time (ms) | total time: 249.02 | forward: 78.67 | backward: 161.67 | allreduce: 10.02 | optimizer: 5.73 | bias in backward: 2.90 | dropout in backward: 3.72
 iteration       76/     100 | elapsed time per iteration (ms): 248.7 | learning rate: 6.061E-07 | lm loss: 1.052896E+01 | sop loss: 7.499918E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.36 | forward: 79.05 | backward: 160.90 | allreduce: 10.72 | optimizer: 5.46 | bias in backward: 2.97 | dropout in backward: 3.78
 iteration       77/     100 | elapsed time per iteration (ms): 246.3 | learning rate: 6.162E-07 | lm loss: 1.052027E+01 | sop loss: 7.628036E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.05 | forward: 78.85 | backward: 158.96 | allreduce: 9.96 | optimizer: 5.46 | bias in backward: 2.90 | dropout in backward: 3.70
 iteration       78/     100 | elapsed time per iteration (ms): 247.1 | learning rate: 6.263E-07 | lm loss: 1.047832E+01 | sop loss: 6.976070E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.77 | forward: 79.03 | backward: 159.72 | allreduce: 9.47 | optimizer: 5.40 | bias in backward: 2.90 | dropout in backward: 3.72
 iteration       79/     100 | elapsed time per iteration (ms): 246.8 | learning rate: 6.364E-07 | lm loss: 1.052069E+01 | sop loss: 7.322362E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.50 | forward: 79.27 | backward: 159.04 | allreduce: 9.80 | optimizer: 5.46 | bias in backward: 2.91 | dropout in backward: 3.74
 iteration       80/     100 | elapsed time per iteration (ms): 253.3 | learning rate: 6.465E-07 | lm loss: 1.052686E+01 | sop loss: 6.634238E-01 | loss scale: 131072.0 |
time (ms) | total time: 252.93 | forward: 79.15 | backward: 163.27 | allreduce: 9.96 | optimizer: 7.10 | bias in backward: 2.94 | dropout in backward: 3.83
 iteration       81/     100 | elapsed time per iteration (ms): 248.1 | learning rate: 6.566E-07 | lm loss: 1.049383E+01 | sop loss: 7.488258E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.70 | forward: 79.13 | backward: 159.89 | allreduce: 9.70 | optimizer: 5.74 | bias in backward: 2.89 | dropout in backward: 3.70
 iteration       82/     100 | elapsed time per iteration (ms): 247.6 | learning rate: 6.667E-07 | lm loss: 1.050670E+01 | sop loss: 7.150719E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.31 | forward: 78.75 | backward: 160.23 | allreduce: 10.22 | optimizer: 5.54 | bias in backward: 2.90 | dropout in backward: 3.72
 iteration       83/     100 | elapsed time per iteration (ms): 249.7 | learning rate: 6.768E-07 | lm loss: 1.052638E+01 | sop loss: 7.082950E-01 | loss scale: 131072.0 |
time (ms) | total time: 249.38 | forward: 79.14 | backward: 161.85 | allreduce: 9.95 | optimizer: 5.53 | bias in backward: 2.89 | dropout in backward: 3.70
 iteration       84/     100 | elapsed time per iteration (ms): 248.8 | learning rate: 6.869E-07 | lm loss: 1.048277E+01 | sop loss: 8.083183E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.48 | forward: 78.77 | backward: 161.26 | allreduce: 9.72 | optimizer: 5.52 | bias in backward: 2.89 | dropout in backward: 3.70
 iteration       85/     100 | elapsed time per iteration (ms): 245.4 | learning rate: 6.970E-07 | lm loss: 1.053502E+01 | sop loss: 7.398465E-01 | loss scale: 131072.0 |
time (ms) | total time: 245.15 | forward: 78.82 | backward: 158.60 | allreduce: 9.79 | optimizer: 5.34 | bias in backward: 2.88 | dropout in backward: 3.71
 iteration       86/     100 | elapsed time per iteration (ms): 247.5 | learning rate: 7.071E-07 | lm loss: 1.051915E+01 | sop loss: 7.226301E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.22 | forward: 78.77 | backward: 159.73 | allreduce: 9.65 | optimizer: 5.93 | bias in backward: 3.08 | dropout in backward: 3.74
 iteration       87/     100 | elapsed time per iteration (ms): 248.6 | learning rate: 7.172E-07 | lm loss: 1.052586E+01 | sop loss: 7.535552E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.25 | forward: 79.10 | backward: 160.60 | allreduce: 10.09 | optimizer: 5.53 | bias in backward: 2.91 | dropout in backward: 3.71
 iteration       88/     100 | elapsed time per iteration (ms): 249.6 | learning rate: 7.273E-07 | lm loss: 1.049076E+01 | sop loss: 6.158942E-01 | loss scale: 131072.0 |
time (ms) | total time: 249.33 | forward: 78.96 | backward: 162.12 | allreduce: 12.45 | optimizer: 5.45 | bias in backward: 2.89 | dropout in backward: 3.71
 iteration       89/     100 | elapsed time per iteration (ms): 248.8 | learning rate: 7.374E-07 | lm loss: 1.048292E+01 | sop loss: 7.474443E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.45 | forward: 79.10 | backward: 161.10 | allreduce: 9.53 | optimizer: 5.45 | bias in backward: 2.89 | dropout in backward: 3.72
 iteration       90/     100 | elapsed time per iteration (ms): 248.5 | learning rate: 7.475E-07 | lm loss: 1.055713E+01 | sop loss: 8.012112E-01 | loss scale: 131072.0 |
time (ms) | total time: 248.21 | forward: 79.03 | backward: 161.01 | allreduce: 12.09 | optimizer: 5.45 | bias in backward: 2.91 | dropout in backward: 3.71
 iteration       91/     100 | elapsed time per iteration (ms): 247.5 | learning rate: 7.576E-07 | lm loss: 1.050774E+01 | sop loss: 6.172342E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.24 | forward: 79.22 | backward: 160.38 | allreduce: 12.42 | optimizer: 5.40 | bias in backward: 2.88 | dropout in backward: 3.70
 iteration       92/     100 | elapsed time per iteration (ms): 247.0 | learning rate: 7.677E-07 | lm loss: 1.048451E+01 | sop loss: 7.254375E-01 | loss scale: 131072.0 |
time (ms) | total time: 246.72 | forward: 79.27 | backward: 159.59 | allreduce: 9.44 | optimizer: 5.38 | bias in backward: 2.88 | dropout in backward: 3.73
 iteration       93/     100 | elapsed time per iteration (ms): 244.3 | learning rate: 7.778E-07 | lm loss: 1.048288E+01 | sop loss: 6.774232E-01 | loss scale: 131072.0 |
time (ms) | total time: 243.96 | forward: 78.86 | backward: 157.58 | allreduce: 9.25 | optimizer: 5.37 | bias in backward: 2.88 | dropout in backward: 3.71
 iteration       94/     100 | elapsed time per iteration (ms): 245.4 | learning rate: 7.879E-07 | lm loss: 1.052438E+01 | sop loss: 6.425596E-01 | loss scale: 131072.0 |
time (ms) | total time: 245.13 | forward: 79.66 | backward: 157.99 | allreduce: 8.97 | optimizer: 5.35 | bias in backward: 3.00 | dropout in backward: 3.73
 iteration       95/     100 | elapsed time per iteration (ms): 245.3 | learning rate: 7.980E-07 | lm loss: 1.050465E+01 | sop loss: 7.140733E-01 | loss scale: 131072.0 |
time (ms) | total time: 245.00 | forward: 79.45 | backward: 158.06 | allreduce: 8.98 | optimizer: 5.37 | bias in backward: 2.96 | dropout in backward: 3.73
 iteration       96/     100 | elapsed time per iteration (ms): 270.6 | learning rate: 8.081E-07 | lm loss: 1.048056E+01 | sop loss: 8.139214E-01 | loss scale: 131072.0 |
time (ms) | total time: 270.28 | forward: 79.18 | backward: 183.24 | allreduce: 34.20 | optimizer: 5.42 | bias in backward: 3.16 | dropout in backward: 3.72
 iteration       97/     100 | elapsed time per iteration (ms): 244.7 | learning rate: 8.182E-07 | lm loss: 1.050072E+01 | sop loss: 6.642987E-01 | loss scale: 131072.0 |
time (ms) | total time: 244.46 | forward: 79.08 | backward: 157.61 | allreduce: 9.21 | optimizer: 5.36 | bias in backward: 2.87 | dropout in backward: 3.71
 iteration       98/     100 | elapsed time per iteration (ms): 249.4 | learning rate: 8.283E-07 | lm loss: 1.055768E+01 | sop loss: 6.892291E-01 | loss scale: 131072.0 |
time (ms) | total time: 249.12 | forward: 79.32 | backward: 161.67 | allreduce: 12.02 | optimizer: 5.54 | bias in backward: 2.87 | dropout in backward: 3.69
 iteration       99/     100 | elapsed time per iteration (ms): 270.5 | learning rate: 8.384E-07 | lm loss: 1.054468E+01 | sop loss: 7.853013E-01 | loss scale: 131072.0 |
time (ms) | total time: 270.17 | forward: 79.21 | backward: 182.45 | allreduce: 9.59 | optimizer: 5.60 | bias in backward: 2.89 | dropout in backward: 3.70
 iteration      100/     100 | elapsed time per iteration (ms): 247.8 | learning rate: 8.485E-07 | lm loss: 1.045883E+01 | sop loss: 9.140720E-01 | loss scale: 131072.0 |
time (ms) | total time: 247.50 | forward: 79.10 | backward: 158.41 | allreduce: 9.59 | optimizer: 7.12 | bias in backward: 2.89 | dropout in backward: 3.71
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

32

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.123379 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_3200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_3200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_3200mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3724.28 | train/valid/test data iterators: 2738.65
training ...
 iteration        1/     100 | elapsed time per iteration (ms): 5028.5 | learning rate: 0.000E+00 | lm loss: 1.052506E+01 | sop loss: 7.891431E-01 | loss scale: 4294967296.0 |
after 1 iterations memory (MB) | allocated: 716.59228515625 | max allocated: 18162.98193359375 | cached: 18320.0 | max cached: 18320.0
time (ms) | total time: 5028.29 | forward: 3744.93 | backward: 517.96 | allreduce: 9.49 | optimizer: 0.07 | bias in backward: 17.52 | dropout in backward: 6.55
 iteration        2/     100 | elapsed time per iteration (ms): 349.2 | learning rate: 0.000E+00 | lm loss: 1.056106E+01 | sop loss: 7.708431E-01 | loss scale: 2147483648.0 |
time (ms) | total time: 347.49 | forward: 140.63 | backward: 204.03 | allreduce: 9.75 | optimizer: 0.05 | bias in backward: 4.06 | dropout in backward: 6.58
 iteration        3/     100 | elapsed time per iteration (ms): 352.0 | learning rate: 0.000E+00 | lm loss: 1.055479E+01 | sop loss: 6.633167E-01 | loss scale: 1073741824.0 |
time (ms) | total time: 351.74 | forward: 139.85 | backward: 208.24 | allreduce: 9.66 | optimizer: 0.04 | bias in backward: 4.11 | dropout in backward: 6.49
 iteration        4/     100 | elapsed time per iteration (ms): 350.8 | learning rate: 0.000E+00 | lm loss: 1.057864E+01 | sop loss: 7.194724E-01 | loss scale: 536870912.0 |
time (ms) | total time: 350.45 | forward: 139.75 | backward: 207.67 | allreduce: 11.83 | optimizer: 0.03 | bias in backward: 4.05 | dropout in backward: 6.51
 iteration        5/     100 | elapsed time per iteration (ms): 348.3 | learning rate: 0.000E+00 | lm loss: 1.055997E+01 | sop loss: 6.742499E-01 | loss scale: 268435456.0 |
time (ms) | total time: 348.03 | forward: 139.91 | backward: 205.05 | allreduce: 9.61 | optimizer: 0.04 | bias in backward: 4.04 | dropout in backward: 6.48
 iteration        6/     100 | elapsed time per iteration (ms): 348.8 | learning rate: 0.000E+00 | lm loss: 1.054722E+01 | sop loss: 7.019025E-01 | loss scale: 134217728.0 |
time (ms) | total time: 348.49 | forward: 140.38 | backward: 205.02 | allreduce: 9.59 | optimizer: 0.04 | bias in backward: 4.02 | dropout in backward: 6.50
 iteration        7/     100 | elapsed time per iteration (ms): 348.8 | learning rate: 0.000E+00 | lm loss: 1.054468E+01 | sop loss: 7.315107E-01 | loss scale: 67108864.0 |
time (ms) | total time: 348.47 | forward: 140.12 | backward: 205.16 | allreduce: 9.53 | optimizer: 0.04 | bias in backward: 4.13 | dropout in backward: 6.57
 iteration        8/     100 | elapsed time per iteration (ms): 346.6 | learning rate: 0.000E+00 | lm loss: 1.054039E+01 | sop loss: 6.845970E-01 | loss scale: 33554432.0 |
time (ms) | total time: 346.34 | forward: 139.91 | backward: 203.42 | allreduce: 9.25 | optimizer: 0.03 | bias in backward: 4.02 | dropout in backward: 6.49
 iteration        9/     100 | elapsed time per iteration (ms): 347.9 | learning rate: 0.000E+00 | lm loss: 1.055268E+01 | sop loss: 7.751835E-01 | loss scale: 16777216.0 |
time (ms) | total time: 347.58 | forward: 139.89 | backward: 204.61 | allreduce: 9.39 | optimizer: 0.04 | bias in backward: 4.04 | dropout in backward: 6.52
 iteration       10/     100 | elapsed time per iteration (ms): 347.8 | learning rate: 0.000E+00 | lm loss: 1.053733E+01 | sop loss: 7.079117E-01 | loss scale: 8388608.0 |
time (ms) | total time: 347.49 | forward: 139.78 | backward: 204.71 | allreduce: 9.40 | optimizer: 0.03 | bias in backward: 4.07 | dropout in backward: 6.52
 iteration       11/     100 | elapsed time per iteration (ms): 348.1 | learning rate: 0.000E+00 | lm loss: 1.055366E+01 | sop loss: 6.537458E-01 | loss scale: 4194304.0 |
time (ms) | total time: 347.86 | forward: 139.69 | backward: 205.19 | allreduce: 9.49 | optimizer: 0.04 | bias in backward: 4.16 | dropout in backward: 6.50
 iteration       12/     100 | elapsed time per iteration (ms): 348.4 | learning rate: 0.000E+00 | lm loss: 1.058716E+01 | sop loss: 6.766561E-01 | loss scale: 2097152.0 |
time (ms) | total time: 348.12 | forward: 140.12 | backward: 204.96 | allreduce: 9.45 | optimizer: 0.03 | bias in backward: 4.03 | dropout in backward: 6.49
 iteration       13/     100 | elapsed time per iteration (ms): 351.8 | learning rate: 0.000E+00 | lm loss: 1.056558E+01 | sop loss: 6.741780E-01 | loss scale: 1048576.0 |
time (ms) | total time: 351.51 | forward: 139.41 | backward: 208.87 | allreduce: 9.38 | optimizer: 0.04 | bias in backward: 4.02 | dropout in backward: 6.49
 iteration       14/     100 | elapsed time per iteration (ms): 351.8 | learning rate: 0.000E+00 | lm loss: 1.057411E+01 | sop loss: 7.279879E-01 | loss scale: 524288.0 |
time (ms) | total time: 351.52 | forward: 139.99 | backward: 208.81 | allreduce: 9.24 | optimizer: 0.04 | bias in backward: 4.02 | dropout in backward: 6.49
 iteration       15/     100 | elapsed time per iteration (ms): 352.2 | learning rate: 0.000E+00 | lm loss: 1.057639E+01 | sop loss: 7.233395E-01 | loss scale: 262144.0 |
time (ms) | total time: 351.92 | forward: 139.91 | backward: 209.07 | allreduce: 9.33 | optimizer: 0.03 | bias in backward: 4.03 | dropout in backward: 6.48
 iteration       16/     100 | elapsed time per iteration (ms): 541.1 | learning rate: 1.010E-08 | lm loss: 1.052060E+01 | sop loss: 7.369431E-01 | loss scale: 262144.0 |
time (ms) | total time: 540.77 | forward: 139.52 | backward: 286.61 | allreduce: 9.39 | optimizer: 111.65 | bias in backward: 4.03 | dropout in backward: 6.49
 iteration       17/     100 | elapsed time per iteration (ms): 390.4 | learning rate: 2.020E-08 | lm loss: 1.057766E+01 | sop loss: 7.432451E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.05 | forward: 140.04 | backward: 241.86 | allreduce: 9.52 | optimizer: 5.28 | bias in backward: 4.17 | dropout in backward: 6.50
 iteration       18/     100 | elapsed time per iteration (ms): 390.7 | learning rate: 3.030E-08 | lm loss: 1.056275E+01 | sop loss: 7.627132E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.45 | forward: 139.94 | backward: 242.31 | allreduce: 9.55 | optimizer: 5.30 | bias in backward: 4.05 | dropout in backward: 6.50
 iteration       19/     100 | elapsed time per iteration (ms): 392.3 | learning rate: 4.040E-08 | lm loss: 1.059187E+01 | sop loss: 7.407265E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.97 | forward: 140.09 | backward: 243.42 | allreduce: 9.80 | optimizer: 5.33 | bias in backward: 4.05 | dropout in backward: 6.49
 iteration       20/     100 | elapsed time per iteration (ms): 392.6 | learning rate: 5.051E-08 | lm loss: 1.059862E+01 | sop loss: 7.372819E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.36 | forward: 140.12 | backward: 243.70 | allreduce: 9.77 | optimizer: 5.30 | bias in backward: 4.06 | dropout in backward: 6.47
 iteration       21/     100 | elapsed time per iteration (ms): 393.4 | learning rate: 6.061E-08 | lm loss: 1.056905E+01 | sop loss: 7.074362E-01 | loss scale: 262144.0 |
time (ms) | total time: 393.11 | forward: 140.37 | backward: 244.24 | allreduce: 9.81 | optimizer: 5.29 | bias in backward: 4.07 | dropout in backward: 6.52
 iteration       22/     100 | elapsed time per iteration (ms): 392.4 | learning rate: 7.071E-08 | lm loss: 1.054572E+01 | sop loss: 6.684852E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.02 | forward: 139.95 | backward: 243.61 | allreduce: 9.78 | optimizer: 5.28 | bias in backward: 4.03 | dropout in backward: 6.49
 iteration       23/     100 | elapsed time per iteration (ms): 392.7 | learning rate: 8.081E-08 | lm loss: 1.054243E+01 | sop loss: 6.984038E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.37 | forward: 139.65 | backward: 244.59 | allreduce: 9.68 | optimizer: 5.26 | bias in backward: 4.09 | dropout in backward: 6.64
 iteration       24/     100 | elapsed time per iteration (ms): 389.1 | learning rate: 9.091E-08 | lm loss: 1.055956E+01 | sop loss: 6.670023E-01 | loss scale: 262144.0 |
time (ms) | total time: 388.76 | forward: 139.72 | backward: 241.24 | allreduce: 8.99 | optimizer: 5.24 | bias in backward: 4.05 | dropout in backward: 6.54
 iteration       25/     100 | elapsed time per iteration (ms): 390.2 | learning rate: 1.010E-07 | lm loss: 1.055945E+01 | sop loss: 6.808951E-01 | loss scale: 262144.0 |
time (ms) | total time: 389.92 | forward: 139.73 | backward: 242.53 | allreduce: 9.04 | optimizer: 5.27 | bias in backward: 4.08 | dropout in backward: 6.57
 iteration       26/     100 | elapsed time per iteration (ms): 395.4 | learning rate: 1.111E-07 | lm loss: 1.057126E+01 | sop loss: 7.366417E-01 | loss scale: 262144.0 |
time (ms) | total time: 395.04 | forward: 140.43 | backward: 244.09 | allreduce: 9.50 | optimizer: 7.89 | bias in backward: 4.07 | dropout in backward: 6.57
 iteration       27/     100 | elapsed time per iteration (ms): 389.8 | learning rate: 1.212E-07 | lm loss: 1.057179E+01 | sop loss: 7.185884E-01 | loss scale: 262144.0 |
time (ms) | total time: 389.46 | forward: 139.65 | backward: 242.16 | allreduce: 8.89 | optimizer: 5.25 | bias in backward: 4.04 | dropout in backward: 6.48
 iteration       28/     100 | elapsed time per iteration (ms): 391.2 | learning rate: 1.313E-07 | lm loss: 1.057136E+01 | sop loss: 7.318813E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.85 | forward: 140.23 | backward: 242.85 | allreduce: 9.34 | optimizer: 5.26 | bias in backward: 4.08 | dropout in backward: 6.49
 iteration       29/     100 | elapsed time per iteration (ms): 392.8 | learning rate: 1.414E-07 | lm loss: 1.055875E+01 | sop loss: 7.048200E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.39 | forward: 140.09 | backward: 243.95 | allreduce: 9.20 | optimizer: 5.34 | bias in backward: 4.02 | dropout in backward: 6.47
 iteration       30/     100 | elapsed time per iteration (ms): 390.3 | learning rate: 1.515E-07 | lm loss: 1.056545E+01 | sop loss: 7.084670E-01 | loss scale: 262144.0 |
time (ms) | total time: 389.95 | forward: 140.03 | backward: 242.15 | allreduce: 9.09 | optimizer: 5.25 | bias in backward: 4.05 | dropout in backward: 6.47
 iteration       31/     100 | elapsed time per iteration (ms): 389.3 | learning rate: 1.616E-07 | lm loss: 1.055941E+01 | sop loss: 7.167185E-01 | loss scale: 262144.0 |
time (ms) | total time: 389.01 | forward: 139.67 | backward: 241.76 | allreduce: 9.01 | optimizer: 5.27 | bias in backward: 4.02 | dropout in backward: 6.47
 iteration       32/     100 | elapsed time per iteration (ms): 390.3 | learning rate: 1.717E-07 | lm loss: 1.057989E+01 | sop loss: 7.673947E-01 | loss scale: 262144.0 |
time (ms) | total time: 389.92 | forward: 139.92 | backward: 242.11 | allreduce: 9.09 | optimizer: 5.29 | bias in backward: 4.02 | dropout in backward: 6.47
 iteration       33/     100 | elapsed time per iteration (ms): 390.4 | learning rate: 1.818E-07 | lm loss: 1.057246E+01 | sop loss: 7.855422E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.03 | forward: 139.73 | backward: 242.63 | allreduce: 9.01 | optimizer: 5.26 | bias in backward: 4.36 | dropout in backward: 6.48
 iteration       34/     100 | elapsed time per iteration (ms): 390.6 | learning rate: 1.919E-07 | lm loss: 1.057555E+01 | sop loss: 6.578614E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.24 | forward: 139.89 | backward: 242.88 | allreduce: 8.88 | optimizer: 5.27 | bias in backward: 4.07 | dropout in backward: 6.50
 iteration       35/     100 | elapsed time per iteration (ms): 392.2 | learning rate: 2.020E-07 | lm loss: 1.056165E+01 | sop loss: 7.652144E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.88 | forward: 140.28 | backward: 243.57 | allreduce: 9.61 | optimizer: 5.31 | bias in backward: 4.03 | dropout in backward: 6.51
 iteration       36/     100 | elapsed time per iteration (ms): 393.0 | learning rate: 2.121E-07 | lm loss: 1.055147E+01 | sop loss: 6.783599E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.71 | forward: 140.03 | backward: 244.25 | allreduce: 9.54 | optimizer: 5.27 | bias in backward: 4.04 | dropout in backward: 6.51
 iteration       37/     100 | elapsed time per iteration (ms): 389.5 | learning rate: 2.222E-07 | lm loss: 1.055354E+01 | sop loss: 6.642941E-01 | loss scale: 262144.0 |
time (ms) | total time: 389.22 | forward: 140.18 | backward: 241.48 | allreduce: 8.96 | optimizer: 5.25 | bias in backward: 4.03 | dropout in backward: 6.47
 iteration       38/     100 | elapsed time per iteration (ms): 393.0 | learning rate: 2.323E-07 | lm loss: 1.057911E+01 | sop loss: 6.973916E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.75 | forward: 140.12 | backward: 244.82 | allreduce: 9.27 | optimizer: 5.28 | bias in backward: 4.04 | dropout in backward: 6.51
 iteration       39/     100 | elapsed time per iteration (ms): 390.9 | learning rate: 2.424E-07 | lm loss: 1.054035E+01 | sop loss: 7.202301E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.61 | forward: 139.89 | backward: 242.61 | allreduce: 9.23 | optimizer: 5.30 | bias in backward: 4.02 | dropout in backward: 6.47
 iteration       40/     100 | elapsed time per iteration (ms): 391.8 | learning rate: 2.525E-07 | lm loss: 1.055245E+01 | sop loss: 6.837714E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.47 | forward: 139.88 | backward: 243.60 | allreduce: 8.98 | optimizer: 5.28 | bias in backward: 4.20 | dropout in backward: 6.52
 iteration       41/     100 | elapsed time per iteration (ms): 389.3 | learning rate: 2.626E-07 | lm loss: 1.055395E+01 | sop loss: 8.324859E-01 | loss scale: 262144.0 |
time (ms) | total time: 389.00 | forward: 139.97 | backward: 241.65 | allreduce: 8.95 | optimizer: 5.26 | bias in backward: 4.01 | dropout in backward: 6.46
 iteration       42/     100 | elapsed time per iteration (ms): 389.2 | learning rate: 2.727E-07 | lm loss: 1.056551E+01 | sop loss: 6.921818E-01 | loss scale: 262144.0 |
time (ms) | total time: 388.96 | forward: 139.60 | backward: 241.81 | allreduce: 8.90 | optimizer: 5.25 | bias in backward: 4.03 | dropout in backward: 6.46
 iteration       43/     100 | elapsed time per iteration (ms): 391.7 | learning rate: 2.828E-07 | lm loss: 1.054439E+01 | sop loss: 8.063792E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.38 | forward: 140.37 | backward: 243.24 | allreduce: 9.23 | optimizer: 5.28 | bias in backward: 4.05 | dropout in backward: 6.46
 iteration       44/     100 | elapsed time per iteration (ms): 390.5 | learning rate: 2.929E-07 | lm loss: 1.052831E+01 | sop loss: 7.297361E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.25 | forward: 140.05 | backward: 242.60 | allreduce: 8.87 | optimizer: 5.25 | bias in backward: 4.01 | dropout in backward: 6.46
 iteration       45/     100 | elapsed time per iteration (ms): 391.7 | learning rate: 3.030E-07 | lm loss: 1.056356E+01 | sop loss: 6.397361E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.42 | forward: 139.91 | backward: 243.71 | allreduce: 9.28 | optimizer: 5.29 | bias in backward: 4.02 | dropout in backward: 6.47
 iteration       46/     100 | elapsed time per iteration (ms): 390.5 | learning rate: 3.131E-07 | lm loss: 1.052170E+01 | sop loss: 7.135389E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.18 | forward: 139.69 | backward: 242.81 | allreduce: 8.94 | optimizer: 5.25 | bias in backward: 4.02 | dropout in backward: 6.47
 iteration       47/     100 | elapsed time per iteration (ms): 390.3 | learning rate: 3.232E-07 | lm loss: 1.056525E+01 | sop loss: 6.690367E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.01 | forward: 139.78 | backward: 242.49 | allreduce: 8.98 | optimizer: 5.29 | bias in backward: 4.02 | dropout in backward: 6.48
 iteration       48/     100 | elapsed time per iteration (ms): 391.4 | learning rate: 3.333E-07 | lm loss: 1.052439E+01 | sop loss: 7.546198E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.14 | forward: 140.09 | backward: 243.14 | allreduce: 9.26 | optimizer: 5.28 | bias in backward: 4.04 | dropout in backward: 6.51
 iteration       49/     100 | elapsed time per iteration (ms): 393.3 | learning rate: 3.434E-07 | lm loss: 1.053772E+01 | sop loss: 7.163955E-01 | loss scale: 262144.0 |
time (ms) | total time: 393.01 | forward: 140.13 | backward: 244.71 | allreduce: 9.58 | optimizer: 5.31 | bias in backward: 4.05 | dropout in backward: 6.46
 iteration       50/     100 | elapsed time per iteration (ms): 392.7 | learning rate: 3.535E-07 | lm loss: 1.053114E+01 | sop loss: 7.449588E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.38 | forward: 140.28 | backward: 243.78 | allreduce: 9.55 | optimizer: 5.29 | bias in backward: 4.01 | dropout in backward: 6.50
 iteration       51/     100 | elapsed time per iteration (ms): 393.2 | learning rate: 3.636E-07 | lm loss: 1.055899E+01 | sop loss: 7.675612E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.93 | forward: 139.82 | backward: 245.04 | allreduce: 9.21 | optimizer: 5.28 | bias in backward: 4.02 | dropout in backward: 6.46
 iteration       52/     100 | elapsed time per iteration (ms): 393.8 | learning rate: 3.737E-07 | lm loss: 1.055761E+01 | sop loss: 7.708388E-01 | loss scale: 262144.0 |
time (ms) | total time: 393.52 | forward: 139.77 | backward: 245.42 | allreduce: 9.60 | optimizer: 5.35 | bias in backward: 4.04 | dropout in backward: 6.48
 iteration       53/     100 | elapsed time per iteration (ms): 393.1 | learning rate: 3.838E-07 | lm loss: 1.055192E+01 | sop loss: 7.572866E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.78 | forward: 140.26 | backward: 244.26 | allreduce: 9.44 | optimizer: 5.28 | bias in backward: 4.07 | dropout in backward: 6.48
 iteration       54/     100 | elapsed time per iteration (ms): 392.5 | learning rate: 3.939E-07 | lm loss: 1.055757E+01 | sop loss: 7.469896E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.20 | forward: 139.78 | backward: 244.21 | allreduce: 9.44 | optimizer: 5.30 | bias in backward: 4.02 | dropout in backward: 6.48
 iteration       55/     100 | elapsed time per iteration (ms): 405.8 | learning rate: 4.040E-07 | lm loss: 1.054987E+01 | sop loss: 6.438567E-01 | loss scale: 262144.0 |
time (ms) | total time: 405.51 | forward: 139.85 | backward: 255.31 | allreduce: 12.01 | optimizer: 7.22 | bias in backward: 4.02 | dropout in backward: 6.48
 iteration       56/     100 | elapsed time per iteration (ms): 405.4 | learning rate: 4.141E-07 | lm loss: 1.052971E+01 | sop loss: 7.248464E-01 | loss scale: 262144.0 |
time (ms) | total time: 405.09 | forward: 139.94 | backward: 255.11 | allreduce: 12.06 | optimizer: 6.72 | bias in backward: 4.07 | dropout in backward: 6.48
 iteration       57/     100 | elapsed time per iteration (ms): 406.1 | learning rate: 4.242E-07 | lm loss: 1.052673E+01 | sop loss: 7.540818E-01 | loss scale: 262144.0 |
time (ms) | total time: 405.81 | forward: 140.24 | backward: 255.72 | allreduce: 12.17 | optimizer: 6.68 | bias in backward: 4.03 | dropout in backward: 6.50
 iteration       58/     100 | elapsed time per iteration (ms): 404.0 | learning rate: 4.343E-07 | lm loss: 1.050947E+01 | sop loss: 7.066897E-01 | loss scale: 262144.0 |
time (ms) | total time: 403.65 | forward: 140.48 | backward: 253.56 | allreduce: 11.78 | optimizer: 6.55 | bias in backward: 4.02 | dropout in backward: 6.48
 iteration       59/     100 | elapsed time per iteration (ms): 407.3 | learning rate: 4.444E-07 | lm loss: 1.055207E+01 | sop loss: 7.021770E-01 | loss scale: 262144.0 |
time (ms) | total time: 406.98 | forward: 140.47 | backward: 256.49 | allreduce: 12.03 | optimizer: 6.95 | bias in backward: 4.03 | dropout in backward: 6.49
 iteration       60/     100 | elapsed time per iteration (ms): 406.3 | learning rate: 4.545E-07 | lm loss: 1.052426E+01 | sop loss: 8.123704E-01 | loss scale: 262144.0 |
time (ms) | total time: 405.96 | forward: 140.47 | backward: 255.52 | allreduce: 12.17 | optimizer: 6.84 | bias in backward: 4.04 | dropout in backward: 6.49
 iteration       61/     100 | elapsed time per iteration (ms): 403.6 | learning rate: 4.646E-07 | lm loss: 1.054225E+01 | sop loss: 7.913737E-01 | loss scale: 262144.0 |
time (ms) | total time: 403.22 | forward: 140.62 | backward: 252.86 | allreduce: 11.87 | optimizer: 6.60 | bias in backward: 4.03 | dropout in backward: 6.48
 iteration       62/     100 | elapsed time per iteration (ms): 403.4 | learning rate: 4.747E-07 | lm loss: 1.053468E+01 | sop loss: 7.559266E-01 | loss scale: 262144.0 |
time (ms) | total time: 402.99 | forward: 140.23 | backward: 252.80 | allreduce: 11.62 | optimizer: 6.90 | bias in backward: 4.02 | dropout in backward: 6.46
 iteration       63/     100 | elapsed time per iteration (ms): 406.1 | learning rate: 4.848E-07 | lm loss: 1.055061E+01 | sop loss: 7.508711E-01 | loss scale: 262144.0 |
time (ms) | total time: 405.70 | forward: 140.57 | backward: 253.45 | allreduce: 12.15 | optimizer: 8.08 | bias in backward: 4.03 | dropout in backward: 6.48
 iteration       64/     100 | elapsed time per iteration (ms): 408.5 | learning rate: 4.949E-07 | lm loss: 1.052096E+01 | sop loss: 7.633148E-01 | loss scale: 262144.0 |
time (ms) | total time: 408.13 | forward: 141.16 | backward: 256.36 | allreduce: 12.11 | optimizer: 6.93 | bias in backward: 4.02 | dropout in backward: 6.48
 iteration       65/     100 | elapsed time per iteration (ms): 405.8 | learning rate: 5.051E-07 | lm loss: 1.053840E+01 | sop loss: 7.471626E-01 | loss scale: 262144.0 |
time (ms) | total time: 405.44 | forward: 140.19 | backward: 255.30 | allreduce: 12.16 | optimizer: 6.72 | bias in backward: 4.03 | dropout in backward: 6.46
 iteration       66/     100 | elapsed time per iteration (ms): 409.5 | learning rate: 5.152E-07 | lm loss: 1.050450E+01 | sop loss: 6.998699E-01 | loss scale: 262144.0 |
time (ms) | total time: 409.14 | forward: 140.57 | backward: 258.59 | allreduce: 12.25 | optimizer: 6.72 | bias in backward: 4.03 | dropout in backward: 6.47
 iteration       67/     100 | elapsed time per iteration (ms): 406.5 | learning rate: 5.253E-07 | lm loss: 1.053645E+01 | sop loss: 6.959006E-01 | loss scale: 262144.0 |
time (ms) | total time: 406.16 | forward: 140.34 | backward: 256.03 | allreduce: 12.07 | optimizer: 6.66 | bias in backward: 4.06 | dropout in backward: 6.58
 iteration       68/     100 | elapsed time per iteration (ms): 406.7 | learning rate: 5.354E-07 | lm loss: 1.052166E+01 | sop loss: 7.231877E-01 | loss scale: 262144.0 |
time (ms) | total time: 406.39 | forward: 140.70 | backward: 255.13 | allreduce: 12.11 | optimizer: 7.18 | bias in backward: 4.30 | dropout in backward: 6.51
 iteration       69/     100 | elapsed time per iteration (ms): 403.9 | learning rate: 5.455E-07 | lm loss: 1.053955E+01 | sop loss: 7.191133E-01 | loss scale: 262144.0 |
time (ms) | total time: 403.56 | forward: 140.26 | backward: 253.41 | allreduce: 12.03 | optimizer: 6.64 | bias in backward: 4.02 | dropout in backward: 6.47
 iteration       70/     100 | elapsed time per iteration (ms): 405.2 | learning rate: 5.556E-07 | lm loss: 1.051648E+01 | sop loss: 8.144351E-01 | loss scale: 262144.0 |
time (ms) | total time: 404.91 | forward: 140.09 | backward: 254.94 | allreduce: 11.95 | optimizer: 6.71 | bias in backward: 4.02 | dropout in backward: 6.48
 iteration       71/     100 | elapsed time per iteration (ms): 404.7 | learning rate: 5.657E-07 | lm loss: 1.053396E+01 | sop loss: 6.790290E-01 | loss scale: 262144.0 |
time (ms) | total time: 404.35 | forward: 140.13 | backward: 254.25 | allreduce: 12.19 | optimizer: 6.71 | bias in backward: 4.04 | dropout in backward: 6.47
 iteration       72/     100 | elapsed time per iteration (ms): 403.5 | learning rate: 5.758E-07 | lm loss: 1.053078E+01 | sop loss: 7.268026E-01 | loss scale: 262144.0 |
time (ms) | total time: 403.23 | forward: 140.42 | backward: 254.12 | allreduce: 12.11 | optimizer: 5.36 | bias in backward: 4.04 | dropout in backward: 6.48
 iteration       73/     100 | elapsed time per iteration (ms): 392.0 | learning rate: 5.859E-07 | lm loss: 1.054897E+01 | sop loss: 6.793833E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.76 | forward: 140.14 | backward: 243.59 | allreduce: 9.37 | optimizer: 5.28 | bias in backward: 4.03 | dropout in backward: 6.47
 iteration       74/     100 | elapsed time per iteration (ms): 394.0 | learning rate: 5.960E-07 | lm loss: 1.050466E+01 | sop loss: 6.757433E-01 | loss scale: 262144.0 |
time (ms) | total time: 393.74 | forward: 140.11 | backward: 245.71 | allreduce: 9.29 | optimizer: 5.29 | bias in backward: 4.03 | dropout in backward: 6.48
 iteration       75/     100 | elapsed time per iteration (ms): 391.2 | learning rate: 6.061E-07 | lm loss: 1.052626E+01 | sop loss: 7.628942E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.91 | forward: 139.79 | backward: 243.38 | allreduce: 9.13 | optimizer: 5.26 | bias in backward: 4.03 | dropout in backward: 6.48
 iteration       76/     100 | elapsed time per iteration (ms): 392.3 | learning rate: 6.162E-07 | lm loss: 1.052832E+01 | sop loss: 7.916556E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.01 | forward: 140.12 | backward: 243.86 | allreduce: 9.28 | optimizer: 5.28 | bias in backward: 4.01 | dropout in backward: 6.48
 iteration       77/     100 | elapsed time per iteration (ms): 394.4 | learning rate: 6.263E-07 | lm loss: 1.052304E+01 | sop loss: 6.484116E-01 | loss scale: 262144.0 |
time (ms) | total time: 394.10 | forward: 140.03 | backward: 245.77 | allreduce: 9.47 | optimizer: 5.31 | bias in backward: 4.04 | dropout in backward: 6.51
 iteration       78/     100 | elapsed time per iteration (ms): 397.6 | learning rate: 6.364E-07 | lm loss: 1.049931E+01 | sop loss: 7.541772E-01 | loss scale: 262144.0 |
time (ms) | total time: 397.27 | forward: 140.31 | backward: 248.52 | allreduce: 9.70 | optimizer: 5.31 | bias in backward: 4.25 | dropout in backward: 6.85
 iteration       79/     100 | elapsed time per iteration (ms): 392.9 | learning rate: 6.465E-07 | lm loss: 1.050107E+01 | sop loss: 7.995117E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.64 | forward: 140.33 | backward: 244.36 | allreduce: 9.29 | optimizer: 5.28 | bias in backward: 4.04 | dropout in backward: 6.49
 iteration       80/     100 | elapsed time per iteration (ms): 392.5 | learning rate: 6.566E-07 | lm loss: 1.049120E+01 | sop loss: 7.039208E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.19 | forward: 139.91 | backward: 244.21 | allreduce: 9.57 | optimizer: 5.27 | bias in backward: 4.10 | dropout in backward: 6.51
 iteration       81/     100 | elapsed time per iteration (ms): 390.4 | learning rate: 6.667E-07 | lm loss: 1.051972E+01 | sop loss: 6.490551E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.14 | forward: 139.85 | backward: 242.42 | allreduce: 8.95 | optimizer: 5.25 | bias in backward: 4.03 | dropout in backward: 6.46
 iteration       82/     100 | elapsed time per iteration (ms): 394.5 | learning rate: 6.768E-07 | lm loss: 1.052259E+01 | sop loss: 6.988202E-01 | loss scale: 262144.0 |
time (ms) | total time: 394.18 | forward: 139.94 | backward: 246.50 | allreduce: 9.05 | optimizer: 5.25 | bias in backward: 4.02 | dropout in backward: 6.47
 iteration       83/     100 | elapsed time per iteration (ms): 390.4 | learning rate: 6.869E-07 | lm loss: 1.050081E+01 | sop loss: 7.017143E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.09 | forward: 139.95 | backward: 242.26 | allreduce: 9.32 | optimizer: 5.31 | bias in backward: 4.03 | dropout in backward: 6.45
 iteration       84/     100 | elapsed time per iteration (ms): 391.5 | learning rate: 6.970E-07 | lm loss: 1.049008E+01 | sop loss: 7.568610E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.25 | forward: 140.17 | backward: 243.33 | allreduce: 8.96 | optimizer: 5.27 | bias in backward: 4.07 | dropout in backward: 6.49
 iteration       85/     100 | elapsed time per iteration (ms): 392.1 | learning rate: 7.071E-07 | lm loss: 1.049755E+01 | sop loss: 6.280849E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.75 | forward: 140.08 | backward: 243.97 | allreduce: 9.13 | optimizer: 5.27 | bias in backward: 4.04 | dropout in backward: 6.48
 iteration       86/     100 | elapsed time per iteration (ms): 392.0 | learning rate: 7.172E-07 | lm loss: 1.049487E+01 | sop loss: 7.633672E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.71 | forward: 140.00 | backward: 243.96 | allreduce: 9.23 | optimizer: 5.28 | bias in backward: 4.03 | dropout in backward: 6.47
 iteration       87/     100 | elapsed time per iteration (ms): 389.8 | learning rate: 7.273E-07 | lm loss: 1.048589E+01 | sop loss: 6.924977E-01 | loss scale: 262144.0 |
time (ms) | total time: 389.54 | forward: 140.15 | backward: 241.84 | allreduce: 8.91 | optimizer: 5.27 | bias in backward: 4.01 | dropout in backward: 6.46
 iteration       88/     100 | elapsed time per iteration (ms): 392.5 | learning rate: 7.374E-07 | lm loss: 1.053422E+01 | sop loss: 7.616718E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.23 | forward: 140.12 | backward: 244.33 | allreduce: 9.28 | optimizer: 5.27 | bias in backward: 4.04 | dropout in backward: 6.49
 iteration       89/     100 | elapsed time per iteration (ms): 390.3 | learning rate: 7.475E-07 | lm loss: 1.052053E+01 | sop loss: 7.955858E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.05 | forward: 140.24 | backward: 242.14 | allreduce: 8.99 | optimizer: 5.27 | bias in backward: 4.06 | dropout in backward: 6.53
 iteration       90/     100 | elapsed time per iteration (ms): 390.1 | learning rate: 7.576E-07 | lm loss: 1.049704E+01 | sop loss: 6.824251E-01 | loss scale: 262144.0 |
time (ms) | total time: 389.87 | forward: 139.88 | backward: 242.41 | allreduce: 8.92 | optimizer: 5.24 | bias in backward: 4.09 | dropout in backward: 6.54
 iteration       91/     100 | elapsed time per iteration (ms): 391.5 | learning rate: 7.677E-07 | lm loss: 1.050535E+01 | sop loss: 7.202907E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.11 | forward: 140.03 | backward: 243.30 | allreduce: 9.14 | optimizer: 5.28 | bias in backward: 4.19 | dropout in backward: 6.47
 iteration       92/     100 | elapsed time per iteration (ms): 394.2 | learning rate: 7.778E-07 | lm loss: 1.051659E+01 | sop loss: 6.953166E-01 | loss scale: 262144.0 |
time (ms) | total time: 393.94 | forward: 140.27 | backward: 245.56 | allreduce: 9.64 | optimizer: 5.29 | bias in backward: 4.35 | dropout in backward: 6.83
 iteration       93/     100 | elapsed time per iteration (ms): 393.2 | learning rate: 7.879E-07 | lm loss: 1.049919E+01 | sop loss: 7.224894E-01 | loss scale: 262144.0 |
time (ms) | total time: 392.95 | forward: 140.30 | backward: 244.27 | allreduce: 9.44 | optimizer: 5.30 | bias in backward: 4.18 | dropout in backward: 6.48
 iteration       94/     100 | elapsed time per iteration (ms): 390.9 | learning rate: 7.980E-07 | lm loss: 1.049172E+01 | sop loss: 7.227212E-01 | loss scale: 262144.0 |
time (ms) | total time: 390.63 | forward: 139.97 | backward: 243.13 | allreduce: 8.96 | optimizer: 5.26 | bias in backward: 4.02 | dropout in backward: 6.45
 iteration       95/     100 | elapsed time per iteration (ms): 390.0 | learning rate: 8.081E-07 | lm loss: 1.050791E+01 | sop loss: 7.214819E-01 | loss scale: 262144.0 |
time (ms) | total time: 389.68 | forward: 139.87 | backward: 242.21 | allreduce: 8.98 | optimizer: 5.26 | bias in backward: 4.03 | dropout in backward: 6.45
 iteration       96/     100 | elapsed time per iteration (ms): 413.6 | learning rate: 8.182E-07 | lm loss: 1.048875E+01 | sop loss: 6.975023E-01 | loss scale: 262144.0 |
time (ms) | total time: 413.28 | forward: 140.16 | backward: 264.92 | allreduce: 32.50 | optimizer: 5.28 | bias in backward: 4.01 | dropout in backward: 6.47
 iteration       97/     100 | elapsed time per iteration (ms): 391.6 | learning rate: 8.283E-07 | lm loss: 1.049053E+01 | sop loss: 7.607493E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.29 | forward: 140.40 | backward: 243.38 | allreduce: 9.00 | optimizer: 5.26 | bias in backward: 4.01 | dropout in backward: 6.45
 iteration       98/     100 | elapsed time per iteration (ms): 393.4 | learning rate: 8.384E-07 | lm loss: 1.048563E+01 | sop loss: 6.728904E-01 | loss scale: 262144.0 |
time (ms) | total time: 393.16 | forward: 140.36 | backward: 244.84 | allreduce: 9.48 | optimizer: 5.29 | bias in backward: 4.07 | dropout in backward: 6.49
 iteration       99/     100 | elapsed time per iteration (ms): 421.6 | learning rate: 8.485E-07 | lm loss: 1.051214E+01 | sop loss: 6.839970E-01 | loss scale: 262144.0 |
time (ms) | total time: 421.32 | forward: 139.85 | backward: 273.07 | allreduce: 9.56 | optimizer: 5.37 | bias in backward: 4.01 | dropout in backward: 6.47
 iteration      100/     100 | elapsed time per iteration (ms): 392.2 | learning rate: 8.586E-07 | lm loss: 1.049799E+01 | sop loss: 7.503203E-01 | loss scale: 262144.0 |
time (ms) | total time: 391.89 | forward: 139.88 | backward: 243.94 | allreduce: 9.04 | optimizer: 5.25 | bias in backward: 4.01 | dropout in backward: 6.47
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************

64

using world size: 4 and model-parallel size: 4 
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30522) with 198 dummy tokens (new size: 30720)
> initializing torch distributed ...
Xone init
Xone init
Xone init
Xone init
> initializing model parallel with size 4
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
building BERT model ...
> learning rate decay style: linear
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.102730 seconds
 > indexed dataset stats:
    number of documents: 6091006
    number of sentences: 105005246
 > dataset split:
    train:
     document indices in [0, 5780365) total of 5780365 documents
     sentence indices in [0, 101602660) total of 101602660 sentences
    validation:
     document indices in [5780365, 6084915) total of 304550 documents
     sentence indices in [101602660, 104945630) total of 3342970 sentences
    test:
     document indices in [6084915, 6091006) total of 6091 documents
     sentence indices in [104945630, 105005246) total of 59616 sentences
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_train_indexmap_6400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.006 seconds
    total number of samples: 8716847
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_valid_indexmap_6400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 358908
 > loading indexed mapping from /philly/rr3/msrhyperprojvc2_scratch/saemal/amir/data/wikidata/raid/Megatron-LM/my-bert_text_sentence_test_indexmap_6400mns_512msl_0.10ssp_1234s.npy
    loaded indexed file in 0.001 seconds
    total number of samples: 6871
> finished creating BERT datasets ...
done with setups ...
time (ms) | model and optimizer: 3541.50 | train/valid/test data iterators: 2583.90
training ...
